{"remainingRequest":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\ts-loader\\index.js??ref--4-1!D:\\project\\Deecamp-project\\system\\Web\\node_modules\\@antv\\g-canvas\\esm\\util\\hit.js","dependencies":[{"path":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\@antv\\g-canvas\\esm\\util\\hit.js","mtime":499162500000},{"path":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1595520254649},{"path":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\ts-loader\\index.js","mtime":1537906253000}],"contextDependencies":[],"result":["import { isAllowCapture } from '@antv/g-base/lib/util/util';\r\nimport { multiplyVec2, invert } from '@antv/g-base/lib/util/matrix';\r\nfunction invertFromMatrix(v, matrix) {\r\n    if (matrix) {\r\n        var invertMatrix = invert(matrix);\r\n        return multiplyVec2(invertMatrix, v);\r\n    }\r\n    return v;\r\n}\r\nfunction getRefXY(element, x, y) {\r\n    var totalMatrix = element.getTotalMatrix();\r\n    if (totalMatrix) {\r\n        var _a = invertFromMatrix([x, y, 1], totalMatrix), refX = _a[0], refY = _a[1];\r\n        return [refX, refY];\r\n    }\r\n    return [x, y];\r\n}\r\nfunction preTest(element, x, y) {\r\n    if (element.isCanvas && element.isCanvas()) {\r\n        return true;\r\n    }\r\n    if (!isAllowCapture(element) && element.cfg.isInView === false) {\r\n        return false;\r\n    }\r\n    if (element.cfg.clipShape) {\r\n        var _a = getRefXY(element, x, y), refX = _a[0], refY = _a[1];\r\n        if (element.isClipped(refX, refY)) {\r\n            return false;\r\n        }\r\n    }\r\n    var bbox = element.cfg.cacheCanvasBBox;\r\n    if (!bbox) {\r\n        bbox = element.getCanvasBBox();\r\n    }\r\n    if (!(x >= bbox.minX && x <= bbox.maxX && y >= bbox.minY && y <= bbox.maxY)) {\r\n        return false;\r\n    }\r\n    return true;\r\n}\r\nexport function getShape(container, x, y) {\r\n    if (!preTest(container, x, y)) {\r\n        return null;\r\n    }\r\n    var shape = null;\r\n    var children = container.getChildren();\r\n    var count = children.length;\r\n    for (var i = count - 1; i >= 0; i--) {\r\n        var child = children[i];\r\n        if (child.isGroup()) {\r\n            shape = getShape(child, x, y);\r\n        }\r\n        else if (preTest(child, x, y)) {\r\n            var curShape = child;\r\n            var _a = getRefXY(child, x, y), refX = _a[0], refY = _a[1];\r\n            if (curShape.isInShape(refX, refY)) {\r\n                shape = child;\r\n            }\r\n        }\r\n        if (shape) {\r\n            break;\r\n        }\r\n    }\r\n    return shape;\r\n}\r\n",{"version":3,"file":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\@antv\\g-canvas\\esm\\util\\hit.js","sourceRoot":"","sources":["D:\\project\\Deecamp-project\\system\\Web\\node_modules\\@antv\\g-canvas\\esm\\util\\hit.js"],"names":[],"mappings":"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","sourcesContent":["import { isAllowCapture } from '@antv/g-base/lib/util/util';\nimport { multiplyVec2, invert } from '@antv/g-base/lib/util/matrix';\nfunction invertFromMatrix(v, matrix) {\n    if (matrix) {\n        var invertMatrix = invert(matrix);\n        return multiplyVec2(invertMatrix, v);\n    }\n    return v;\n}\nfunction getRefXY(element, x, y) {\n    // @ts-ignore\n    var totalMatrix = element.getTotalMatrix();\n    if (totalMatrix) {\n        var _a = invertFromMatrix([x, y, 1], totalMatrix), refX = _a[0], refY = _a[1];\n        return [refX, refY];\n    }\n    return [x, y];\n}\n// 拾取前的检测，只有通过检测才能继续拾取\nfunction preTest(element, x, y) {\n    // @ts-ignore\n    if (element.isCanvas && element.isCanvas()) {\n        return true;\n    }\n    // 不允许被拾取，则返回 null\n    // @ts-ignore\n    if (!isAllowCapture(element) && element.cfg.isInView === false) {\n        return false;\n    }\n    if (element.cfg.clipShape) {\n        // 如果存在 clip\n        var _a = getRefXY(element, x, y), refX = _a[0], refY = _a[1];\n        if (element.isClipped(refX, refY)) {\n            return false;\n        }\n    }\n    // @ts-ignore ，这个地方调用过于频繁\n    var bbox = element.cfg.cacheCanvasBBox;\n    if (!bbox) {\n        bbox = element.getCanvasBBox();\n    }\n    if (!(x >= bbox.minX && x <= bbox.maxX && y >= bbox.minY && y <= bbox.maxY)) {\n        return false;\n    }\n    return true;\n}\nexport function getShape(container, x, y) {\n    // 没有通过检测，则返回 null\n    if (!preTest(container, x, y)) {\n        return null;\n    }\n    var shape = null;\n    var children = container.getChildren();\n    var count = children.length;\n    for (var i = count - 1; i >= 0; i--) {\n        var child = children[i];\n        if (child.isGroup()) {\n            shape = getShape(child, x, y);\n        }\n        else if (preTest(child, x, y)) {\n            var curShape = child;\n            var _a = getRefXY(child, x, y), refX = _a[0], refY = _a[1];\n            // @ts-ignore\n            if (curShape.isInShape(refX, refY)) {\n                shape = child;\n            }\n        }\n        if (shape) {\n            break;\n        }\n    }\n    return shape;\n}\n//# sourceMappingURL=hit.js.map"]}]}