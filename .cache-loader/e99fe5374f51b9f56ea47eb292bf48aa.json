{"remainingRequest":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\ts-loader\\index.js??ref--4-1!D:\\project\\Deecamp-project\\system\\Web\\node_modules\\bizcharts\\es6\\processor\\processor.js","dependencies":[{"path":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\bizcharts\\es6\\processor\\processor.js","mtime":499162500000},{"path":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1595520254649},{"path":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\ts-loader\\index.js","mtime":1537906253000}],"contextDependencies":[],"result":["'use strict';\r\nObject.defineProperty(exports, \"__esModule\", {\r\n    value: true\r\n});\r\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) {\r\n    var source = arguments[i];\r\n    for (var key in source) {\r\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\r\n            target[key] = source[key];\r\n        }\r\n    }\r\n} return target; };\r\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) {\r\n    var descriptor = props[i];\r\n    descriptor.enumerable = descriptor.enumerable || false;\r\n    descriptor.configurable = true;\r\n    if (\"value\" in descriptor)\r\n        descriptor.writable = true;\r\n    Object.defineProperty(target, descriptor.key, descriptor);\r\n} } return function (Constructor, protoProps, staticProps) { if (protoProps)\r\n    defineProperties(Constructor.prototype, protoProps); if (staticProps)\r\n    defineProperties(Constructor, staticProps); return Constructor; }; }();\r\nvar _configAdd = require('./configAdd');\r\nvar _configAdd2 = _interopRequireDefault(_configAdd);\r\nvar _configMerge = require('./configMerge');\r\nvar _configMerge2 = _interopRequireDefault(_configMerge);\r\nvar _g2Update = require('./g2Update');\r\nvar _g2Update2 = _interopRequireDefault(_g2Update);\r\nvar _g2Delete = require('./g2Delete');\r\nvar _g2Delete2 = _interopRequireDefault(_g2Delete);\r\nvar _g2Creator = require('./g2Creator');\r\nvar _g2Creator2 = _interopRequireDefault(_g2Creator);\r\nvar _shared = require('../shared');\r\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\r\nfunction _objectWithoutProperties(obj, keys) { var target = {}; for (var i in obj) {\r\n    if (keys.indexOf(i) >= 0)\r\n        continue;\r\n    if (!Object.prototype.hasOwnProperty.call(obj, i))\r\n        continue;\r\n    target[i] = obj[i];\r\n} return target; }\r\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) {\r\n    throw new TypeError(\"Cannot call a class as a function\");\r\n} }\r\nvar Processor = function () {\r\n    function Processor() {\r\n        _classCallCheck(this, Processor);\r\n        this.config = {};\r\n        this.elementInfos = {};\r\n        this.added = false;\r\n        this.initedG2 = false;\r\n        this.updated = false;\r\n        this.deleted = false;\r\n        this.deleteInfos = {};\r\n    }\r\n    _createClass(Processor, [{\r\n            key: 'calUpdateFlag',\r\n            value: function calUpdateFlag(name, id) {\r\n                var _elementInfos$id$prop = this.elementInfos[id].props, children = _elementInfos$id$prop.children, props = _objectWithoutProperties(_elementInfos$id$prop, ['children']);\r\n                var _elementInfos$id$upda = this.elementInfos[id].updateProps, nextChildren = _elementInfos$id$upda.children, nextProps = _objectWithoutProperties(_elementInfos$id$upda, ['children']);\r\n                if (name === 'Chart' || name === 'View') {\r\n                    var data = props.data, otherProps = _objectWithoutProperties(props, ['data']);\r\n                    var nextData = nextProps.data, nextOtherProps = _objectWithoutProperties(nextProps, ['data']);\r\n                    if (data !== nextData || !_shared.Util.isEqual(otherProps, nextOtherProps)) {\r\n                        this.updated = true;\r\n                    }\r\n                }\r\n                else {\r\n                    if (!_shared.Util.isEqual(props, nextProps)) {\r\n                        this.updated = true;\r\n                    }\r\n                }\r\n            }\r\n        }, {\r\n            key: 'addElement',\r\n            value: function addElement(name, id, props, parentInfo, viewId) {\r\n                if (!this.chart && this.initedG2)\r\n                    return;\r\n                this.added = true;\r\n                this.elementInfos[id] = {\r\n                    id: id,\r\n                    viewId: viewId,\r\n                    parentInfo: parentInfo,\r\n                    name: name,\r\n                    props: _extends({}, props)\r\n                };\r\n                if (parentInfo && !this.elementInfos[parentInfo.id]) {\r\n                    this.elementInfos[parentInfo.id] = {\r\n                        id: parentInfo.id,\r\n                        name: parentInfo.name\r\n                    };\r\n                }\r\n                _configAdd2.default.addElement(name, this.config, this.elementInfos[id]);\r\n            }\r\n        }, {\r\n            key: 'updateElement',\r\n            value: function updateElement(name, id, props) {\r\n                this.elementInfos[id].updateProps = _extends({}, props);\r\n                this.calUpdateFlag(name, id);\r\n            }\r\n        }, {\r\n            key: 'deleteElement',\r\n            value: function deleteElement(name, id) {\r\n                if (!this.chart)\r\n                    return;\r\n                this.deleteInfos[id] = id;\r\n                this.deleted = true;\r\n            }\r\n        }, {\r\n            key: 'createG2Instance',\r\n            value: function createG2Instance() {\r\n                var config = this.config;\r\n                var chart = _g2Creator2.default.createChart(config, this.elementInfos);\r\n                _g2Creator2.default.executeChartConfig(chart, config, this.elementInfos);\r\n                _g2Creator2.default.synchronizeG2Add(chart, config, this.elementInfos);\r\n                chart.render();\r\n                this.chart = chart;\r\n                this.initedG2 = true;\r\n                this.resetStates();\r\n                return chart;\r\n            }\r\n        }, {\r\n            key: 'destory',\r\n            value: function destory() {\r\n                this.chart.destroy();\r\n                this.chart = null;\r\n            }\r\n        }, {\r\n            key: 'resetStates',\r\n            value: function resetStates() {\r\n                var elems = this.elementInfos;\r\n                for (var id in elems) {\r\n                    if (elems[id].updateProps)\r\n                        delete elems[id].updateProps;\r\n                    if (this.deleteInfos[id]) {\r\n                        delete elems[id];\r\n                    }\r\n                }\r\n                this.added = false;\r\n                this.updated = false;\r\n                this.deleteInfos = {};\r\n            }\r\n        }, {\r\n            key: 'reExecuteChart',\r\n            value: function reExecuteChart() {\r\n                this.chart.clear();\r\n                _configMerge2.default.merge(this.config, this.deleteInfos, this.elementInfos, true);\r\n                _g2Creator2.default.executeChartConfig(this.chart, this.config, this.elementInfos);\r\n                _g2Creator2.default.synchronizeG2Add(this.chart, this.config, this.elementInfos);\r\n                this.chart.repaint();\r\n                this.resetStates();\r\n                return this.chart;\r\n            }\r\n        }, {\r\n            key: 'batchedUpdate',\r\n            value: function batchedUpdate() {\r\n                if (this.chart == null)\r\n                    return null;\r\n                if (this.config.chart.props.forceUpdate || _g2Update2.default.needRebuildChart(this.config)) {\r\n                    _configMerge2.default.merge(this.config, this.deleteInfos, this.elementInfos, true);\r\n                    this.chart.destroy();\r\n                    this.chart = 'destroy';\r\n                    return this.createG2Instance();\r\n                }\r\n                if (_g2Delete2.default.needReExecute(this.deleteInfos, this.elementInfos) || _g2Update2.default.needReExecute(this.config)) {\r\n                    this.reExecuteChart();\r\n                    return this.chart;\r\n                }\r\n                if (this.deleted) {\r\n                    _g2Delete2.default.synchronizeG2Delete(this.chart, this.config, this.deleteInfos, this.elementInfos);\r\n                    _configMerge2.default.mergeDelete(this.config, this.deleteInfos, this.elementInfos);\r\n                }\r\n                if (this.added) {\r\n                    _g2Creator2.default.synchronizeG2Add(this.chart, this.config);\r\n                }\r\n                if (this.updated) {\r\n                    _g2Update2.default.synchronizeG2Update(this.chart, this.config);\r\n                }\r\n                if (this.added || this.deleted || this.updated) {\r\n                    this.chart.repaint();\r\n                }\r\n                _configMerge2.default.mergeUpdate(this.config, false);\r\n                this.resetStates();\r\n                return this.chart;\r\n            }\r\n        }]);\r\n    return Processor;\r\n}();\r\nexports.default = Processor;\r\n",{"version":3,"file":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\bizcharts\\es6\\processor\\processor.js","sourceRoot":"","sources":["D:\\project\\Deecamp-project\\system\\Web\\node_modules\\bizcharts\\es6\\processor\\processor.js"],"names":[],"mappings":"AAAA,YAAY,CAAC;AAEb,MAAM,CAAC,cAAc,CAAC,OAAO,EAAE,YAAY,EAAE;IAC3C,KAAK,EAAE,IAAI;CACZ,CAAC,CAAC;AAEH,IAAI,QAAQ,GAAG,MAAM,CAAC,MAAM,IAAI,UAAU,MAAM,IAAI,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,SAAS,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;IAAE,IAAI,MAAM,GAAG,SAAS,CAAC,CAAC,CAAC,CAAC;IAAC,KAAK,IAAI,GAAG,IAAI,MAAM,EAAE;QAAE,IAAI,MAAM,CAAC,SAAS,CAAC,cAAc,CAAC,IAAI,CAAC,MAAM,EAAE,GAAG,CAAC,EAAE;YAAE,MAAM,CAAC,GAAG,CAAC,GAAG,MAAM,CAAC,GAAG,CAAC,CAAC;SAAE;KAAE;CAAE,CAAC,OAAO,MAAM,CAAC,CAAC,CAAC,CAAC;AAEjQ,IAAI,YAAY,GAAG,cAAc,SAAS,gBAAgB,CAAC,MAAM,EAAE,KAAK,IAAI,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;IAAE,IAAI,UAAU,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC;IAAC,UAAU,CAAC,UAAU,GAAG,UAAU,CAAC,UAAU,IAAI,KAAK,CAAC;IAAC,UAAU,CAAC,YAAY,GAAG,IAAI,CAAC;IAAC,IAAI,OAAO,IAAI,UAAU;QAAE,UAAU,CAAC,QAAQ,GAAG,IAAI,CAAC;IAAC,MAAM,CAAC,cAAc,CAAC,MAAM,EAAE,UAAU,CAAC,GAAG,EAAE,UAAU,CAAC,CAAC;CAAE,CAAC,CAAC,CAAC,OAAO,UAAU,WAAW,EAAE,UAAU,EAAE,WAAW,IAAI,IAAI,UAAU;IAAE,gBAAgB,CAAC,WAAW,CAAC,SAAS,EAAE,UAAU,CAAC,CAAC,CAAC,IAAI,WAAW;IAAE,gBAAgB,CAAC,WAAW,EAAE,WAAW,CAAC,CAAC,CAAC,OAAO,WAAW,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC;AAEpjB,IAAI,UAAU,GAAG,OAAO,CAAC,aAAa,CAAC,CAAC;AAExC,IAAI,WAAW,GAAG,sBAAsB,CAAC,UAAU,CAAC,CAAC;AAErD,IAAI,YAAY,GAAG,OAAO,CAAC,eAAe,CAAC,CAAC;AAE5C,IAAI,aAAa,GAAG,sBAAsB,CAAC,YAAY,CAAC,CAAC;AAEzD,IAAI,SAAS,GAAG,OAAO,CAAC,YAAY,CAAC,CAAC;AAEtC,IAAI,UAAU,GAAG,sBAAsB,CAAC,SAAS,CAAC,CAAC;AAEnD,IAAI,SAAS,GAAG,OAAO,CAAC,YAAY,CAAC,CAAC;AAEtC,IAAI,UAAU,GAAG,sBAAsB,CAAC,SAAS,CAAC,CAAC;AAEnD,IAAI,UAAU,GAAG,OAAO,CAAC,aAAa,CAAC,CAAC;AAExC,IAAI,WAAW,GAAG,sBAAsB,CAAC,UAAU,CAAC,CAAC;AAErD,IAAI,OAAO,GAAG,OAAO,CAAC,WAAW,CAAC,CAAC;AAEnC,SAAS,sBAAsB,CAAC,GAAG,IAAI,OAAO,GAAG,IAAI,GAAG,CAAC,UAAU,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,OAAO,EAAE,GAAG,EAAE,CAAC,CAAC,CAAC;AAE/F,SAAS,wBAAwB,CAAC,GAAG,EAAE,IAAI,IAAI,IAAI,MAAM,GAAG,EAAE,CAAC,CAAC,KAAK,IAAI,CAAC,IAAI,GAAG,EAAE;IAAE,IAAI,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,IAAI,CAAC;QAAE,SAAS;IAAC,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC,cAAc,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC,CAAC;QAAE,SAAS;IAAC,MAAM,CAAC,CAAC,CAAC,GAAG,GAAG,CAAC,CAAC,CAAC,CAAC;CAAE,CAAC,OAAO,MAAM,CAAC,CAAC,CAAC;AAE5N,SAAS,eAAe,CAAC,QAAQ,EAAE,WAAW,IAAI,IAAI,CAAC,CAAC,QAAQ,YAAY,WAAW,CAAC,EAAE;IAAE,MAAM,IAAI,SAAS,CAAC,mCAAmC,CAAC,CAAC;CAAE,CAAC,CAAC;AAEzJ,IAAI,SAAS,GAAG;IACd,SAAS,SAAS;QAChB,eAAe,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC;QAEjC,IAAI,CAAC,MAAM,GAAG,EAAE,CAAC;QACjB,IAAI,CAAC,YAAY,GAAG,EAAE,CAAC;QACvB,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;QACnB,IAAI,CAAC,QAAQ,GAAG,KAAK,CAAC;QACtB,IAAI,CAAC,OAAO,GAAG,KAAK,CAAC;QACrB,IAAI,CAAC,OAAO,GAAG,KAAK,CAAC;QACrB,IAAI,CAAC,WAAW,GAAG,EAAE,CAAC;IACxB,CAAC;IAED,YAAY,CAAC,SAAS,EAAE,CAAC;YACvB,GAAG,EAAE,eAAe;YACpB,KAAK,EAAE,SAAS,aAAa,CAAC,IAAI,EAAE,EAAE;gBAEpC,IAAI,qBAAqB,GAAG,IAAI,CAAC,YAAY,CAAC,EAAE,CAAC,CAAC,KAAK,EACnD,QAAQ,GAAG,qBAAqB,CAAC,QAAQ,EACzC,KAAK,GAAG,wBAAwB,CAAC,qBAAqB,EAAE,CAAC,UAAU,CAAC,CAAC,CAAC;gBAE1E,IAAI,qBAAqB,GAAG,IAAI,CAAC,YAAY,CAAC,EAAE,CAAC,CAAC,WAAW,EACzD,YAAY,GAAG,qBAAqB,CAAC,QAAQ,EAC7C,SAAS,GAAG,wBAAwB,CAAC,qBAAqB,EAAE,CAAC,UAAU,CAAC,CAAC,CAAC;gBAI9E,IAAI,IAAI,KAAK,OAAO,IAAI,IAAI,KAAK,MAAM,EAAE;oBACvC,IAAI,IAAI,GAAG,KAAK,CAAC,IAAI,EACjB,UAAU,GAAG,wBAAwB,CAAC,KAAK,EAAE,CAAC,MAAM,CAAC,CAAC,CAAC;oBAE3D,IAAI,QAAQ,GAAG,SAAS,CAAC,IAAI,EACzB,cAAc,GAAG,wBAAwB,CAAC,SAAS,EAAE,CAAC,MAAM,CAAC,CAAC,CAAC;oBAEnE,IAAI,IAAI,KAAK,QAAQ,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,OAAO,CAAC,UAAU,EAAE,cAAc,CAAC,EAAE;wBAC1E,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC;qBACrB;iBACF;qBAAM;oBACL,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,OAAO,CAAC,KAAK,EAAE,SAAS,CAAC,EAAE;wBAC3C,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC;qBACrB;iBACF;YACH,CAAC;SACF,EAAE;YACD,GAAG,EAAE,YAAY;YACjB,KAAK,EAAE,SAAS,UAAU,CAAC,IAAI,EAAE,EAAE,EAAE,KAAK,EAAE,UAAU,EAAE,MAAM;gBAC5D,IAAI,CAAC,IAAI,CAAC,KAAK,IAAI,IAAI,CAAC,QAAQ;oBAAE,OAAO;gBACzC,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC;gBAClB,IAAI,CAAC,YAAY,CAAC,EAAE,CAAC,GAAG;oBACtB,EAAE,EAAE,EAAE;oBACN,MAAM,EAAE,MAAM;oBACd,UAAU,EAAE,UAAU;oBACtB,IAAI,EAAE,IAAI;oBACV,KAAK,EAAE,QAAQ,CAAC,EAAE,EAAE,KAAK,CAAC;iBAC3B,CAAC;gBACF,IAAI,UAAU,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,UAAU,CAAC,EAAE,CAAC,EAAE;oBACnD,IAAI,CAAC,YAAY,CAAC,UAAU,CAAC,EAAE,CAAC,GAAG;wBACjC,EAAE,EAAE,UAAU,CAAC,EAAE;wBACjB,IAAI,EAAE,UAAU,CAAC,IAAI;qBACtB,CAAC;iBACH;gBAED,WAAW,CAAC,OAAO,CAAC,UAAU,CAAC,IAAI,EAAE,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,YAAY,CAAC,EAAE,CAAC,CAAC,CAAC;YAC3E,CAAC;SACF,EAAE;YACD,GAAG,EAAE,eAAe;YACpB,KAAK,EAAE,SAAS,aAAa,CAAC,IAAI,EAAE,EAAE,EAAE,KAAK;gBAC3C,IAAI,CAAC,YAAY,CAAC,EAAE,CAAC,CAAC,WAAW,GAAG,QAAQ,CAAC,EAAE,EAAE,KAAK,CAAC,CAAC;gBACxD,IAAI,CAAC,aAAa,CAAC,IAAI,EAAE,EAAE,CAAC,CAAC;YAC/B,CAAC;SACF,EAAE;YACD,GAAG,EAAE,eAAe;YACpB,KAAK,EAAE,SAAS,aAAa,CAAC,IAAI,EAAE,EAAE;gBACpC,IAAI,CAAC,IAAI,CAAC,KAAK;oBAAE,OAAO;gBAExB,IAAI,CAAC,WAAW,CAAC,EAAE,CAAC,GAAG,EAAE,CAAC;gBAC1B,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC;YACtB,CAAC;SACF,EAAE;YACD,GAAG,EAAE,kBAAkB;YACvB,KAAK,EAAE,SAAS,gBAAgB;gBAC9B,IAAI,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC;gBACzB,IAAI,KAAK,GAAG,WAAW,CAAC,OAAO,CAAC,WAAW,CAAC,MAAM,EAAE,IAAI,CAAC,YAAY,CAAC,CAAC;gBACvE,WAAW,CAAC,OAAO,CAAC,kBAAkB,CAAC,KAAK,EAAE,MAAM,EAAE,IAAI,CAAC,YAAY,CAAC,CAAC;gBACzE,WAAW,CAAC,OAAO,CAAC,gBAAgB,CAAC,KAAK,EAAE,MAAM,EAAE,IAAI,CAAC,YAAY,CAAC,CAAC;gBAEvE,KAAK,CAAC,MAAM,EAAE,CAAC;gBAEf,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;gBACnB,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;gBACrB,IAAI,CAAC,WAAW,EAAE,CAAC;gBACnB,OAAO,KAAK,CAAC;YACf,CAAC;SACF,EAAE;YACD,GAAG,EAAE,SAAS;YACd,KAAK,EAAE,SAAS,OAAO;gBACrB,IAAI,CAAC,KAAK,CAAC,OAAO,EAAE,CAAC;gBACrB,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC;YACpB,CAAC;SACF,EAAE;YACD,GAAG,EAAE,aAAa;YAClB,KAAK,EAAE,SAAS,WAAW;gBACzB,IAAI,KAAK,GAAG,IAAI,CAAC,YAAY,CAAC;gBAC9B,KAAK,IAAI,EAAE,IAAI,KAAK,EAAE;oBACpB,IAAI,KAAK,CAAC,EAAE,CAAC,CAAC,WAAW;wBAAE,OAAO,KAAK,CAAC,EAAE,CAAC,CAAC,WAAW,CAAC;oBACxD,IAAI,IAAI,CAAC,WAAW,CAAC,EAAE,CAAC,EAAE;wBACxB,OAAO,KAAK,CAAC,EAAE,CAAC,CAAC;qBAClB;iBACF;gBACD,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;gBACnB,IAAI,CAAC,OAAO,GAAG,KAAK,CAAC;gBACrB,IAAI,CAAC,WAAW,GAAG,EAAE,CAAC;YACxB,CAAC;SACF,EAAE;YACD,GAAG,EAAE,gBAAgB;YACrB,KAAK,EAAE,SAAS,cAAc;gBAC5B,IAAI,CAAC,KAAK,CAAC,KAAK,EAAE,CAAC;gBACnB,aAAa,CAAC,OAAO,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,WAAW,EAAE,IAAI,CAAC,YAAY,EAAE,IAAI,CAAC,CAAC;gBACpF,WAAW,CAAC,OAAO,CAAC,kBAAkB,CAAC,IAAI,CAAC,KAAK,EAAE,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,YAAY,CAAC,CAAC;gBACnF,WAAW,CAAC,OAAO,CAAC,gBAAgB,CAAC,IAAI,CAAC,KAAK,EAAE,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,YAAY,CAAC,CAAC;gBACjF,IAAI,CAAC,KAAK,CAAC,OAAO,EAAE,CAAC;gBACrB,IAAI,CAAC,WAAW,EAAE,CAAC;gBACnB,OAAO,IAAI,CAAC,KAAK,CAAC;YACpB,CAAC;SACF,EAAE;YACD,GAAG,EAAE,eAAe;YACpB,KAAK,EAAE,SAAS,aAAa;gBAC3B,IAAI,IAAI,CAAC,KAAK,IAAI,IAAI;oBAAE,OAAO,IAAI,CAAC;gBACpC,IAAI,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,KAAK,CAAC,WAAW,IAAI,UAAU,CAAC,OAAO,CAAC,gBAAgB,CAAC,IAAI,CAAC,MAAM,CAAC,EAAE;oBAC3F,aAAa,CAAC,OAAO,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,WAAW,EAAE,IAAI,CAAC,YAAY,EAAE,IAAI,CAAC,CAAC;oBACpF,IAAI,CAAC,KAAK,CAAC,OAAO,EAAE,CAAC;oBACrB,IAAI,CAAC,KAAK,GAAG,SAAS,CAAC;oBACvB,OAAO,IAAI,CAAC,gBAAgB,EAAE,CAAC;iBAChC;gBACD,IAAI,UAAU,CAAC,OAAO,CAAC,aAAa,CAAC,IAAI,CAAC,WAAW,EAAE,IAAI,CAAC,YAAY,CAAC,IAAI,UAAU,CAAC,OAAO,CAAC,aAAa,CAAC,IAAI,CAAC,MAAM,CAAC,EAAE;oBAC1H,IAAI,CAAC,cAAc,EAAE,CAAC;oBACtB,OAAO,IAAI,CAAC,KAAK,CAAC;iBACnB;gBAED,IAAI,IAAI,CAAC,OAAO,EAAE;oBAChB,UAAU,CAAC,OAAO,CAAC,mBAAmB,CAAC,IAAI,CAAC,KAAK,EAAE,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,WAAW,EAAE,IAAI,CAAC,YAAY,CAAC,CAAC;oBACrG,aAAa,CAAC,OAAO,CAAC,WAAW,CAAC,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,WAAW,EAAE,IAAI,CAAC,YAAY,CAAC,CAAC;iBACrF;gBAED,IAAI,IAAI,CAAC,KAAK,EAAE;oBACd,WAAW,CAAC,OAAO,CAAC,gBAAgB,CAAC,IAAI,CAAC,KAAK,EAAE,IAAI,CAAC,MAAM,CAAC,CAAC;iBAC/D;gBACD,IAAI,IAAI,CAAC,OAAO,EAAE;oBAChB,UAAU,CAAC,OAAO,CAAC,mBAAmB,CAAC,IAAI,CAAC,KAAK,EAAE,IAAI,CAAC,MAAM,CAAC,CAAC;iBACjE;gBACD,IAAI,IAAI,CAAC,KAAK,IAAI,IAAI,CAAC,OAAO,IAAI,IAAI,CAAC,OAAO,EAAE;oBAC9C,IAAI,CAAC,KAAK,CAAC,OAAO,EAAE,CAAC;iBACtB;gBAED,aAAa,CAAC,OAAO,CAAC,WAAW,CAAC,IAAI,CAAC,MAAM,EAAE,KAAK,CAAC,CAAC;gBACtD,IAAI,CAAC,WAAW,EAAE,CAAC;gBAEnB,OAAO,IAAI,CAAC,KAAK,CAAC;YACpB,CAAC;SACF,CAAC,CAAC,CAAC;IAEJ,OAAO,SAAS,CAAC;AACnB,CAAC,EAAE,CAAC;AAEJ,OAAO,CAAC,OAAO,GAAG,SAAS,CAAC","sourcesContent":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _configAdd = require('./configAdd');\n\nvar _configAdd2 = _interopRequireDefault(_configAdd);\n\nvar _configMerge = require('./configMerge');\n\nvar _configMerge2 = _interopRequireDefault(_configMerge);\n\nvar _g2Update = require('./g2Update');\n\nvar _g2Update2 = _interopRequireDefault(_g2Update);\n\nvar _g2Delete = require('./g2Delete');\n\nvar _g2Delete2 = _interopRequireDefault(_g2Delete);\n\nvar _g2Creator = require('./g2Creator');\n\nvar _g2Creator2 = _interopRequireDefault(_g2Creator);\n\nvar _shared = require('../shared');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _objectWithoutProperties(obj, keys) { var target = {}; for (var i in obj) { if (keys.indexOf(i) >= 0) continue; if (!Object.prototype.hasOwnProperty.call(obj, i)) continue; target[i] = obj[i]; } return target; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Processor = function () {\n  function Processor() {\n    _classCallCheck(this, Processor);\n\n    this.config = {};\n    this.elementInfos = {};\n    this.added = false;\n    this.initedG2 = false;\n    this.updated = false;\n    this.deleted = false;\n    this.deleteInfos = {};\n  }\n\n  _createClass(Processor, [{\n    key: 'calUpdateFlag',\n    value: function calUpdateFlag(name, id) {\n      /* eslint-disable  no-unused-vars */\n      var _elementInfos$id$prop = this.elementInfos[id].props,\n          children = _elementInfos$id$prop.children,\n          props = _objectWithoutProperties(_elementInfos$id$prop, ['children']);\n\n      var _elementInfos$id$upda = this.elementInfos[id].updateProps,\n          nextChildren = _elementInfos$id$upda.children,\n          nextProps = _objectWithoutProperties(_elementInfos$id$upda, ['children']);\n      /* eslint-enable */\n\n\n      if (name === 'Chart' || name === 'View') {\n        var data = props.data,\n            otherProps = _objectWithoutProperties(props, ['data']);\n\n        var nextData = nextProps.data,\n            nextOtherProps = _objectWithoutProperties(nextProps, ['data']);\n\n        if (data !== nextData || !_shared.Util.isEqual(otherProps, nextOtherProps)) {\n          this.updated = true;\n        }\n      } else {\n        if (!_shared.Util.isEqual(props, nextProps)) {\n          this.updated = true;\n        }\n      }\n    }\n  }, {\n    key: 'addElement',\n    value: function addElement(name, id, props, parentInfo, viewId) {\n      if (!this.chart && this.initedG2) return;\n      this.added = true;\n      this.elementInfos[id] = {\n        id: id,\n        viewId: viewId,\n        parentInfo: parentInfo,\n        name: name,\n        props: _extends({}, props)\n      };\n      if (parentInfo && !this.elementInfos[parentInfo.id]) {\n        this.elementInfos[parentInfo.id] = {\n          id: parentInfo.id,\n          name: parentInfo.name\n        };\n      }\n\n      _configAdd2.default.addElement(name, this.config, this.elementInfos[id]);\n    }\n  }, {\n    key: 'updateElement',\n    value: function updateElement(name, id, props) {\n      this.elementInfos[id].updateProps = _extends({}, props);\n      this.calUpdateFlag(name, id);\n    }\n  }, {\n    key: 'deleteElement',\n    value: function deleteElement(name, id) {\n      if (!this.chart) return;\n\n      this.deleteInfos[id] = id;\n      this.deleted = true;\n    }\n  }, {\n    key: 'createG2Instance',\n    value: function createG2Instance() {\n      var config = this.config;\n      var chart = _g2Creator2.default.createChart(config, this.elementInfos);\n      _g2Creator2.default.executeChartConfig(chart, config, this.elementInfos);\n      _g2Creator2.default.synchronizeG2Add(chart, config, this.elementInfos);\n\n      chart.render();\n\n      this.chart = chart;\n      this.initedG2 = true;\n      this.resetStates();\n      return chart;\n    }\n  }, {\n    key: 'destory',\n    value: function destory() {\n      this.chart.destroy();\n      this.chart = null;\n    }\n  }, {\n    key: 'resetStates',\n    value: function resetStates() {\n      var elems = this.elementInfos;\n      for (var id in elems) {\n        if (elems[id].updateProps) delete elems[id].updateProps;\n        if (this.deleteInfos[id]) {\n          delete elems[id];\n        }\n      }\n      this.added = false;\n      this.updated = false;\n      this.deleteInfos = {};\n    }\n  }, {\n    key: 'reExecuteChart',\n    value: function reExecuteChart() {\n      this.chart.clear();\n      _configMerge2.default.merge(this.config, this.deleteInfos, this.elementInfos, true);\n      _g2Creator2.default.executeChartConfig(this.chart, this.config, this.elementInfos);\n      _g2Creator2.default.synchronizeG2Add(this.chart, this.config, this.elementInfos);\n      this.chart.repaint();\n      this.resetStates();\n      return this.chart;\n    }\n  }, {\n    key: 'batchedUpdate',\n    value: function batchedUpdate() {\n      if (this.chart == null) return null;\n      if (this.config.chart.props.forceUpdate || _g2Update2.default.needRebuildChart(this.config)) {\n        _configMerge2.default.merge(this.config, this.deleteInfos, this.elementInfos, true);\n        this.chart.destroy();\n        this.chart = 'destroy';\n        return this.createG2Instance();\n      }\n      if (_g2Delete2.default.needReExecute(this.deleteInfos, this.elementInfos) || _g2Update2.default.needReExecute(this.config)) {\n        this.reExecuteChart();\n        return this.chart;\n      }\n\n      if (this.deleted) {\n        _g2Delete2.default.synchronizeG2Delete(this.chart, this.config, this.deleteInfos, this.elementInfos);\n        _configMerge2.default.mergeDelete(this.config, this.deleteInfos, this.elementInfos);\n      }\n\n      if (this.added) {\n        _g2Creator2.default.synchronizeG2Add(this.chart, this.config);\n      }\n      if (this.updated) {\n        _g2Update2.default.synchronizeG2Update(this.chart, this.config);\n      }\n      if (this.added || this.deleted || this.updated) {\n        this.chart.repaint();\n      }\n\n      _configMerge2.default.mergeUpdate(this.config, false);\n      this.resetStates();\n\n      return this.chart;\n    }\n  }]);\n\n  return Processor;\n}();\n\nexports.default = Processor;"]}]}