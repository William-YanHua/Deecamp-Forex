{"remainingRequest":"/run/media/williamyh/新加卷/project/Deecamp-project/system/Web/node_modules/ts-loader/index.js??ref--4-1!/run/media/williamyh/新加卷/project/Deecamp-project/system/Web/src/app/pages/hoc/RequireLogin.tsx","dependencies":[{"path":"/run/media/williamyh/新加卷/project/Deecamp-project/system/Web/src/app/pages/hoc/RequireLogin.tsx","mtime":1596379644607},{"path":"/run/media/williamyh/新加卷/project/Deecamp-project/system/Web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/run/media/williamyh/新加卷/project/Deecamp-project/system/Web/node_modules/ts-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":["var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nimport React from \"react\";\nimport { observer } from \"mobx-react\";\nimport { Inject } from \"react.di\";\nimport { UserStore } from \"../../stores/UserStore\";\nimport { LocaleMessage } from \"../../internationalization/components\";\nimport lang from \"../../internationalization/LocaleStore/lang\";\nimport { UiStore } from \"../../stores/UiStore\";\nimport { withRouter } from \"react-router\";\nvar root = lang().common.login;\nexport function requireLogin() {\n    var roles = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        roles[_i] = arguments[_i];\n    }\n    return function (WrappedComponent) {\n        var Component = (function (_super) {\n            __extends(Component, _super);\n            function Component() {\n                return _super !== null && _super.apply(this, arguments) || this;\n            }\n            Component.prototype.render = function () {\n                if (!this.userStore.loggedIn) {\n                    return React.createElement(\"a\", { onClick: this.uiStore.toggleLoginModalShown },\n                        React.createElement(LocaleMessage, { id: root.needLogin }));\n                }\n                if (roles.length > 0 && !roles.includes(this.userStore.user.role)) {\n                    return React.createElement(LocaleMessage, { id: root.roleNotMatch, replacements: {} });\n                }\n                return React.createElement(WrappedComponent, __assign({}, this.props, { user: this.userStore.user }));\n            };\n            var _a, _b;\n            __decorate([\n                Inject,\n                __metadata(\"design:type\", typeof (_a = typeof UserStore !== \"undefined\" && UserStore) === \"function\" ? _a : Object)\n            ], Component.prototype, \"userStore\", void 0);\n            __decorate([\n                Inject,\n                __metadata(\"design:type\", typeof (_b = typeof UiStore !== \"undefined\" && UiStore) === \"function\" ? _b : Object)\n            ], Component.prototype, \"uiStore\", void 0);\n            Component = __decorate([\n                observer\n            ], Component);\n            return Component;\n        }(React.Component));\n        return withRouter(Component);\n    };\n}\n",{"version":3,"file":"/run/media/williamyh/新加卷/project/Deecamp-project/system/Web/src/app/pages/hoc/RequireLogin.tsx","sourceRoot":"","sources":["/run/media/williamyh/新加卷/project/Deecamp-project/system/Web/src/app/pages/hoc/RequireLogin.tsx"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,OAAO,KAAK,MAAM,OAAO,CAAC;AAC1B,OAAO,EAAE,QAAQ,EAAE,MAAM,YAAY,CAAC;AAEtC,OAAO,EAAE,MAAM,EAAE,MAAM,UAAU,CAAC;AAClC,OAAO,EAAE,SAAS,EAAE,MAAM,wBAAwB,CAAC;AACnD,OAAO,EAAE,aAAa,EAAE,MAAM,uCAAuC,CAAC;AACtE,OAAO,IAAI,MAAM,6CAA6C,CAAC;AAC/D,OAAO,EAAE,OAAO,EAAE,MAAM,sBAAsB,CAAC;AAC/C,OAAO,EAAE,UAAU,EAAE,MAAM,cAAc,CAAC;AAE1C,IAAM,IAAI,GAAG,IAAI,EAAE,CAAC,MAAM,CAAC,KAAK,CAAC;AAUjC,MAAM,UAAU,YAAY;IAAC,eAAoB;SAApB,UAAoB,EAApB,qBAAoB,EAApB,IAAoB;QAApB,0BAAoB;;IAE/C,OAAO,UAAS,gBAAgB;QAE9B;YAAwB,6BAAe;YAAvC;;YAsBA,CAAC;YAjBC,0BAAM,GAAN;gBAEE,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,QAAQ,EAAE;oBAC5B,OAAO,2BAAG,OAAO,EAAE,IAAI,CAAC,OAAO,CAAC,qBAAqB;wBACnD,oBAAC,aAAa,IAAC,EAAE,EAAE,IAAI,CAAC,SAAS,GAAI,CACnC,CAAC;iBACN;gBACD,IAAI,KAAK,CAAC,MAAM,GAAG,CAAC,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE;oBACjE,OAAO,oBAAC,aAAa,IAAC,EAAE,EAAE,IAAI,CAAC,YAAY,EAAE,YAAY,EAAE,EAE1D,GAAG,CAAC;iBACN;gBACD,OAAO,oBAAC,gBAAgB,eAAK,IAAI,CAAC,KAAK,IACd,IAAI,EAAE,IAAI,CAAC,SAAS,CAAC,IAAI,IAChD,CAAC;YACL,CAAC;;YAlBO;gBAAP,MAAM;8DAAY,SAAS,oBAAT,SAAS;wDAAC;YACrB;gBAAP,MAAM;8DAAU,OAAO,oBAAP,OAAO;sDAAC;YAHrB,SAAS;gBADd,QAAQ;eACH,SAAS,CAsBd;YAAD,gBAAC;SAAA,AAtBD,CAAwB,KAAK,CAAC,SAAS,GAsBtC;QAED,OAAO,UAAU,CAAC,SAAgB,CAAC,CAAC;IACtC,CAAC,CAAC;AACJ,CAAC","sourcesContent":["import React from \"react\";\r\nimport { observer } from \"mobx-react\";\r\nimport { User, UserRole } from \"../../models/user/User\";\r\nimport { Inject } from \"react.di\";\r\nimport { UserStore } from \"../../stores/UserStore\";\r\nimport { LocaleMessage } from \"../../internationalization/components\";\r\nimport lang from \"../../internationalization/LocaleStore/lang\";\r\nimport { UiStore } from \"../../stores/UiStore\";\r\nimport { withRouter } from \"react-router\";\r\n\r\nconst root = lang().common.login;\r\n/**\r\n * Marks that the component needs authentication.\r\n * Authentication will be run before the component is rendered.\r\n * If authentication succeeded,\r\n *  returns the wrapped component with { user: User } injected into props.\r\n * Otherwise,\r\n *  error will be rendered.\r\n * @param roles Accepted Roles. Empty is considered to accepted all roles.\r\n */\r\nexport function requireLogin(...roles: UserRole[]) {\r\n  /* tslint:disable-next-line:only-arrow-functions */\r\n  return function(WrappedComponent): any {\r\n    @observer\r\n    class Component extends React.Component {\r\n\r\n      @Inject userStore: UserStore;\r\n      @Inject uiStore: UiStore;\r\n\r\n      render() {\r\n\r\n        if (!this.userStore.loggedIn) {\r\n          return <a onClick={this.uiStore.toggleLoginModalShown}>\r\n            <LocaleMessage id={root.needLogin} />\r\n          </a>;\r\n        }\r\n        if (roles.length > 0 && !roles.includes(this.userStore.user.role)) {\r\n          return <LocaleMessage id={root.roleNotMatch} replacements={{\r\n\r\n          }}/>;\r\n        }\r\n        return <WrappedComponent {...this.props}\r\n                                 user={this.userStore.user}\r\n        />;\r\n      }\r\n\r\n    }\r\n\r\n    return withRouter(Component as any);\r\n  };\r\n}\r\n\r\nexport interface RequireLoginProps {\r\n  user?: User;\r\n}\r\n"]}]}