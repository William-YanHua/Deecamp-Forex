{"remainingRequest":"/run/media/williamyh/新加卷/project/Deecamp-project/system/Web/node_modules/ts-loader/index.js??ref--4-1!/run/media/williamyh/新加卷/project/Deecamp-project/system/Web/node_modules/@antv/g2plot/esm/plots/heatmap/component/legend.js","dependencies":[{"path":"/run/media/williamyh/新加卷/project/Deecamp-project/system/Web/node_modules/@antv/g2plot/esm/plots/heatmap/component/legend.js","mtime":499162500000},{"path":"/run/media/williamyh/新加卷/project/Deecamp-project/system/Web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/run/media/williamyh/新加卷/project/Deecamp-project/system/Web/node_modules/ts-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import { __assign } from \"tslib\";\nimport { each, isArray, deepMix } from '@antv/util';\nimport BBox from '../../../util/bbox';\nvar LABEL_MARGIN = 4;\nvar MatrixLegend = (function () {\n    function MatrixLegend(cfg) {\n        this.destroyed = false;\n        this.dataSlides = {};\n        this.interactiveEvents = {};\n        var defaultOptions = this.getDefaultOptions();\n        this.options = deepMix({}, defaultOptions, cfg);\n        this.view = this.options.view;\n        this.afterRender = true;\n        this.init();\n    }\n    MatrixLegend.prototype.init = function () {\n        var _this = this;\n        this.layout = this.getLayout();\n        this.width = this.options.width ? this.options.width : this.getDefaultWidth();\n        this.height = this.options.height ? this.options.height : this.getDefaultHeight();\n        var plotContainer = this.options.plot.container;\n        if (this.container) {\n            this.container.remove();\n        }\n        this.container = plotContainer.addGroup();\n        this.view.on('beforerender', function () {\n            _this.clear();\n            _this.options.plot.canvas.draw();\n        });\n    };\n    MatrixLegend.prototype.render = function () {\n        var scales = this.view.geometries[0].scales;\n        var colorField = this.options.plot.options.colorField;\n        this.colorScale = scales[colorField];\n        var _a = this.colorScale, min = _a.min, max = _a.max;\n        var color = this.options.plot.options.color;\n        if (this.layout === 'horizontal') {\n            this.renderHorizontal(min, max, color);\n        }\n        else {\n            this.renderVertical(min, max, color);\n        }\n        this.legendLayout();\n        this.addInteraction();\n    };\n    MatrixLegend.prototype.hide = function () {\n        this.container.set('visible', false);\n        this.options.plot.canvas.draw();\n    };\n    MatrixLegend.prototype.show = function () {\n        this.container.set('visible', true);\n        this.options.plot.canvas.draw();\n    };\n    MatrixLegend.prototype.clear = function () {\n        if (this.container) {\n            this.container.clear();\n        }\n    };\n    MatrixLegend.prototype.destroy = function () {\n        if (this.container) {\n            this.container.remove();\n        }\n        this.offEvent();\n        this.destroyed = true;\n    };\n    MatrixLegend.prototype.getBBox = function () {\n        var origin_bbox = this.container.getBBox();\n        return new BBox(this.x, this.y, origin_bbox.width, origin_bbox.height);\n    };\n    MatrixLegend.prototype.renderVertical = function (min, max, colors) {\n        var _this = this;\n        var valueStep = (max - min) / (colors.length - 1);\n        var colorStep = 1 / (colors.length - 1);\n        var tickStep = this.height / (colors.length - 1);\n        var gradientColor = 'l(90)';\n        each(colors, function (c, index) {\n            var stepNum = colorStep * index;\n            gradientColor += stepNum + \":\" + c + \" \";\n        });\n        this.container.addShape('rect', {\n            attrs: {\n                x: 0,\n                y: 0,\n                width: this.width,\n                height: this.height,\n                fill: gradientColor,\n            },\n            name: 'legend',\n        });\n        each(colors, function (c, index) {\n            var step = tickStep * index;\n            _this.container.addShape('path', {\n                attrs: __assign({ path: [\n                        ['M', 0, step],\n                        ['L', _this.width, step],\n                    ] }, _this.options.ticklineStyle),\n            });\n            var value = Math.round(valueStep * index);\n            _this.container.addShape('text', {\n                attrs: __assign({ text: value, textAlign: 'left', textBaseline: 'middle', x: _this.width + LABEL_MARGIN, y: step }, _this.options.text.style),\n                name: 'legend-label',\n            });\n        });\n        var tri_width = 10;\n        var tri_height = 14;\n        var tri_path = [['M', -tri_width, -tri_height / 2], ['L', 0, 0], ['L', -tri_width, tri_height / 2], ['Z']];\n        this.anchor = this.container.addShape('path', {\n            attrs: __assign({ path: tri_path }, this.options.anchorStyle),\n        });\n        this.anchor.set('visible', false);\n    };\n    MatrixLegend.prototype.renderHorizontal = function (min, max, colors) {\n        var _this = this;\n        var valueStep = (max - min) / (colors.length - 1);\n        var colorStep = 1 / (colors.length - 1);\n        var tickStep = this.width / (colors.length - 1);\n        var gradientColor = 'l(0)';\n        each(colors, function (c, index) {\n            var stepNum = colorStep * index;\n            gradientColor += stepNum + \":\" + c + \" \";\n        });\n        this.container.addShape('rect', {\n            attrs: {\n                x: 0,\n                y: 0,\n                width: this.width,\n                height: this.height,\n                fill: gradientColor,\n            },\n            name: 'legend',\n        });\n        each(colors, function (c, index) {\n            var step = tickStep * index;\n            _this.container.addShape('path', {\n                attrs: __assign({ path: [\n                        ['M', step, 0],\n                        ['L', step, _this.height],\n                    ] }, _this.options.ticklineStyle),\n                name: 'legend-label',\n            });\n            var value = Math.round(valueStep * index);\n            _this.container.addShape('text', {\n                attrs: __assign({ text: value, textAlign: 'center', textBaseline: 'top', x: step, y: _this.height + LABEL_MARGIN }, _this.options.text.style),\n            });\n        });\n        var tri_width = 14;\n        var tri_height = 10;\n        var tri_path = [['M', 0, 0], ['L', -tri_width / 2, -tri_height], ['L', tri_width / 2, -tri_height], ['Z']];\n        this.anchor = this.container.addShape('path', {\n            attrs: __assign({ path: tri_path }, this.options.anchorStyle),\n        });\n        this.anchor.set('visible', false);\n    };\n    MatrixLegend.prototype.getLayout = function () {\n        var positions = this.options.position.split('-');\n        this.position = positions[0];\n        if (positions[0] === 'left' || positions[0] === 'right') {\n            return 'vertical';\n        }\n        return 'horizontal';\n    };\n    MatrixLegend.prototype.getDefaultWidth = function () {\n        if (this.layout === 'horizontal') {\n            var width = this.view.coordinateBBox.width;\n            return width;\n        }\n        return 10;\n    };\n    MatrixLegend.prototype.getDefaultHeight = function () {\n        if (this.layout === 'vertical') {\n            var height = this.view.coordinateBBox.height;\n            return height;\n        }\n        return 10;\n    };\n    MatrixLegend.prototype.legendLayout = function () {\n        var _this = this;\n        var panelRange = this.view.coordinateBBox;\n        var bleeding = this.options.plot.getPlotTheme().bleeding;\n        if (isArray(bleeding)) {\n            each(bleeding, function (it, index) {\n                if (typeof bleeding[index] === 'function') {\n                    bleeding[index] = bleeding[index](_this.options.plot.options);\n                }\n            });\n        }\n        var bbox = this.container.getBBox();\n        var x = 0;\n        var y = 0;\n        var positions = this.options.position.split('-');\n        var plotWidth = this.options.plot.width;\n        var plotHeight = this.options.plot.height;\n        if (positions[0] === 'left') {\n            x = bleeding[3];\n        }\n        else if (positions[0] === 'right') {\n            x = plotWidth - bleeding[1] - bbox.width;\n        }\n        else if (positions[1] === 'center') {\n            if (this.width === panelRange.width) {\n                x = panelRange.x;\n            }\n            else {\n                x = (plotWidth - bbox.width) / 2;\n            }\n        }\n        else if (positions[1] === 'left') {\n            x = bleeding[3];\n        }\n        else if (positions[1] === 'right') {\n            x = this.options.plot.width - bleeding[1] - bbox.width;\n        }\n        if (positions[0] === 'bottom') {\n            y = plotHeight - bleeding[2] - bbox.height;\n        }\n        else if (positions[0] === 'top') {\n            y = this.getTopPosition(bleeding);\n        }\n        else if (positions[1] === 'center') {\n            if (this.height === panelRange.height) {\n                y = panelRange.y;\n            }\n            else {\n                y = (plotHeight - bbox.height) / 2;\n            }\n        }\n        else if (positions[1] === 'top') {\n            y = bleeding[0];\n        }\n        else if (positions[1] === 'bottom') {\n            y = plotHeight - bleeding[2] - bbox.height;\n        }\n        this.x = x;\n        this.y = y;\n        this.container.translate(x, y);\n    };\n    MatrixLegend.prototype.getDefaultOptions = function () {\n        return {\n            text: {\n                style: {\n                    fontSize: 12,\n                    fill: 'rgba(0, 0, 0, 0.45)',\n                },\n            },\n            ticklineStyle: {\n                lineWidth: 1,\n                stroke: 'rgba(0, 0, 0, 0.8)',\n            },\n            anchorStyle: {\n                fill: 'rgba(0,0,0,0.5)',\n            },\n            triggerOn: 'mousemove',\n        };\n    };\n    MatrixLegend.prototype.addInteraction = function () {\n        var _this = this;\n        var geomType;\n        if (this.options.plot.options.shapeType === 'rect') {\n            geomType = 'polygon';\n        }\n        else {\n            geomType = 'point';\n        }\n        var eventName = geomType + \":\" + this.options.triggerOn;\n        var field = this.options.plot.options.colorField;\n        var _a = this.colorScale, min = _a.min, max = _a.max;\n        var geomEventHandler = function (ev) {\n            var value = ev.data.data[field];\n            var ratio = (value - min) / (max - min);\n            _this.moveAnchor(ratio);\n        };\n        this.view.on(eventName, geomEventHandler);\n        this.interactiveEvents[eventName] = {\n            target: this.view,\n            handler: geomEventHandler,\n        };\n        var mouseleaveHandler = function () {\n            _this.anchor.set('visible', false);\n        };\n        this.options.plot.canvas.on('mouseleave', mouseleaveHandler);\n        this.interactiveEvents.mouseleave = {\n            target: this.options.plot.canvas,\n            handler: mouseleaveHandler,\n        };\n    };\n    MatrixLegend.prototype.moveAnchor = function (ratio) {\n        this.anchor.set('visible', true);\n        if (this.layout === 'vertical') {\n            var pos = this.height * ratio;\n            var ulMatrix = [1, 0, 0, 0, 1, 0, 0, 0, 1];\n            ulMatrix[7] = pos;\n            this.anchor.stopAnimate();\n            this.anchor.animate({\n                matrix: ulMatrix,\n            }, 400, 'easeLinear');\n        }\n        else {\n            var pos = this.width * ratio;\n            var ulMatrix = [1, 0, 0, 0, 1, 0, 0, 0, 1];\n            ulMatrix[6] = pos;\n            this.anchor.stopAnimate();\n            this.anchor.animate({\n                matrix: ulMatrix,\n            }, 400, 'easeLinear');\n        }\n    };\n    MatrixLegend.prototype.getTopPosition = function (bleeding) {\n        if (this.options.plot.description) {\n            var bbox = this.options.plot.description.getBBox();\n            return bbox.maxY + 10;\n        }\n        else if (this.options.plot.title) {\n            var bbox = this.options.plot.title.getBBox();\n            return bbox.maxY + 10;\n        }\n        return bleeding[0];\n    };\n    MatrixLegend.prototype.offEvent = function () {\n        each(this.interactiveEvents, function (event, key) {\n            var target = event.target, handler = event.handler;\n            target.off(key, handler);\n        });\n    };\n    return MatrixLegend;\n}());\nexport default MatrixLegend;\n",{"version":3,"file":"/run/media/williamyh/新加卷/project/Deecamp-project/system/Web/node_modules/@antv/g2plot/esm/plots/heatmap/component/legend.js","sourceRoot":"","sources":["/run/media/williamyh/新加卷/project/Deecamp-project/system/Web/node_modules/@antv/g2plot/esm/plots/heatmap/component/legend.js"],"names":[],"mappings":"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","sourcesContent":["import { __assign } from \"tslib\";\nimport { each, isArray, deepMix } from '@antv/util';\nimport BBox from '../../../util/bbox';\nvar LABEL_MARGIN = 4;\nvar MatrixLegend = /** @class */ (function () {\n    function MatrixLegend(cfg) {\n        this.destroyed = false;\n        this.dataSlides = {};\n        this.interactiveEvents = {};\n        var defaultOptions = this.getDefaultOptions();\n        this.options = deepMix({}, defaultOptions, cfg);\n        this.view = this.options.view;\n        this.afterRender = true;\n        this.init();\n    }\n    MatrixLegend.prototype.init = function () {\n        var _this = this;\n        this.layout = this.getLayout();\n        this.width = this.options.width ? this.options.width : this.getDefaultWidth();\n        this.height = this.options.height ? this.options.height : this.getDefaultHeight();\n        var plotContainer = this.options.plot.container;\n        if (this.container) {\n            this.container.remove();\n        }\n        this.container = plotContainer.addGroup();\n        this.view.on('beforerender', function () {\n            _this.clear();\n            _this.options.plot.canvas.draw();\n        });\n    };\n    MatrixLegend.prototype.render = function () {\n        var scales = this.view.geometries[0].scales;\n        var colorField = this.options.plot.options.colorField;\n        this.colorScale = scales[colorField];\n        var _a = this.colorScale, min = _a.min, max = _a.max;\n        var color = this.options.plot.options.color;\n        if (this.layout === 'horizontal') {\n            this.renderHorizontal(min, max, color);\n        }\n        else {\n            this.renderVertical(min, max, color);\n        }\n        this.legendLayout();\n        this.addInteraction();\n    };\n    MatrixLegend.prototype.hide = function () {\n        this.container.set('visible', false);\n        this.options.plot.canvas.draw();\n    };\n    MatrixLegend.prototype.show = function () {\n        this.container.set('visible', true);\n        this.options.plot.canvas.draw();\n    };\n    MatrixLegend.prototype.clear = function () {\n        if (this.container) {\n            this.container.clear();\n        }\n    };\n    MatrixLegend.prototype.destroy = function () {\n        if (this.container) {\n            this.container.remove();\n        }\n        this.offEvent();\n        this.destroyed = true;\n    };\n    MatrixLegend.prototype.getBBox = function () {\n        var origin_bbox = this.container.getBBox();\n        return new BBox(this.x, this.y, origin_bbox.width, origin_bbox.height);\n    };\n    MatrixLegend.prototype.renderVertical = function (min, max, colors) {\n        var _this = this;\n        var valueStep = (max - min) / (colors.length - 1);\n        var colorStep = 1 / (colors.length - 1);\n        var tickStep = this.height / (colors.length - 1);\n        var gradientColor = 'l(90)';\n        each(colors, function (c, index) {\n            var stepNum = colorStep * index;\n            gradientColor += stepNum + \":\" + c + \" \";\n        });\n        this.container.addShape('rect', {\n            attrs: {\n                x: 0,\n                y: 0,\n                width: this.width,\n                height: this.height,\n                fill: gradientColor,\n            },\n            name: 'legend',\n        });\n        // draw tick and label\n        each(colors, function (c, index) {\n            // tick\n            var step = tickStep * index;\n            _this.container.addShape('path', {\n                attrs: __assign({ path: [\n                        ['M', 0, step],\n                        ['L', _this.width, step],\n                    ] }, _this.options.ticklineStyle),\n            });\n            // value\n            var value = Math.round(valueStep * index);\n            _this.container.addShape('text', {\n                attrs: __assign({ text: value, textAlign: 'left', textBaseline: 'middle', x: _this.width + LABEL_MARGIN, y: step }, _this.options.text.style),\n                name: 'legend-label',\n            });\n        });\n        //anchor\n        var tri_width = 10;\n        var tri_height = 14;\n        var tri_path = [['M', -tri_width, -tri_height / 2], ['L', 0, 0], ['L', -tri_width, tri_height / 2], ['Z']];\n        this.anchor = this.container.addShape('path', {\n            attrs: __assign({ path: tri_path }, this.options.anchorStyle),\n        });\n        this.anchor.set('visible', false);\n    };\n    MatrixLegend.prototype.renderHorizontal = function (min, max, colors) {\n        var _this = this;\n        var valueStep = (max - min) / (colors.length - 1);\n        var colorStep = 1 / (colors.length - 1);\n        var tickStep = this.width / (colors.length - 1);\n        var gradientColor = 'l(0)';\n        each(colors, function (c, index) {\n            var stepNum = colorStep * index;\n            gradientColor += stepNum + \":\" + c + \" \";\n        });\n        this.container.addShape('rect', {\n            attrs: {\n                x: 0,\n                y: 0,\n                width: this.width,\n                height: this.height,\n                fill: gradientColor,\n            },\n            name: 'legend',\n        });\n        // draw tick and label\n        each(colors, function (c, index) {\n            // tick\n            var step = tickStep * index;\n            _this.container.addShape('path', {\n                attrs: __assign({ path: [\n                        ['M', step, 0],\n                        ['L', step, _this.height],\n                    ] }, _this.options.ticklineStyle),\n                name: 'legend-label',\n            });\n            // value\n            var value = Math.round(valueStep * index);\n            _this.container.addShape('text', {\n                attrs: __assign({ text: value, textAlign: 'center', textBaseline: 'top', x: step, y: _this.height + LABEL_MARGIN }, _this.options.text.style),\n            });\n        });\n        //anchor\n        var tri_width = 14;\n        var tri_height = 10;\n        var tri_path = [['M', 0, 0], ['L', -tri_width / 2, -tri_height], ['L', tri_width / 2, -tri_height], ['Z']];\n        this.anchor = this.container.addShape('path', {\n            attrs: __assign({ path: tri_path }, this.options.anchorStyle),\n        });\n        this.anchor.set('visible', false);\n    };\n    MatrixLegend.prototype.getLayout = function () {\n        var positions = this.options.position.split('-');\n        this.position = positions[0];\n        if (positions[0] === 'left' || positions[0] === 'right') {\n            return 'vertical';\n        }\n        return 'horizontal';\n    };\n    MatrixLegend.prototype.getDefaultWidth = function () {\n        if (this.layout === 'horizontal') {\n            var width = this.view.coordinateBBox.width;\n            return width;\n        }\n        return 10;\n    };\n    MatrixLegend.prototype.getDefaultHeight = function () {\n        if (this.layout === 'vertical') {\n            var height = this.view.coordinateBBox.height;\n            return height;\n        }\n        return 10;\n    };\n    MatrixLegend.prototype.legendLayout = function () {\n        var _this = this;\n        var panelRange = this.view.coordinateBBox;\n        var bleeding = this.options.plot.getPlotTheme().bleeding;\n        if (isArray(bleeding)) {\n            each(bleeding, function (it, index) {\n                if (typeof bleeding[index] === 'function') {\n                    bleeding[index] = bleeding[index](_this.options.plot.options);\n                }\n            });\n        }\n        var bbox = this.container.getBBox();\n        var x = 0;\n        var y = 0;\n        var positions = this.options.position.split('-');\n        var plotWidth = this.options.plot.width;\n        var plotHeight = this.options.plot.height;\n        // 先确定x\n        if (positions[0] === 'left') {\n            x = bleeding[3];\n        }\n        else if (positions[0] === 'right') {\n            x = plotWidth - bleeding[1] - bbox.width;\n        }\n        else if (positions[1] === 'center') {\n            // default\n            if (this.width === panelRange.width) {\n                x = panelRange.x;\n            }\n            else {\n                x = (plotWidth - bbox.width) / 2;\n            }\n        }\n        else if (positions[1] === 'left') {\n            x = bleeding[3];\n        }\n        else if (positions[1] === 'right') {\n            x = this.options.plot.width - bleeding[1] - bbox.width;\n        }\n        // 再确定y\n        if (positions[0] === 'bottom') {\n            y = plotHeight - bleeding[2] - bbox.height;\n        }\n        else if (positions[0] === 'top') {\n            y = this.getTopPosition(bleeding);\n        }\n        else if (positions[1] === 'center') {\n            // default\n            if (this.height === panelRange.height) {\n                y = panelRange.y;\n            }\n            else {\n                //用户自行设定\n                y = (plotHeight - bbox.height) / 2;\n            }\n        }\n        else if (positions[1] === 'top') {\n            y = bleeding[0];\n        }\n        else if (positions[1] === 'bottom') {\n            y = plotHeight - bleeding[2] - bbox.height;\n        }\n        this.x = x;\n        this.y = y;\n        this.container.translate(x, y);\n    };\n    MatrixLegend.prototype.getDefaultOptions = function () {\n        return {\n            text: {\n                style: {\n                    fontSize: 12,\n                    fill: 'rgba(0, 0, 0, 0.45)',\n                },\n            },\n            ticklineStyle: {\n                lineWidth: 1,\n                stroke: 'rgba(0, 0, 0, 0.8)',\n            },\n            anchorStyle: {\n                fill: 'rgba(0,0,0,0.5)',\n            },\n            triggerOn: 'mousemove',\n        };\n    };\n    MatrixLegend.prototype.addInteraction = function () {\n        var _this = this;\n        var geomType;\n        if (this.options.plot.options.shapeType === 'rect') {\n            geomType = 'polygon';\n        }\n        else {\n            geomType = 'point';\n        }\n        var eventName = geomType + \":\" + this.options.triggerOn;\n        //const labelEventName = `label:${this.options.triggerOn}`;\n        var field = this.options.plot.options.colorField;\n        var _a = this.colorScale, min = _a.min, max = _a.max;\n        var geomEventHandler = function (ev) {\n            var value = ev.data.data[field];\n            var ratio = (value - min) / (max - min);\n            _this.moveAnchor(ratio);\n        };\n        this.view.on(eventName, geomEventHandler);\n        this.interactiveEvents[eventName] = {\n            target: this.view,\n            handler: geomEventHandler,\n        };\n        /*this.view.on(labelEventName, (ev) => {\n          const value = ev.data[field];\n          const ratio = (value - min) / (max - min);\n          this.moveAnchor(ratio);\n        });*/\n        var mouseleaveHandler = function () {\n            _this.anchor.set('visible', false);\n        };\n        this.options.plot.canvas.on('mouseleave', mouseleaveHandler);\n        this.interactiveEvents.mouseleave = {\n            target: this.options.plot.canvas,\n            handler: mouseleaveHandler,\n        };\n    };\n    MatrixLegend.prototype.moveAnchor = function (ratio) {\n        this.anchor.set('visible', true);\n        if (this.layout === 'vertical') {\n            var pos = this.height * ratio;\n            var ulMatrix = [1, 0, 0, 0, 1, 0, 0, 0, 1];\n            ulMatrix[7] = pos;\n            this.anchor.stopAnimate();\n            this.anchor.animate({\n                matrix: ulMatrix,\n            }, 400, 'easeLinear');\n        }\n        else {\n            var pos = this.width * ratio;\n            var ulMatrix = [1, 0, 0, 0, 1, 0, 0, 0, 1];\n            ulMatrix[6] = pos;\n            this.anchor.stopAnimate();\n            this.anchor.animate({\n                matrix: ulMatrix,\n            }, 400, 'easeLinear');\n        }\n    };\n    MatrixLegend.prototype.getTopPosition = function (bleeding) {\n        if (this.options.plot.description) {\n            var bbox = this.options.plot.description.getBBox();\n            return bbox.maxY + 10;\n        }\n        else if (this.options.plot.title) {\n            var bbox = this.options.plot.title.getBBox();\n            return bbox.maxY + 10;\n        }\n        return bleeding[0];\n    };\n    MatrixLegend.prototype.offEvent = function () {\n        each(this.interactiveEvents, function (event, key) {\n            var target = event.target, handler = event.handler;\n            target.off(key, handler);\n        });\n    };\n    return MatrixLegend;\n}());\nexport default MatrixLegend;\n//# sourceMappingURL=legend.js.map"]}]}