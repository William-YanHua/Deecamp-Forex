{"remainingRequest":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\ts-loader\\index.js??ref--4-1!D:\\project\\Deecamp-project\\system\\Web\\node_modules\\@antv\\g\\lib\\canvas.js","dependencies":[{"path":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\@antv\\g\\lib\\canvas.js","mtime":499162500000},{"path":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1595520254649},{"path":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\ts-loader\\index.js","mtime":1537906253000}],"contextDependencies":[],"result":["var Util = require('./util/index');\r\nvar Event = require('./event');\r\nvar Group = require('./core/group');\r\nvar Timeline = require('./core/mixin/timeline');\r\nvar renderers = require('./renderers/index');\r\nvar Canvas = function Canvas(cfg) {\r\n    Canvas.superclass.constructor.call(this, cfg);\r\n};\r\nCanvas.CFG = {\r\n    eventEnable: true,\r\n    width: null,\r\n    height: null,\r\n    widthCanvas: null,\r\n    heightCanvas: null,\r\n    widthStyle: null,\r\n    heightStyle: null,\r\n    containerDOM: null,\r\n    canvasDOM: null,\r\n    pixelRatio: null,\r\n    renderer: 'canvas'\r\n};\r\nUtil.extend(Canvas, Group);\r\nUtil.augment(Canvas, {\r\n    init: function init() {\r\n        Canvas.superclass.init.call(this);\r\n        this._setGlobalParam();\r\n        this._setContainer();\r\n        this._initPainter();\r\n        this._scale();\r\n        if (this.get('eventEnable')) {\r\n            this._registEvents();\r\n        }\r\n    },\r\n    getEmitter: function getEmitter(element, event) {\r\n        if (element) {\r\n            if (Util.isEmpty(element._getEvents())) {\r\n                var parent = element.get('parent');\r\n                if (parent && !event.propagationStopped) {\r\n                    return this.getEmitter(parent, event);\r\n                }\r\n            }\r\n            else {\r\n                return element;\r\n            }\r\n        }\r\n    },\r\n    _getEventObj: function _getEventObj(type, e, point, target) {\r\n        var event = new Event(type, e, true, true);\r\n        event.x = point.x;\r\n        event.y = point.y;\r\n        event.clientX = e.clientX;\r\n        event.clientY = e.clientY;\r\n        event.currentTarget = target;\r\n        event.target = target;\r\n        return event;\r\n    },\r\n    _triggerEvent: function _triggerEvent(type, e) {\r\n        var point = this.getPointByClient(e.clientX, e.clientY);\r\n        var shape = this.getShape(point.x, point.y, e);\r\n        var el = this.get('el');\r\n        var emitObj;\r\n        if (type === 'mousemove') {\r\n            var preShape = this.get('preShape');\r\n            if (preShape && preShape !== shape) {\r\n                var mouseleave = this._getEventObj('mouseleave', e, point, preShape);\r\n                emitObj = this.getEmitter(preShape, e);\r\n                emitObj && emitObj.emit('mouseleave', mouseleave);\r\n                el.style.cursor = 'default';\r\n            }\r\n            if (shape) {\r\n                var mousemove = this._getEventObj('mousemove', e, point, shape);\r\n                emitObj = this.getEmitter(shape, e);\r\n                emitObj && emitObj.emit('mousemove', mousemove);\r\n                if (preShape !== shape) {\r\n                    var mouseenter = this._getEventObj('mouseenter', e, point, shape);\r\n                    emitObj && emitObj.emit('mouseenter', mouseenter, e);\r\n                }\r\n            }\r\n            else {\r\n                var canvasmousemove = this._getEventObj('mousemove', e, point, this);\r\n                this.emit('mousemove', canvasmousemove);\r\n            }\r\n            this.set('preShape', shape);\r\n        }\r\n        else {\r\n            var event = this._getEventObj(type, e, point, shape || this);\r\n            emitObj = this.getEmitter(shape, e);\r\n            if (emitObj && emitObj !== this) {\r\n                emitObj.emit(type, event);\r\n            }\r\n            this.emit(type, event);\r\n        }\r\n        if (shape && !shape.get('destroyed')) {\r\n            el.style.cursor = shape.attr('cursor') || 'default';\r\n        }\r\n    },\r\n    _registEvents: function _registEvents() {\r\n        var self = this;\r\n        var el = self.get('el');\r\n        var events = ['mouseout', 'mouseover', 'mousemove', 'mousedown', 'mouseleave', 'mouseup', 'click', 'dblclick'];\r\n        Util.each(events, function (event) {\r\n            el.addEventListener(event, function (e) {\r\n                self._triggerEvent(event, e);\r\n            }, false);\r\n        });\r\n        el.addEventListener('touchstart', function (e) {\r\n            if (!Util.isEmpty(e.touches)) {\r\n                self._triggerEvent('touchstart', e.touches[0]);\r\n            }\r\n        }, false);\r\n        el.addEventListener('touchmove', function (e) {\r\n            if (!Util.isEmpty(e.touches)) {\r\n                self._triggerEvent('touchmove', e.touches[0]);\r\n            }\r\n        }, false);\r\n        el.addEventListener('touchend', function (e) {\r\n            if (!Util.isEmpty(e.changedTouches)) {\r\n                self._triggerEvent('touchend', e.changedTouches[0]);\r\n            }\r\n        }, false);\r\n    },\r\n    _scale: function _scale() {\r\n        var pixelRatio = this.get('pixelRatio');\r\n        this.scale(pixelRatio, pixelRatio);\r\n    },\r\n    _setGlobalParam: function _setGlobalParam() {\r\n        var pixelRatio = this.get('pixelRatio');\r\n        if (!pixelRatio) {\r\n            this.set('pixelRatio', Util.getRatio());\r\n        }\r\n        var renderer = renderers[this.get('renderer') || 'canvas'];\r\n        this._cfg.renderer = renderer;\r\n        this._cfg.canvas = this;\r\n        var timeline = new Timeline(this);\r\n        this._cfg.timeline = timeline;\r\n    },\r\n    _setContainer: function _setContainer() {\r\n        var containerId = this.get('containerId');\r\n        var containerDOM = this.get('containerDOM');\r\n        if (!containerDOM) {\r\n            containerDOM = document.getElementById(containerId);\r\n            this.set('containerDOM', containerDOM);\r\n        }\r\n        Util.modifyCSS(containerDOM, {\r\n            position: 'relative'\r\n        });\r\n    },\r\n    _initPainter: function _initPainter() {\r\n        var containerDOM = this.get('containerDOM');\r\n        var painter = new this._cfg.renderer.painter(containerDOM);\r\n        this._cfg.painter = painter;\r\n        this._cfg.canvasDOM = this._cfg.el = painter.canvas;\r\n        this.changeSize(this.get('width'), this.get('height'));\r\n    },\r\n    _resize: function _resize() {\r\n        var canvasDOM = this.get('canvasDOM');\r\n        var widthCanvas = this.get('widthCanvas');\r\n        var heightCanvas = this.get('heightCanvas');\r\n        var widthStyle = this.get('widthStyle');\r\n        var heightStyle = this.get('heightStyle');\r\n        canvasDOM.style.width = widthStyle;\r\n        canvasDOM.style.height = heightStyle;\r\n        canvasDOM.setAttribute('width', widthCanvas);\r\n        canvasDOM.setAttribute('height', heightCanvas);\r\n    },\r\n    getWidth: function getWidth() {\r\n        var pixelRatio = this.get('pixelRatio');\r\n        var width = this.get('width');\r\n        return width * pixelRatio;\r\n    },\r\n    getHeight: function getHeight() {\r\n        var pixelRatio = this.get('pixelRatio');\r\n        var height = this.get('height');\r\n        return height * pixelRatio;\r\n    },\r\n    changeSize: function changeSize(width, height) {\r\n        var pixelRatio = this.get('pixelRatio');\r\n        var widthCanvas = width * pixelRatio;\r\n        var heightCanvas = height * pixelRatio;\r\n        this.set('widthCanvas', widthCanvas);\r\n        this.set('heightCanvas', heightCanvas);\r\n        this.set('widthStyle', width + 'px');\r\n        this.set('heightStyle', height + 'px');\r\n        this.set('width', width);\r\n        this.set('height', height);\r\n        this._resize();\r\n    },\r\n    getPointByClient: function getPointByClient(clientX, clientY) {\r\n        var el = this.get('el');\r\n        var pixelRatio = this.get('pixelRatio') || 1;\r\n        var bbox = el.getBoundingClientRect();\r\n        return {\r\n            x: (clientX - bbox.left) * pixelRatio,\r\n            y: (clientY - bbox.top) * pixelRatio\r\n        };\r\n    },\r\n    getClientByPoint: function getClientByPoint(x, y) {\r\n        var el = this.get('el');\r\n        var bbox = el.getBoundingClientRect();\r\n        var pixelRatio = this.get('pixelRatio') || 1;\r\n        return {\r\n            clientX: x / pixelRatio + bbox.left,\r\n            clientY: y / pixelRatio + bbox.top\r\n        };\r\n    },\r\n    draw: function draw() {\r\n        this._cfg.painter.draw(this);\r\n    },\r\n    getShape: function getShape(x, y, e) {\r\n        if (arguments.length === 3 && this._cfg.renderer.getShape) {\r\n            return this._cfg.renderer.getShape.call(this, x, y, e);\r\n        }\r\n        return Canvas.superclass.getShape.call(this, x, y);\r\n    },\r\n    _drawSync: function _drawSync() {\r\n        this._cfg.painter.drawSync(this);\r\n    },\r\n    destroy: function destroy() {\r\n        var cfg = this._cfg;\r\n        var containerDOM = cfg.containerDOM;\r\n        var canvasDOM = cfg.canvasDOM;\r\n        if (canvasDOM && containerDOM) {\r\n            containerDOM.removeChild(canvasDOM);\r\n        }\r\n        cfg.timeline.stop();\r\n        Canvas.superclass.destroy.call(this);\r\n    }\r\n});\r\nmodule.exports = Canvas;\r\n",{"version":3,"file":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\@antv\\g\\lib\\canvas.js","sourceRoot":"","sources":["D:\\project\\Deecamp-project\\system\\Web\\node_modules\\@antv\\g\\lib\\canvas.js"],"names":[],"mappings":"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","sourcesContent":["var Util = require('./util/index');\n\nvar Event = require('./event');\n\nvar Group = require('./core/group');\n\nvar Timeline = require('./core/mixin/timeline');\n\nvar renderers = require('./renderers/index');\n\nvar Canvas = function Canvas(cfg) {\n  Canvas.superclass.constructor.call(this, cfg);\n};\n\nCanvas.CFG = {\n  eventEnable: true,\n\n  /**\n   * 像素宽度\n   * @type {Number}\n   */\n  width: null,\n\n  /**\n   * 像素高度\n   * @type {Number}\n   */\n  height: null,\n\n  /**\n   * 画布宽度\n   * @type {Number}\n   */\n  widthCanvas: null,\n\n  /**\n   * 画布高度\n   * @type {Number}\n   */\n  heightCanvas: null,\n\n  /**\n   * CSS宽\n   * @type {String}\n   */\n  widthStyle: null,\n\n  /**\n   * CSS高\n   * @type {String}\n   */\n  heightStyle: null,\n\n  /**\n   * 容器DOM\n   * @type {Object}\n   */\n  containerDOM: null,\n\n  /**\n   * 当前Canvas的DOM\n   * @type {Object}\n   */\n  canvasDOM: null,\n\n  /**\n   * 屏幕像素比\n   * @type {Number}\n   */\n  pixelRatio: null,\n\n  /**\n   * 渲染器，默认是canvas\n   * @type {String}\n   */\n  renderer: 'canvas'\n};\nUtil.extend(Canvas, Group);\nUtil.augment(Canvas, {\n  init: function init() {\n    Canvas.superclass.init.call(this);\n\n    this._setGlobalParam();\n\n    this._setContainer();\n\n    this._initPainter();\n\n    this._scale();\n\n    if (this.get('eventEnable')) {\n      this._registEvents();\n    }\n  },\n  getEmitter: function getEmitter(element, event) {\n    if (element) {\n      if (Util.isEmpty(element._getEvents())) {\n        var parent = element.get('parent');\n\n        if (parent && !event.propagationStopped) {\n          return this.getEmitter(parent, event);\n        }\n      } else {\n        return element;\n      }\n    }\n  },\n  _getEventObj: function _getEventObj(type, e, point, target) {\n    var event = new Event(type, e, true, true);\n    event.x = point.x;\n    event.y = point.y;\n    event.clientX = e.clientX;\n    event.clientY = e.clientY;\n    event.currentTarget = target;\n    event.target = target;\n    return event;\n  },\n  _triggerEvent: function _triggerEvent(type, e) {\n    var point = this.getPointByClient(e.clientX, e.clientY);\n    var shape = this.getShape(point.x, point.y, e);\n    var el = this.get('el');\n    var emitObj;\n\n    if (type === 'mousemove') {\n      var preShape = this.get('preShape');\n\n      if (preShape && preShape !== shape) {\n        var mouseleave = this._getEventObj('mouseleave', e, point, preShape);\n\n        emitObj = this.getEmitter(preShape, e);\n        emitObj && emitObj.emit('mouseleave', mouseleave);\n        el.style.cursor = 'default';\n      }\n\n      if (shape) {\n        var mousemove = this._getEventObj('mousemove', e, point, shape);\n\n        emitObj = this.getEmitter(shape, e);\n        emitObj && emitObj.emit('mousemove', mousemove);\n\n        if (preShape !== shape) {\n          var mouseenter = this._getEventObj('mouseenter', e, point, shape);\n\n          emitObj && emitObj.emit('mouseenter', mouseenter, e);\n        }\n      } else {\n        var canvasmousemove = this._getEventObj('mousemove', e, point, this);\n\n        this.emit('mousemove', canvasmousemove);\n      }\n\n      this.set('preShape', shape);\n    } else {\n      var event = this._getEventObj(type, e, point, shape || this);\n\n      emitObj = this.getEmitter(shape, e);\n\n      if (emitObj && emitObj !== this) {\n        emitObj.emit(type, event);\n      }\n\n      this.emit(type, event);\n    }\n\n    if (shape && !shape.get('destroyed')) {\n      el.style.cursor = shape.attr('cursor') || 'default';\n    }\n  },\n  _registEvents: function _registEvents() {\n    var self = this;\n    var el = self.get('el');\n    var events = ['mouseout', 'mouseover', 'mousemove', 'mousedown', 'mouseleave', 'mouseup', 'click', 'dblclick'];\n    Util.each(events, function (event) {\n      el.addEventListener(event, function (e) {\n        self._triggerEvent(event, e);\n      }, false);\n    }); // special cases\n\n    el.addEventListener('touchstart', function (e) {\n      if (!Util.isEmpty(e.touches)) {\n        self._triggerEvent('touchstart', e.touches[0]);\n      }\n    }, false);\n    el.addEventListener('touchmove', function (e) {\n      if (!Util.isEmpty(e.touches)) {\n        self._triggerEvent('touchmove', e.touches[0]);\n      }\n    }, false);\n    el.addEventListener('touchend', function (e) {\n      if (!Util.isEmpty(e.changedTouches)) {\n        self._triggerEvent('touchend', e.changedTouches[0]);\n      }\n    }, false);\n  },\n  _scale: function _scale() {\n    var pixelRatio = this.get('pixelRatio');\n    this.scale(pixelRatio, pixelRatio);\n  },\n  _setGlobalParam: function _setGlobalParam() {\n    var pixelRatio = this.get('pixelRatio');\n\n    if (!pixelRatio) {\n      this.set('pixelRatio', Util.getRatio());\n    }\n\n    var renderer = renderers[this.get('renderer') || 'canvas'];\n    this._cfg.renderer = renderer;\n    this._cfg.canvas = this;\n    var timeline = new Timeline(this);\n    this._cfg.timeline = timeline;\n  },\n  _setContainer: function _setContainer() {\n    var containerId = this.get('containerId');\n    var containerDOM = this.get('containerDOM');\n\n    if (!containerDOM) {\n      containerDOM = document.getElementById(containerId);\n      this.set('containerDOM', containerDOM);\n    }\n\n    Util.modifyCSS(containerDOM, {\n      position: 'relative'\n    });\n  },\n  _initPainter: function _initPainter() {\n    var containerDOM = this.get('containerDOM');\n    var painter = new this._cfg.renderer.painter(containerDOM);\n    this._cfg.painter = painter;\n    this._cfg.canvasDOM = this._cfg.el = painter.canvas;\n    this.changeSize(this.get('width'), this.get('height'));\n  },\n  _resize: function _resize() {\n    var canvasDOM = this.get('canvasDOM');\n    var widthCanvas = this.get('widthCanvas');\n    var heightCanvas = this.get('heightCanvas');\n    var widthStyle = this.get('widthStyle');\n    var heightStyle = this.get('heightStyle');\n    canvasDOM.style.width = widthStyle;\n    canvasDOM.style.height = heightStyle;\n    canvasDOM.setAttribute('width', widthCanvas);\n    canvasDOM.setAttribute('height', heightCanvas);\n  },\n  getWidth: function getWidth() {\n    var pixelRatio = this.get('pixelRatio');\n    var width = this.get('width');\n    return width * pixelRatio;\n  },\n  getHeight: function getHeight() {\n    var pixelRatio = this.get('pixelRatio');\n    var height = this.get('height');\n    return height * pixelRatio;\n  },\n  changeSize: function changeSize(width, height) {\n    var pixelRatio = this.get('pixelRatio');\n    var widthCanvas = width * pixelRatio;\n    var heightCanvas = height * pixelRatio;\n    this.set('widthCanvas', widthCanvas);\n    this.set('heightCanvas', heightCanvas);\n    this.set('widthStyle', width + 'px');\n    this.set('heightStyle', height + 'px');\n    this.set('width', width);\n    this.set('height', height);\n\n    this._resize();\n  },\n\n  /**\n   * 将窗口坐标转变成 canvas 坐标\n   * @param  {Number} clientX 窗口x坐标\n   * @param  {Number} clientY 窗口y坐标\n   * @return {Object} canvas坐标\n   */\n  getPointByClient: function getPointByClient(clientX, clientY) {\n    var el = this.get('el');\n    var pixelRatio = this.get('pixelRatio') || 1;\n    var bbox = el.getBoundingClientRect();\n    return {\n      x: (clientX - bbox.left) * pixelRatio,\n      y: (clientY - bbox.top) * pixelRatio\n    };\n  },\n  getClientByPoint: function getClientByPoint(x, y) {\n    var el = this.get('el');\n    var bbox = el.getBoundingClientRect();\n    var pixelRatio = this.get('pixelRatio') || 1;\n    return {\n      clientX: x / pixelRatio + bbox.left,\n      clientY: y / pixelRatio + bbox.top\n    };\n  },\n  draw: function draw() {\n    this._cfg.painter.draw(this);\n  },\n  getShape: function getShape(x, y, e) {\n    if (arguments.length === 3 && this._cfg.renderer.getShape) {\n      return this._cfg.renderer.getShape.call(this, x, y, e);\n    }\n\n    return Canvas.superclass.getShape.call(this, x, y);\n  },\n  _drawSync: function _drawSync() {\n    this._cfg.painter.drawSync(this);\n  },\n  destroy: function destroy() {\n    var cfg = this._cfg;\n    var containerDOM = cfg.containerDOM;\n    var canvasDOM = cfg.canvasDOM;\n\n    if (canvasDOM && containerDOM) {\n      containerDOM.removeChild(canvasDOM);\n    }\n\n    cfg.timeline.stop();\n    Canvas.superclass.destroy.call(this);\n  }\n});\nmodule.exports = Canvas;"]}]}