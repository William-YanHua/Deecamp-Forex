{"remainingRequest":"/run/media/williamyh/新加卷/project/Deecamp-project/system/Web/node_modules/ts-loader/index.js??ref--4-1!/run/media/williamyh/新加卷/project/Deecamp-project/system/Web/src/app/pages/UserPage/InvestmentPreference/PreferenceEvaluationPanel.tsx","dependencies":[{"path":"/run/media/williamyh/新加卷/project/Deecamp-project/system/Web/src/app/pages/UserPage/InvestmentPreference/PreferenceEvaluationPanel.tsx","mtime":1596379644599},{"path":"/run/media/williamyh/新加卷/project/Deecamp-project/system/Web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/run/media/williamyh/新加卷/project/Deecamp-project/system/Web/node_modules/ts-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":["var __makeTemplateObject = (this && this.__makeTemplateObject) || function (cooked, raw) {\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\n    return cooked;\n};\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nimport React from \"react\";\nimport { Inject } from \"react.di\";\nimport { action, observable, runInAction } from \"mobx\";\nimport { observer } from \"mobx-react\";\nimport Select from \"antd/lib/select\";\nimport \"antd/lib/select/style/index.js\";\nimport Button from \"antd/lib/button\";\nimport \"antd/lib/button/style/index.js\";\nimport notification from \"antd/lib/notification\";\nimport \"antd/lib/notification/style/index.js\";\nimport Modal from \"antd/lib/modal\";\nimport \"antd/lib/modal/style/index.js\";\nimport { range } from \"../../../../utils/Range\";\nimport lang from \"../../../internationalization/LocaleStore/lang\";\nimport styled from \"styled-components\";\nimport { PreferenceEvaluationAnswer, } from \"../../../models/user/PreferenceEvaluation\";\nimport { UserService } from \"../../../api/UserService\";\nimport { UserStore } from \"../../../stores/UserStore\";\nimport { LocaleMessage } from \"../../../internationalization/components\";\nimport PreferenceTable from \"./PreferenceTable\";\nimport { LocaleStore } from \"../../../internationalization\";\nvar QandA = [\n    {\n        question: \"您的年龄是？\",\n        answers: [\n            \"大于55岁\",\n            \"45-55岁\",\n            \"35-45岁\",\n            \"25-35岁\",\n            \"小于25岁\",\n        ],\n    }, {\n        question: \"您的收入来源是：\",\n        answers: [\n            \"工资、劳务报酬\",\n            \"生产经营所得\",\n            \"利息、股息、转让证券等金融性资产收入\",\n            \"出租、出售房地产等非金融性资产收入\",\n            \"无固定收入\",\n        ],\n    }, {\n        question: \"您的家庭可支配年收入是（折合为人民币）\",\n        answers: [\n            \"20万以下\",\n            \"20-100万\",\n            \"100-500万\",\n            \"500-1000万\",\n            \"1000万以上\",\n        ],\n    }, {\n        question: \"在您每年的家庭可支配收入中，可用于金融投资的（储蓄存款除外）的比例为\",\n        answers: [\n            \"小于10%\",\n            \"10%-25%\",\n            \"25%-50%\",\n            \"50%-75%\",\n            \"大于75%\",\n        ],\n    }, {\n        question: \"您的投资知识可描述为：\",\n        answers: [\n            \"完全没有\",\n            \"有限，基本我有金融方面的知识\",\n            \"一般，对金融产品及其相关风险具有基本的知识和理解\",\n            \"丰富，对金融产品及其相关风险具有丰富的知识和理解\",\n            \"几乎了解所有金融相关的知识和信息\",\n        ],\n    }, {\n        question: \"您的投资经验可描述为：\",\n        answers: [\n            \"没有投资经验\",\n            \"除银行储蓄外，基本没有其他投资经验\",\n            \"购买过债券、保险等理财产品\",\n            \"参与过股票、基金等产品的交易\",\n            \"参与过权证、期货、期权等产品的交易\",\n        ],\n    }, {\n        question: \"您有多少年投资基金、股票、信托、私募证券或金融衍生产品等风险投资品的经验？ \",\n        answers: [\n            \"没有经验\",\n            \"少于2年\",\n            \"2-5年\",\n            \"5-10年\",\n            \"10年以上\",\n        ],\n    }, {\n        question: \"以下哪项描述最符合您的投资态度？\",\n        answers: [\n            \"厌恶风险，不希望本金损失，希望能获得稳定回报\",\n            \"保守投资，不希望本金损失，愿意承担一定程度的收益波动\",\n            \"寻求资金的较高收益和成长性，愿意为此承担一定的本金损失\",\n            \"希望赚取高回报，愿意为此承担较大的本金损失\",\n            \"希望赚取极高回报，并愿意为此承担极大的损失\",\n        ],\n    }, {\n        question: \"短期内，您能接受的亏损范围是\",\n        answers: [\n            \"小于5%或不可接受\",\n            \"5%-10%\",\n            \"10%-20%\",\n            \"20%-35%\",\n            \"大于35%\",\n        ],\n    },\n];\nvar root = lang().userCenter.investmentPreference;\nfunction createDefaultAnswers() {\n    return range(0, 9).map(function () { return 0; });\n}\nvar Form = styled.div.withConfig({ displayName: \"Form\" })(templateObject_1 || (templateObject_1 = __makeTemplateObject([\"\\n  overflow: auto;\\n  max-height: 800px;\\n  & > * {\\n  margin-bottom: 8px;\\n  }\\n\"], [\"\\n  overflow: auto;\\n  max-height: 800px;\\n  & > * {\\n  margin-bottom: 8px;\\n  }\\n\"])));\nvar PreferenceEvaluationPanel = (function (_super) {\n    __extends(PreferenceEvaluationPanel, _super);\n    function PreferenceEvaluationPanel() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.calculating = false;\n        _this.onSelected = function (questionIndex, answerIndex) {\n            _this.answers[questionIndex] = answerIndex;\n        };\n        _this.onOk = function () { return __awaiter(_this, void 0, void 0, function () {\n            var result;\n            var _this = this;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        this.calculating = true;\n                        return [4, this.userService.evaluatePreference(this.answers)];\n                    case 1:\n                        result = _a.sent();\n                        runInAction(function () {\n                            _this.calculating = false;\n                        });\n                        Modal.confirm({\n                            title: \"确认评估结果\",\n                            content: React.createElement(\"div\", null,\n                                React.createElement(\"p\", null, \"\\u60A8\\u7684\\u8BC4\\u4F30\\u7ED3\\u679C\\u5982\\u4E0B\\uFF1A\"),\n                                React.createElement(PreferenceTable, { texts: {\n                                        profit: this.localeStore.get(root.profit),\n                                        fluctuation: this.localeStore.get(root.fluctuation),\n                                    }, preference: result, loading: false }),\n                                React.createElement(\"p\", null, \"\\u662F\\u5426\\u63A5\\u53D7\\u6B64\\u8BC4\\u4F30\\u7ED3\\u679C\\uFF1F\")),\n                            onOk: function () { return __awaiter(_this, void 0, void 0, function () {\n                                return __generator(this, function (_a) {\n                                    switch (_a.label) {\n                                        case 0: return [4, this.userService.setUserInvestmentPreference(this.userStore.user.username, result)];\n                                        case 1:\n                                            _a.sent();\n                                            this.props.onComplete(true);\n                                            return [2];\n                                    }\n                                });\n                            }); },\n                            onCancel: function () {\n                                _this.props.onComplete(false);\n                            },\n                        });\n                        return [2];\n                }\n            });\n        }); };\n        return _this;\n    }\n    PreferenceEvaluationPanel.prototype.componentDidUpdate = function () {\n        this.answers = createDefaultAnswers();\n    };\n    PreferenceEvaluationPanel.prototype.componentDidMount = function () {\n        this.answers = createDefaultAnswers();\n    };\n    PreferenceEvaluationPanel.prototype.render = function () {\n        var _this = this;\n        return React.createElement(Form, null,\n            QandA.map(function (x, i) {\n                return React.createElement(\"div\", { key: i },\n                    React.createElement(\"p\", null, x.question),\n                    React.createElement(Select, { defaultValue: 0, onChange: function (value) { return _this.onSelected(i, value); }, dropdownMatchSelectWidth: false }, x.answers.map(function (ans, j) {\n                        return React.createElement(Select.Option, { value: j, key: i + \"-\" + j }, ans);\n                    })));\n            }),\n            React.createElement(Button, { loading: this.calculating, type: \"primary\", onClick: this.onOk },\n                React.createElement(LocaleMessage, { id: root.evaluation.submit })));\n    };\n    var _a, _b, _c, _d;\n    __decorate([\n        observable,\n        __metadata(\"design:type\", typeof (_a = typeof PreferenceEvaluationAnswer !== \"undefined\" && PreferenceEvaluationAnswer) === \"function\" ? _a : Object)\n    ], PreferenceEvaluationPanel.prototype, \"answers\", void 0);\n    __decorate([\n        observable,\n        __metadata(\"design:type\", Boolean)\n    ], PreferenceEvaluationPanel.prototype, \"calculating\", void 0);\n    __decorate([\n        Inject,\n        __metadata(\"design:type\", typeof (_b = typeof LocaleStore !== \"undefined\" && LocaleStore) === \"function\" ? _b : Object)\n    ], PreferenceEvaluationPanel.prototype, \"localeStore\", void 0);\n    __decorate([\n        Inject,\n        __metadata(\"design:type\", typeof (_c = typeof UserService !== \"undefined\" && UserService) === \"function\" ? _c : Object)\n    ], PreferenceEvaluationPanel.prototype, \"userService\", void 0);\n    __decorate([\n        Inject,\n        __metadata(\"design:type\", typeof (_d = typeof UserStore !== \"undefined\" && UserStore) === \"function\" ? _d : Object)\n    ], PreferenceEvaluationPanel.prototype, \"userStore\", void 0);\n    __decorate([\n        action,\n        __metadata(\"design:type\", Function),\n        __metadata(\"design:paramtypes\", []),\n        __metadata(\"design:returntype\", void 0)\n    ], PreferenceEvaluationPanel.prototype, \"componentDidUpdate\", null);\n    __decorate([\n        action,\n        __metadata(\"design:type\", Function),\n        __metadata(\"design:paramtypes\", []),\n        __metadata(\"design:returntype\", void 0)\n    ], PreferenceEvaluationPanel.prototype, \"componentDidMount\", null);\n    __decorate([\n        action,\n        __metadata(\"design:type\", Object)\n    ], PreferenceEvaluationPanel.prototype, \"onSelected\", void 0);\n    __decorate([\n        action,\n        __metadata(\"design:type\", Object)\n    ], PreferenceEvaluationPanel.prototype, \"onOk\", void 0);\n    PreferenceEvaluationPanel = __decorate([\n        observer\n    ], PreferenceEvaluationPanel);\n    return PreferenceEvaluationPanel;\n}(React.Component));\nexport default PreferenceEvaluationPanel;\nvar templateObject_1;\n",{"version":3,"file":"/run/media/williamyh/新加卷/project/Deecamp-project/system/Web/src/app/pages/UserPage/InvestmentPreference/PreferenceEvaluationPanel.tsx","sourceRoot":"","sources":["/run/media/williamyh/新加卷/project/Deecamp-project/system/Web/src/app/pages/UserPage/InvestmentPreference/PreferenceEvaluationPanel.tsx"],"names":[],"mappings":"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","sourcesContent":["import React from \"react\";\r\nimport { Inject } from \"react.di\";\r\nimport { action, observable, runInAction } from \"mobx\";\r\nimport { observer } from \"mobx-react\";\r\nimport { Select, Button, notification, Modal } from \"antd\";\r\nimport { range } from \"../../../../utils/Range\";\r\nimport lang from \"../../../internationalization/LocaleStore/lang\";\r\nimport styled from \"styled-components\";\r\nimport { PreferenceEvaluationAnswer, PreferenceEvaluationSelection, } from \"../../../models/user/PreferenceEvaluation\";\r\nimport { UserService } from \"../../../api/UserService\";\r\nimport { UserStore } from \"../../../stores/UserStore\";\r\nimport { LocaleMessage } from \"../../../internationalization/components\";\r\nimport { InvestmentPreference } from \"../../../models/user/InvestmentPreference\";\r\nimport PreferenceTable from \"./PreferenceTable\";\r\nimport { LocaleStore } from \"../../../internationalization\";\r\n\r\nconst QandA = [\r\n  {\r\n    question: \"您的年龄是？\",\r\n    answers: [\r\n      \"大于55岁\",\r\n      \"45-55岁\",\r\n      \"35-45岁\",\r\n      \"25-35岁\",\r\n      \"小于25岁\",\r\n    ],\r\n  }, {\r\n    question: \"您的收入来源是：\",\r\n    answers: [\r\n      \"工资、劳务报酬\",\r\n      \"生产经营所得\",\r\n      \"利息、股息、转让证券等金融性资产收入\",\r\n      \"出租、出售房地产等非金融性资产收入\",\r\n      \"无固定收入\",\r\n    ],\r\n  }, {\r\n    question: \"您的家庭可支配年收入是（折合为人民币）\",\r\n    answers: [\r\n      \"20万以下\",\r\n      \"20-100万\",\r\n      \"100-500万\",\r\n      \"500-1000万\",\r\n      \"1000万以上\",\r\n    ],\r\n  }, {\r\n    question: \"在您每年的家庭可支配收入中，可用于金融投资的（储蓄存款除外）的比例为\",\r\n    answers: [\r\n      \"小于10%\",\r\n      \"10%-25%\",\r\n      \"25%-50%\",\r\n      \"50%-75%\",\r\n      \"大于75%\",\r\n    ],\r\n  }, {\r\n    question: \"您的投资知识可描述为：\",\r\n    answers: [\r\n      \"完全没有\",\r\n      \"有限，基本我有金融方面的知识\",\r\n      \"一般，对金融产品及其相关风险具有基本的知识和理解\",\r\n      \"丰富，对金融产品及其相关风险具有丰富的知识和理解\",\r\n      \"几乎了解所有金融相关的知识和信息\",\r\n    ],\r\n  }, {\r\n    question: \"您的投资经验可描述为：\",\r\n    answers: [\r\n      \"没有投资经验\",\r\n      \"除银行储蓄外，基本没有其他投资经验\",\r\n      \"购买过债券、保险等理财产品\",\r\n      \"参与过股票、基金等产品的交易\",\r\n      \"参与过权证、期货、期权等产品的交易\",\r\n    ],\r\n  }, {\r\n    question: \"您有多少年投资基金、股票、信托、私募证券或金融衍生产品等风险投资品的经验？ \",\r\n    answers: [\r\n      \"没有经验\",\r\n      \"少于2年\",\r\n      \"2-5年\",\r\n      \"5-10年\",\r\n      \"10年以上\",\r\n    ],\r\n  }, {\r\n    question: \"以下哪项描述最符合您的投资态度？\",\r\n    answers: [\r\n      \"厌恶风险，不希望本金损失，希望能获得稳定回报\",\r\n      \"保守投资，不希望本金损失，愿意承担一定程度的收益波动\",\r\n      \"寻求资金的较高收益和成长性，愿意为此承担一定的本金损失\",\r\n      \"希望赚取高回报，愿意为此承担较大的本金损失\",\r\n      \"希望赚取极高回报，并愿意为此承担极大的损失\",\r\n    ],\r\n  }, {\r\n    question: \"短期内，您能接受的亏损范围是\",\r\n    answers: [\r\n      \"小于5%或不可接受\",\r\n      \"5%-10%\",\r\n      \"10%-20%\",\r\n      \"20%-35%\",\r\n      \"大于35%\",\r\n    ],\r\n  },\r\n];\r\n\r\nconst root = lang().userCenter.investmentPreference;\r\n\r\nfunction createDefaultAnswers(): PreferenceEvaluationAnswer {\r\n  return range(0, 9).map(() => 0 as 0);\r\n}\r\n\r\ninterface Props {\r\n  onComplete(needRefresh: boolean): void;\r\n}\r\n\r\ninterface State {\r\n\r\n}\r\n\r\nconst Form = styled.div`\r\n  overflow: auto;\r\n  max-height: 800px;\r\n  & > * {\r\n  margin-bottom: 8px;\r\n  }\r\n`;\r\n\r\n@observer\r\nexport default class PreferenceEvaluationPanel extends React.Component<Props, State> {\r\n\r\n  @observable answers: PreferenceEvaluationAnswer;\r\n\r\n  @observable calculating: boolean = false;\r\n\r\n  @Inject localeStore: LocaleStore;\r\n\r\n  @Inject userService: UserService;\r\n  @Inject userStore: UserStore;\r\n\r\n  @action componentDidUpdate() {\r\n    this.answers = createDefaultAnswers();\r\n  }\r\n\r\n  @action componentDidMount() {\r\n    this.answers = createDefaultAnswers();\r\n  }\r\n\r\n  @action onSelected = (questionIndex: number, answerIndex: PreferenceEvaluationSelection) => {\r\n    this.answers[questionIndex] = answerIndex;\r\n  }\r\n\r\n  @action onOk = async () => {\r\n    this.calculating = true;\r\n\r\n    const result = await this.userService.evaluatePreference(this.answers);\r\n\r\n    runInAction(() => {\r\n      this.calculating = false;\r\n    });\r\n\r\n    // ask user to choose whether to accept the result\r\n\r\n    Modal.confirm({\r\n      title: \"确认评估结果\",\r\n      content: <div>\r\n        <p>您的评估结果如下：</p>\r\n        <PreferenceTable texts={{\r\n          profit: this.localeStore.get(root.profit),\r\n          fluctuation: this.localeStore.get(root.fluctuation),\r\n        }} preference={result} loading={false}/>\r\n        <p>是否接受此评估结果？</p>\r\n      </div>,\r\n      onOk: async () => {\r\n        await this.userService.setUserInvestmentPreference(\r\n          this.userStore.user.username,\r\n          result,\r\n        );\r\n        this.props.onComplete(true);\r\n      },\r\n      onCancel: () => {\r\n        this.props.onComplete(false);\r\n      },\r\n    });\r\n  }\r\n\r\n  render() {\r\n    return <Form>\r\n      {QandA.map((x, i) => {\r\n        return <div key={i}>\r\n          <p>{x.question}</p>\r\n          <Select defaultValue={0}\r\n                  onChange={(value: PreferenceEvaluationSelection) => this.onSelected(i, value)}\r\n                  dropdownMatchSelectWidth={false}\r\n          >\r\n            {x.answers.map((ans, j) =>\r\n              <Select.Option value={j} key={`${i}-${j}`}>\r\n                {ans}\r\n              </Select.Option>,\r\n            )}\r\n          </Select>\r\n        </div>;\r\n      })}\r\n      <Button loading={this.calculating} type={\"primary\"} onClick={this.onOk}>\r\n        <LocaleMessage id={root.evaluation.submit}/>\r\n      </Button>\r\n    </Form>;\r\n  }\r\n}\r\n"]}]}