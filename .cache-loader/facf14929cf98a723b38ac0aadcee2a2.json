{"remainingRequest":"/run/media/williamyh/新加卷/project/Deecamp-project/system/Web/node_modules/ts-loader/index.js??ref--4-1!/run/media/williamyh/新加卷/project/Deecamp-project/system/Web/src/app/pages/InvReqPage/InitModal/index.tsx","dependencies":[{"path":"/run/media/williamyh/新加卷/project/Deecamp-project/system/Web/src/app/pages/InvReqPage/InitModal/index.tsx","mtime":1596379644527},{"path":"/run/media/williamyh/新加卷/project/Deecamp-project/system/Web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/run/media/williamyh/新加卷/project/Deecamp-project/system/Web/node_modules/ts-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":["var __makeTemplateObject = (this && this.__makeTemplateObject) || function (cooked, raw) {\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\n    return cooked;\n};\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nimport React from \"react\";\nimport Form from \"antd/lib/form\";\nimport \"antd/lib/form/style/index.js\";\nimport Input from \"antd/lib/input\";\nimport \"antd/lib/input/style/index.js\";\nimport Modal from \"antd/lib/modal\";\nimport \"antd/lib/modal/style/index.js\";\nimport Slider from \"antd/lib/slider\";\nimport \"antd/lib/slider/style/index.js\";\nimport Alert from \"antd/lib/alert\";\nimport \"antd/lib/alert/style/index.js\";\nimport { observer } from \"mobx-react\";\nimport { LocaleMessage } from \"../../../internationalization\";\nimport lang from \"../../../internationalization/LocaleStore/lang\";\nimport { Inject } from \"react.di\";\nimport { UserService } from \"../../../api/UserService\";\nimport { RouterStore } from \"../../../routing/RouterStore\";\nimport { UserStore } from \"../../../stores/UserStore\";\nimport { InvreqService } from \"../../../api/InvreqService\";\nimport FormItem from \"../../../components/Form/FormItem\";\nimport { action, observable, runInAction } from \"mobx\";\nimport { InvreqInitFormData } from \"./InvreqInitFormData\";\nimport { Link } from \"react-router-dom\";\nimport styled from \"styled-components\";\nvar root = lang().invreqInit;\nvar Hint = styled.small.withConfig({ displayName: \"Hint\" })(templateObject_1 || (templateObject_1 = __makeTemplateObject([\"\\n  line-height: 24px;\\n  display: block;\\n\"], [\"\\n  line-height: 24px;\\n  display: block;\\n\"])));\nvar InitModal = (function (_super) {\n    __extends(InitModal, _super);\n    function InitModal() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.initiated = false;\n        _this.submitting = false;\n        _this.onSubmit = function () { return __awaiter(_this, void 0, void 0, function () {\n            var _this = this;\n            return __generator(this, function (_a) {\n                this.data.confirmAttempted = true;\n                if (!this.data.valid) {\n                    return [2];\n                }\n                this.invreqService.createInvreq(this.data.data);\n                Modal.info({\n                    title: \"信息已经提交\",\n                    content: \"创建一个资产账户所需要的信息已经提交。创建账户需要一点时间。当账号创建完成时，系统将会发出通知，请耐心等待。\",\n                    onOk: function () { return _this.props.close(); },\n                });\n                return [2];\n            });\n        }); };\n        _this.onYearChange = function (value) {\n            _this.data.year = value;\n        };\n        _this.afterClose = function () {\n            _this.initiated = false;\n        };\n        return _this;\n    }\n    InitModal.prototype.componentDidMount = function () {\n        this.initData();\n    };\n    InitModal.prototype.componentDidUpdate = function () {\n        if (!this.initiated) {\n            this.initData();\n        }\n    };\n    InitModal.prototype.initData = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var data;\n            var _this = this;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4, this.userService.getUserInvestmentPreference(this.userStore.user.username)];\n                    case 1:\n                        data = _a.sent();\n                        runInAction(function () {\n                            _this.data = new InvreqInitFormData(data);\n                            _this.initiated = true;\n                        });\n                        return [2];\n                }\n            });\n        });\n    };\n    InitModal.prototype.render = function () {\n        if (!this.initiated) {\n            return null;\n        }\n        var _a = this.data, fluctuation = _a.fluctuation, profit = _a.profit, amount = _a.amount, year = _a.year, fluctuationValid = _a.fluctuationValid, profitValid = _a.profitValid, amountValid = _a.amountValid;\n        return (React.createElement(Modal, { visible: this.props.shown, title: React.createElement(LocaleMessage, { id: root.init }), confirmLoading: this.submitting, onCancel: this.props.close, afterClose: this.afterClose, onOk: this.onSubmit },\n            React.createElement(\"p\", null, \"\\u4E0B\\u5217\\u6570\\u636E\\u5DF2\\u901A\\u8FC7\\u60A8\\u7684\\u7406\\u8D22\\u504F\\u597D\\u81EA\\u52A8\\u586B\\u5199\\u3002\"),\n            React.createElement(Link, { to: \"/user/investmentPreference\" }, \"\\u8BBF\\u95EE\\u6B64\\u5904\\u4EE5\\u8BBF\\u95EE\\u548C\\u4FEE\\u6539\\u60A8\\u7684\\u7406\\u8D22\\u504F\\u597D\"),\n            React.createElement(Form, null,\n                React.createElement(FormItem, { valid: profitValid, messageOnInvalid: \"收益率应该在大于等于0但小于等于10%\" },\n                    React.createElement(\"p\", null,\n                        React.createElement(LocaleMessage, { id: root.profit })),\n                    React.createElement(Alert, { type: \"warning\", message: React.createElement(\"div\", null,\n                            React.createElement(\"p\", null, \"\\u7531\\u4E8E\\u4F59\\u989D\\u5B9D\\u6536\\u76CA\\u7387\\u57283.439%\\u5DE6\\u53F3\\uFF0C\\u5EFA\\u8BAE\\u9884\\u671F\\u6536\\u76CA\\u7387\\u4E0D\\u8981\\u8D85\\u8FC78%\\u3002\"),\n                            React.createElement(\"p\", null, \"\\u6536\\u76CA\\u7387\\u8FC7\\u9AD8\\u4F1A\\u5BFC\\u81F4\\u8D44\\u91D1\\u5168\\u90E8\\u5206\\u914D\\u4E8E\\u80A1\\u7968\\u5E02\\u573A\\uFF0C\\u8BF7\\u8C28\\u614E\\u8003\\u8651\\u3002\")) }),\n                    React.createElement(Input, { type: \"number\", onChange: this.data.onChange(\"profit\"), value: profit, addonAfter: \"%\" })),\n                React.createElement(FormItem, { valid: fluctuationValid, messageOnInvalid: \"波动率应该大于等于3%\" },\n                    React.createElement(\"p\", null,\n                        React.createElement(LocaleMessage, { id: root.fluctuation })),\n                    React.createElement(Input, { type: \"number\", onChange: this.data.onChange(\"fluctuation\"), value: fluctuation, addonAfter: \"%\" })),\n                React.createElement(FormItem, { valid: amountValid, messageOnInvalid: \"金额应该大于等于0\" },\n                    React.createElement(\"p\", null,\n                        React.createElement(LocaleMessage, { id: root.amount })),\n                    React.createElement(Input, { type: \"number\", onChange: this.data.onChange(\"amount\"), value: amount })),\n                React.createElement(FormItem, { valid: true, messageOnInvalid: \"\" },\n                    React.createElement(\"p\", null,\n                        React.createElement(LocaleMessage, { id: root.year }),\n                        \" \",\n                        React.createElement(\"strong\", null, year)),\n                    React.createElement(Slider, { min: 1, max: 10, onChange: this.onYearChange, value: year })))));\n    };\n    var _a, _b, _c, _d, _e;\n    __decorate([\n        Inject,\n        __metadata(\"design:type\", typeof (_a = typeof UserService !== \"undefined\" && UserService) === \"function\" ? _a : Object)\n    ], InitModal.prototype, \"userService\", void 0);\n    __decorate([\n        Inject,\n        __metadata(\"design:type\", typeof (_b = typeof RouterStore !== \"undefined\" && RouterStore) === \"function\" ? _b : Object)\n    ], InitModal.prototype, \"routerStore\", void 0);\n    __decorate([\n        Inject,\n        __metadata(\"design:type\", typeof (_c = typeof UserStore !== \"undefined\" && UserStore) === \"function\" ? _c : Object)\n    ], InitModal.prototype, \"userStore\", void 0);\n    __decorate([\n        Inject,\n        __metadata(\"design:type\", typeof (_d = typeof InvreqService !== \"undefined\" && InvreqService) === \"function\" ? _d : Object)\n    ], InitModal.prototype, \"invreqService\", void 0);\n    __decorate([\n        observable,\n        __metadata(\"design:type\", typeof (_e = typeof InvreqInitFormData !== \"undefined\" && InvreqInitFormData) === \"function\" ? _e : Object)\n    ], InitModal.prototype, \"data\", void 0);\n    __decorate([\n        observable,\n        __metadata(\"design:type\", Boolean)\n    ], InitModal.prototype, \"initiated\", void 0);\n    __decorate([\n        action,\n        __metadata(\"design:type\", Function),\n        __metadata(\"design:paramtypes\", []),\n        __metadata(\"design:returntype\", void 0)\n    ], InitModal.prototype, \"componentDidUpdate\", null);\n    __decorate([\n        observable,\n        __metadata(\"design:type\", Object)\n    ], InitModal.prototype, \"submitting\", void 0);\n    __decorate([\n        action,\n        __metadata(\"design:type\", Object)\n    ], InitModal.prototype, \"onSubmit\", void 0);\n    __decorate([\n        action,\n        __metadata(\"design:type\", Object)\n    ], InitModal.prototype, \"onYearChange\", void 0);\n    __decorate([\n        action,\n        __metadata(\"design:type\", Object)\n    ], InitModal.prototype, \"afterClose\", void 0);\n    InitModal = __decorate([\n        observer\n    ], InitModal);\n    return InitModal;\n}(React.Component));\nexport default InitModal;\nvar templateObject_1;\n",{"version":3,"file":"/run/media/williamyh/新加卷/project/Deecamp-project/system/Web/src/app/pages/InvReqPage/InitModal/index.tsx","sourceRoot":"","sources":["/run/media/williamyh/新加卷/project/Deecamp-project/system/Web/src/app/pages/InvReqPage/InitModal/index.tsx"],"names":[],"mappings":"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","sourcesContent":["import React from \"react\";\r\nimport { Form, Input, Modal, Slider, Alert } from \"antd\";\r\nimport { observer } from \"mobx-react\";\r\nimport { LocaleMessage } from \"../../../internationalization\";\r\nimport lang from \"../../../internationalization/LocaleStore/lang\";\r\nimport { Inject } from \"react.di\";\r\nimport { UserService } from \"../../../api/UserService\";\r\nimport { RouterStore } from \"../../../routing/RouterStore\";\r\nimport { UserStore } from \"../../../stores/UserStore\";\r\nimport { InvreqService } from \"../../../api/InvreqService\";\r\nimport FormItem from \"../../../components/Form/FormItem\";\r\nimport { action, observable, runInAction } from \"mobx\";\r\nimport { InvreqInitFormData } from \"./InvreqInitFormData\";\r\nimport { Link } from \"react-router-dom\";\r\nimport styled from \"styled-components\";\r\n\r\ninterface Props {\r\n  close(): void;\r\n\r\n  shown: boolean;\r\n}\r\n\r\ninterface State {\r\n}\r\n\r\nconst root = lang().invreqInit;\r\n\r\nconst Hint = styled.small`\r\n  line-height: 24px;\r\n  display: block;\r\n`;\r\n\r\n/**\r\n * SignIn Form\r\n */\r\n@observer\r\nexport default class InitModal extends React.Component<Props, State> {\r\n\r\n  @Inject userService: UserService;\r\n  @Inject routerStore: RouterStore;\r\n  @Inject userStore: UserStore;\r\n  @Inject invreqService: InvreqService;\r\n\r\n  @observable data: InvreqInitFormData;\r\n\r\n  @observable initiated: boolean = false;\r\n\r\n  componentDidMount() {\r\n    this.initData();\r\n  }\r\n\r\n  @action componentDidUpdate() {\r\n    if (!this.initiated) {\r\n      this.initData();\r\n    }\r\n  }\r\n\r\n  async initData() {\r\n    const data = await this.userService.getUserInvestmentPreference(this.userStore.user.username);\r\n    runInAction(() => {\r\n      this.data = new InvreqInitFormData(data);\r\n      this.initiated = true;\r\n    });\r\n  }\r\n\r\n  @observable submitting = false;\r\n\r\n  @action onSubmit = async () => {\r\n    this.data.confirmAttempted = true;\r\n    // console.log(this.data);\r\n    if (!this.data.valid) {\r\n      return;\r\n    }\r\n\r\n    this.invreqService.createInvreq(this.data.data);\r\n\r\n    Modal.info({\r\n      title: \"信息已经提交\",\r\n      content: \"创建一个资产账户所需要的信息已经提交。创建账户需要一点时间。当账号创建完成时，系统将会发出通知，请耐心等待。\",\r\n      onOk: () => this.props.close(),\r\n    });\r\n\r\n    // this.submitting = true;\r\n    // // execute fetch\r\n    // const result = await this.invreqService.createInvreq(this.data.data);\r\n    //\r\n    // runInAction(() => {\r\n    //   this.submitting = false;\r\n    // });\r\n    // this.props.close();\r\n    // this.routerStore.jumpTo(`/invreq/${result.invreqId}`);\r\n  };\r\n\r\n  @action onYearChange = (value: number) => {\r\n    this.data.year = value;\r\n  };\r\n\r\n  @action afterClose = () => {\r\n    this.initiated = false;\r\n  };\r\n\r\n  render() {\r\n    if (!this.initiated) {\r\n      return null;\r\n    }\r\n\r\n    const {fluctuation, profit, amount, year, fluctuationValid, profitValid, amountValid} = this.data;\r\n\r\n    return (\r\n      <Modal\r\n        visible={this.props.shown}\r\n        title={<LocaleMessage id={root.init}/>}\r\n        confirmLoading={this.submitting}\r\n        onCancel={this.props.close}\r\n        afterClose={this.afterClose}\r\n        onOk={this.onSubmit}\r\n      >\r\n        <p>下列数据已通过您的理财偏好自动填写。</p>\r\n        <Link to={\"/user/investmentPreference\"}>访问此处以访问和修改您的理财偏好</Link>\r\n\r\n        <Form>\r\n          <FormItem valid={profitValid} messageOnInvalid={\"收益率应该在大于等于0但小于等于10%\"}>\r\n            <p><LocaleMessage id={root.profit}/></p>\r\n            <Alert type={\"warning\"} message={\r\n              <div>\r\n                <p>由于余额宝收益率在3.439%左右，建议预期收益率不要超过8%。</p>\r\n                <p>收益率过高会导致资金全部分配于股票市场，请谨慎考虑。</p>\r\n              </div>}/>\r\n            <Input type={\"number\"}\r\n                   onChange={this.data.onChange(\"profit\")}\r\n                   value={profit}\r\n                   addonAfter={\"%\"}\r\n            />\r\n          </FormItem>\r\n\r\n          <FormItem valid={fluctuationValid} messageOnInvalid={\"波动率应该大于等于3%\"}>\r\n            <p><LocaleMessage id={root.fluctuation}/></p>\r\n            <Input type={\"number\"}\r\n                   onChange={this.data.onChange(\"fluctuation\")}\r\n                   value={fluctuation}\r\n                   addonAfter={\"%\"}\r\n            />\r\n          </FormItem>\r\n\r\n          <FormItem valid={amountValid} messageOnInvalid={\"金额应该大于等于0\"}>\r\n            <p><LocaleMessage id={root.amount}/></p>\r\n            <Input type={\"number\"}\r\n                   onChange={this.data.onChange(\"amount\")}\r\n                   value={amount}\r\n            />\r\n          </FormItem>\r\n\r\n          <FormItem valid={true} messageOnInvalid={\"\"}>\r\n            <p><LocaleMessage id={root.year}/> <strong>{year}</strong></p>\r\n            <Slider min={1} max={10} onChange={this.onYearChange} value={year}/>\r\n          </FormItem>\r\n        </Form>\r\n      </Modal>\r\n    );\r\n  }\r\n}\r\n"]}]}