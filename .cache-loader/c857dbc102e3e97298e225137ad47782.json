{"remainingRequest":"/run/media/williamyh/新加卷/project/Deecamp-project/system/Web/node_modules/ts-loader/index.js??ref--4-1!/run/media/williamyh/新加卷/project/Deecamp-project/system/Web/node_modules/bizcharts/node_modules/@antv/component/lib/label/base.js","dependencies":[{"path":"/run/media/williamyh/新加卷/project/Deecamp-project/system/Web/node_modules/bizcharts/node_modules/@antv/component/lib/label/base.js","mtime":499162500000},{"path":"/run/media/williamyh/新加卷/project/Deecamp-project/system/Web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/run/media/williamyh/新加卷/project/Deecamp-project/system/Web/node_modules/ts-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":["function _createSuper(Derived) { return function () { var Super = _getPrototypeOf(Derived), result; if (_isNativeReflectConstruct()) {\n    var NewTarget = _getPrototypeOf(this).constructor;\n    result = Reflect.construct(Super, arguments, NewTarget);\n}\nelse {\n    result = Super.apply(this, arguments);\n} return _possibleConstructorReturn(this, result); }; }\nfunction _possibleConstructorReturn(self, call) { if (call && (typeof call === \"object\" || typeof call === \"function\")) {\n    return call;\n} return _assertThisInitialized(self); }\nfunction _assertThisInitialized(self) { if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n} return self; }\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct)\n    return false; if (Reflect.construct.sham)\n    return false; if (typeof Proxy === \"function\")\n    return true; try {\n    Date.prototype.toString.call(Reflect.construct(Date, [], function () { }));\n    return true;\n}\ncatch (e) {\n    return false;\n} }\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\nfunction _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }\nvar Util = require('../util');\nvar DomUtil = Util.DomUtil;\nvar Component = require('../component');\nvar positionAdjust = require('./utils/position-adjust');\nvar spirialAdjust = require('./utils/spiral-adjust');\nvar bboxAdjust = require('./utils/bbox-adjust');\nvar LAYOUTS = {\n    scatter: positionAdjust,\n    map: spirialAdjust,\n    treemap: bboxAdjust\n};\nvar Label = function (_Component) {\n    _inheritsLoose(Label, _Component);\n    var _super = _createSuper(Label);\n    function Label() {\n        return _Component.apply(this, arguments) || this;\n    }\n    var _proto = Label.prototype;\n    _proto.getDefaultCfg = function getDefaultCfg() {\n        var cfg = _Component.prototype.getDefaultCfg.call(this);\n        return Util.mix({}, cfg, {\n            name: 'label',\n            type: 'default',\n            textStyle: null,\n            formatter: null,\n            items: null,\n            useHtml: false,\n            containerTpl: '<div class=\"g-labels\" style=\"position:absolute;top:0;left:0;\"></div>',\n            itemTpl: '<div class=\"g-label\" style=\"position:absolute;\">{text}</div>',\n            labelLine: false,\n            lineGroup: null,\n            shapes: null,\n            config: true,\n            capture: true\n        });\n    };\n    _proto.clear = function clear() {\n        var group = this.get('group');\n        var container = this.get('container');\n        if (group && !group.get('destroyed')) {\n            group.clear();\n        }\n        if (container) {\n            container.innerHTML = '';\n        }\n        _Component.prototype.clear.call(this);\n    };\n    _proto.destroy = function destroy() {\n        var group = this.get('group');\n        var container = this.get('container');\n        if (!group.destroy) {\n            group.destroy();\n        }\n        if (container) {\n            container.parentNode && container.parentNode.removeChild(container);\n        }\n        _Component.prototype.destroy.call(this);\n    };\n    _proto.render = function render() {\n        this.clear();\n        this._init();\n        this.beforeDraw();\n        this.draw();\n        this.afterDraw();\n    };\n    _proto._dryDraw = function _dryDraw() {\n        var self = this;\n        var items = self.get('items');\n        var children = self.getLabels();\n        var count = children.length;\n        Util.each(items, function (item, index) {\n            if (index < count) {\n                var label = children[index];\n                self.changeLabel(label, item);\n            }\n            else {\n                var labelShape = self._addLabel(item, index);\n                if (labelShape) {\n                    labelShape._id = item._id;\n                    labelShape.set('coord', item.coord);\n                }\n            }\n        });\n        for (var i = count - 1; i >= items.length; i--) {\n            children[i].remove();\n        }\n        self._adjustLabels();\n        if (self.get('labelLine') || !self.get('config')) {\n            self.drawLines();\n        }\n    };\n    _proto.draw = function draw() {\n        this._dryDraw();\n        this.get('canvas').draw();\n    };\n    _proto.changeLabel = function changeLabel(oldLabel, newLabel) {\n        if (!oldLabel) {\n            return;\n        }\n        if (oldLabel.tagName) {\n            var node = this._createDom(newLabel);\n            oldLabel.innerHTML = node.innerHTML;\n            this._setCustomPosition(newLabel, oldLabel);\n        }\n        else {\n            oldLabel._id = newLabel._id;\n            oldLabel.attr('text', newLabel.text);\n            if (oldLabel.attr('x') !== newLabel.x || oldLabel.attr('y') !== newLabel.y) {\n                oldLabel.resetMatrix();\n                if (newLabel.textStyle.rotate) {\n                    oldLabel.rotateAtStart(newLabel.textStyle.rotate);\n                    delete newLabel.textStyle.rotate;\n                }\n                oldLabel.attr(newLabel);\n            }\n        }\n    };\n    _proto.show = function show() {\n        var group = this.get('group');\n        var container = this.get('container');\n        if (group) {\n            group.show();\n        }\n        if (container) {\n            container.style.opacity = 1;\n        }\n    };\n    _proto.hide = function hide() {\n        var group = this.get('group');\n        var container = this.get('container');\n        if (group) {\n            group.hide();\n        }\n        if (container) {\n            container.style.opacity = 0;\n        }\n    };\n    _proto.drawLines = function drawLines() {\n        var self = this;\n        var lineStyle = self.get('labelLine');\n        if (typeof lineStyle === 'boolean') {\n            self.set('labelLine', {});\n        }\n        var lineGroup = self.get('lineGroup');\n        if (!lineGroup || lineGroup.get('destroyed')) {\n            lineGroup = self.get('group').addGroup({\n                elCls: 'x-line-group'\n            });\n            self.set('lineGroup', lineGroup);\n        }\n        else {\n            lineGroup.clear();\n        }\n        Util.each(self.get('items'), function (label) {\n            self.lineToLabel(label, lineGroup);\n        });\n    };\n    _proto.lineToLabel = function lineToLabel(label, lineGroup) {\n        var self = this;\n        if (!self.get('config') && !label.labelLine) {\n            return;\n        }\n        var lineStyle = label.labelLine || self.get('labelLine');\n        var capture = typeof label.capture === 'undefined' ? self.get('capture') : label.capture;\n        var path = lineStyle.path;\n        if (path && Util.isFunction(lineStyle.path)) {\n            path = lineStyle.path(label);\n        }\n        if (!path) {\n            var start = label.start || {\n                x: label.x - label._offset.x,\n                y: label.y - label._offset.y\n            };\n            path = [['M', start.x, start.y], ['L', label.x, label.y]];\n        }\n        var stroke = label.color;\n        if (!stroke) {\n            if (label.textStyle && label.textStyle.fill) {\n                stroke = label.textStyle.fill;\n            }\n            else {\n                stroke = '#000';\n            }\n        }\n        var lineShape = lineGroup.addShape('path', {\n            attrs: Util.mix({\n                path: path,\n                fill: null,\n                stroke: stroke\n            }, lineStyle),\n            capture: capture\n        });\n        lineShape.name = self.get('name');\n        lineShape._id = label._id && label._id.replace('glabel', 'glabelline');\n        lineShape.set('coord', self.get('coord'));\n    };\n    _proto._adjustLabels = function _adjustLabels() {\n        var self = this;\n        var type = self.get('type');\n        var labels = self.getLabels();\n        var shapes = self.get('shapes');\n        var layout = LAYOUTS[type];\n        if (type === 'default' || !layout) {\n            return;\n        }\n        layout(labels, shapes);\n    };\n    _proto.getLabels = function getLabels() {\n        var container = this.get('container');\n        if (container) {\n            return Util.toArray(container.childNodes);\n        }\n        return this.get('group').get('children');\n    };\n    _proto._addLabel = function _addLabel(item, index) {\n        var cfg = item;\n        if (this.get('config')) {\n            cfg = this._getLabelCfg(item, index);\n        }\n        return this._createText(cfg);\n    };\n    _proto._getLabelCfg = function _getLabelCfg(item, index) {\n        var textStyle = this.get('textStyle') || {};\n        var formatter = this.get('formatter');\n        var htmlTemplate = this.get('htmlTemplate');\n        if (!Util.isObject(item)) {\n            var tmp = item;\n            item = {};\n            item.text = tmp;\n        }\n        if (Util.isFunction(textStyle)) {\n            textStyle = textStyle(item.text, item, index);\n        }\n        if (formatter) {\n            item.text = formatter(item.text, item, index);\n        }\n        if (htmlTemplate) {\n            item.useHtml = true;\n            if (Util.isFunction(htmlTemplate)) {\n                item.text = htmlTemplate(item.text, item, index);\n            }\n        }\n        if (Util.isNil(item.text)) {\n            item.text = '';\n        }\n        item.text = item.text + '';\n        var cfg = Util.mix({}, item, {\n            textStyle: textStyle\n        }, {\n            x: item.x || 0,\n            y: item.y || 0\n        });\n        return cfg;\n    };\n    _proto._init = function _init() {\n        if (!this.get('group')) {\n            var group = this.get('canvas').addGroup({\n                id: 'label-group'\n            });\n            this.set('group', group);\n        }\n    };\n    _proto.initHtmlContainer = function initHtmlContainer() {\n        var container = this.get('container');\n        if (!container) {\n            var containerTpl = this.get('containerTpl');\n            var wrapper = this.get('canvas').get('el').parentNode;\n            container = DomUtil.createDom(containerTpl);\n            wrapper.style.position = 'relative';\n            wrapper.appendChild(container);\n            this.set('container', container);\n        }\n        else if (Util.isString(container)) {\n            container = document.getElementById(container);\n            if (container) {\n                this.set('container', container);\n            }\n        }\n        return container;\n    };\n    _proto._createText = function _createText(config) {\n        var cfg = Util.deepMix({}, config);\n        var container = this.get('container');\n        var capture = typeof cfg.capture === 'undefined' ? this.get('capture') : cfg.capture;\n        var labelShape;\n        if (cfg.useHtml || cfg.htmlTemplate) {\n            if (!container) {\n                container = this.initHtmlContainer();\n            }\n            var node = this._createDom(cfg);\n            container.appendChild(node);\n            this._setCustomPosition(cfg, node);\n        }\n        else {\n            var name = this.get('name');\n            var origin = cfg.point;\n            var group = this.get('group');\n            delete cfg.point;\n            var rotate = cfg.rotate;\n            if (cfg.textStyle) {\n                if (cfg.textStyle.rotate) {\n                    rotate = cfg.textStyle.rotate;\n                    delete cfg.textStyle.rotate;\n                }\n                cfg = Util.mix({\n                    x: cfg.x,\n                    y: cfg.y,\n                    textAlign: cfg.textAlign,\n                    text: cfg.text\n                }, cfg.textStyle);\n            }\n            labelShape = group.addShape('text', {\n                attrs: cfg,\n                capture: capture\n            });\n            if (rotate) {\n                if (Math.abs(rotate) > Math.PI * 2) {\n                    rotate = rotate / 180 * Math.PI;\n                }\n                labelShape.transform([['t', -cfg.x, -cfg.y], ['r', rotate], ['t', cfg.x, cfg.y]]);\n            }\n            labelShape.setSilent('origin', origin || cfg);\n            labelShape.name = name;\n            this.get('appendInfo') && labelShape.setSilent('appendInfo', this.get('appendInfo'));\n            return labelShape;\n        }\n    };\n    _proto._createDom = function _createDom(cfg) {\n        var itemTpl = this.get('itemTpl');\n        var str = Util.substitute(itemTpl, {\n            text: cfg.text\n        });\n        return DomUtil.createDom(str);\n    };\n    _proto._setCustomPosition = function _setCustomPosition(cfg, htmlDom) {\n        var textAlign = cfg.textAlign || 'left';\n        var top = cfg.y;\n        var left = cfg.x;\n        var width = DomUtil.getOuterWidth(htmlDom);\n        var height = DomUtil.getOuterHeight(htmlDom);\n        top = top - height / 2;\n        if (textAlign === 'center') {\n            left = left - width / 2;\n        }\n        else if (textAlign === 'right') {\n            left = left - width;\n        }\n        htmlDom.style.top = parseInt(top, 10) + 'px';\n        htmlDom.style.left = parseInt(left, 10) + 'px';\n    };\n    return Label;\n}(Component);\nmodule.exports = Label;\n",{"version":3,"file":"/run/media/williamyh/新加卷/project/Deecamp-project/system/Web/node_modules/bizcharts/node_modules/@antv/component/lib/label/base.js","sourceRoot":"","sources":["/run/media/williamyh/新加卷/project/Deecamp-project/system/Web/node_modules/bizcharts/node_modules/@antv/component/lib/label/base.js"],"names":[],"mappings":"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","sourcesContent":["function _createSuper(Derived) { return function () { var Super = _getPrototypeOf(Derived), result; if (_isNativeReflectConstruct()) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (typeof call === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }\n\nvar Util = require('../util');\n\nvar DomUtil = Util.DomUtil;\n\nvar Component = require('../component');\n\nvar positionAdjust = require('./utils/position-adjust');\n\nvar spirialAdjust = require('./utils/spiral-adjust');\n\nvar bboxAdjust = require('./utils/bbox-adjust');\n\nvar LAYOUTS = {\n  scatter: positionAdjust,\n  map: spirialAdjust,\n  treemap: bboxAdjust\n};\n\nvar Label = /*#__PURE__*/function (_Component) {\n  _inheritsLoose(Label, _Component);\n\n  var _super = _createSuper(Label);\n\n  function Label() {\n    return _Component.apply(this, arguments) || this;\n  }\n\n  var _proto = Label.prototype;\n\n  _proto.getDefaultCfg = function getDefaultCfg() {\n    var cfg = _Component.prototype.getDefaultCfg.call(this);\n\n    return Util.mix({}, cfg, {\n      name: 'label',\n\n      /**\n       * label类型\n       * @type {(String)}\n       */\n      type: 'default',\n\n      /**\n       * 默认文本样式\n       * @type {Array}\n       */\n      textStyle: null,\n\n      /**\n       * 文本显示格式化回调函数\n       * @type {Function}\n       */\n      formatter: null,\n\n      /**\n       * 显示的文本集合\n       * @type {Array}\n       */\n      items: null,\n\n      /**\n       * 是否使用html渲染label\n       * @type {String}\n       */\n      useHtml: false,\n\n      /**\n       * html 渲染时用的容器的模板，必须存在 class = \"g-labels\"\n       * @type {String}\n       */\n      containerTpl: '<div class=\"g-labels\" style=\"position:absolute;top:0;left:0;\"></div>',\n\n      /**\n       * html 渲染时单个 label 的模板，必须存在 class = \"g-label\"\n       * @type {String}\n       */\n      itemTpl: '<div class=\"g-label\" style=\"position:absolute;\">{text}</div>',\n\n      /**\n       * label牵引线定义\n       * @type {String || Object}\n       */\n      labelLine: false,\n\n      /**\n       * label牵引线容器\n       * @type Object\n       */\n      lineGroup: null,\n\n      /**\n       * 需添加label的shape\n       * @type Object\n       */\n      shapes: null,\n\n      /**\n       * 默认为true。为false时指定直接用items渲染文本，不进行config\n       * @type Object\n       */\n      config: true,\n\n      /**\n       * 是否进行拾取\n       * @type Object\n       */\n      capture: true\n    });\n  }\n  /*\n   * 清空label容器\n   */\n  ;\n\n  _proto.clear = function clear() {\n    var group = this.get('group');\n    var container = this.get('container');\n\n    if (group && !group.get('destroyed')) {\n      group.clear();\n    }\n\n    if (container) {\n      container.innerHTML = '';\n    }\n\n    _Component.prototype.clear.call(this);\n  }\n  /**\n   * 销毁group\n   */\n  ;\n\n  _proto.destroy = function destroy() {\n    var group = this.get('group');\n    var container = this.get('container');\n\n    if (!group.destroy) {\n      group.destroy();\n    }\n\n    if (container) {\n      container.parentNode && container.parentNode.removeChild(container);\n    }\n\n    _Component.prototype.destroy.call(this); // 要最后调用 super.destroy 否则 get 属性会无效\n\n  }\n  /**\n   * label绘制全过程\n   */\n  ;\n\n  _proto.render = function render() {\n    this.clear();\n\n    this._init();\n\n    this.beforeDraw();\n    this.draw();\n    this.afterDraw();\n  };\n\n  _proto._dryDraw = function _dryDraw() {\n    var self = this;\n    var items = self.get('items');\n    var children = self.getLabels();\n    var count = children.length;\n    Util.each(items, function (item, index) {\n      if (index < count) {\n        var label = children[index];\n        self.changeLabel(label, item);\n      } else {\n        var labelShape = self._addLabel(item, index);\n\n        if (labelShape) {\n          labelShape._id = item._id;\n          labelShape.set('coord', item.coord);\n        }\n      }\n    });\n\n    for (var i = count - 1; i >= items.length; i--) {\n      children[i].remove();\n    }\n\n    self._adjustLabels();\n\n    if (self.get('labelLine') || !self.get('config')) {\n      self.drawLines();\n    }\n  }\n  /**\n   * 更新label\n   * 1. 将items与group中的children对比，更新/新增/删除labels\n   * 2. labels布局优化\n   * 3. 画label连接线\n   * 4. 绘制到画布\n   */\n  ;\n\n  _proto.draw = function draw() {\n    this._dryDraw();\n\n    this.get('canvas').draw();\n  }\n  /*\n   * 更新label\n   * oldLabel shape或label dom\n   * newLabel label data\n   * index items中的下标\n   */\n  ;\n\n  _proto.changeLabel = function changeLabel(oldLabel, newLabel) {\n    if (!oldLabel) {\n      return;\n    }\n\n    if (oldLabel.tagName) {\n      var node = this._createDom(newLabel);\n\n      oldLabel.innerHTML = node.innerHTML;\n\n      this._setCustomPosition(newLabel, oldLabel);\n    } else {\n      oldLabel._id = newLabel._id;\n      oldLabel.attr('text', newLabel.text);\n\n      if (oldLabel.attr('x') !== newLabel.x || oldLabel.attr('y') !== newLabel.y) {\n        oldLabel.resetMatrix();\n\n        if (newLabel.textStyle.rotate) {\n          oldLabel.rotateAtStart(newLabel.textStyle.rotate);\n          delete newLabel.textStyle.rotate;\n        }\n\n        oldLabel.attr(newLabel);\n      }\n    }\n  }\n  /**\n   * 显示label\n   */\n  ;\n\n  _proto.show = function show() {\n    var group = this.get('group');\n    var container = this.get('container');\n\n    if (group) {\n      group.show();\n    }\n\n    if (container) {\n      container.style.opacity = 1;\n    }\n  }\n  /**\n   * 隐藏label\n   */\n  ;\n\n  _proto.hide = function hide() {\n    var group = this.get('group');\n    var container = this.get('container');\n\n    if (group) {\n      group.hide();\n    }\n\n    if (container) {\n      container.style.opacity = 0;\n    }\n  }\n  /**\n   * 画label连接线\n   */\n  ;\n\n  _proto.drawLines = function drawLines() {\n    var self = this;\n    var lineStyle = self.get('labelLine');\n\n    if (typeof lineStyle === 'boolean') {\n      self.set('labelLine', {});\n    }\n\n    var lineGroup = self.get('lineGroup');\n\n    if (!lineGroup || lineGroup.get('destroyed')) {\n      lineGroup = self.get('group').addGroup({\n        elCls: 'x-line-group'\n      });\n      self.set('lineGroup', lineGroup);\n    } else {\n      lineGroup.clear();\n    }\n\n    Util.each(self.get('items'), function (label) {\n      self.lineToLabel(label, lineGroup);\n    });\n  };\n\n  _proto.lineToLabel = function lineToLabel(label, lineGroup) {\n    var self = this;\n\n    if (!self.get('config') && !label.labelLine) {\n      return;\n    }\n\n    var lineStyle = label.labelLine || self.get('labelLine');\n    var capture = typeof label.capture === 'undefined' ? self.get('capture') : label.capture;\n    var path = lineStyle.path;\n\n    if (path && Util.isFunction(lineStyle.path)) {\n      path = lineStyle.path(label);\n    }\n\n    if (!path) {\n      var start = label.start || {\n        x: label.x - label._offset.x,\n        y: label.y - label._offset.y\n      };\n      path = [['M', start.x, start.y], ['L', label.x, label.y]];\n    }\n\n    var stroke = label.color;\n\n    if (!stroke) {\n      if (label.textStyle && label.textStyle.fill) {\n        stroke = label.textStyle.fill;\n      } else {\n        stroke = '#000';\n      }\n    }\n\n    var lineShape = lineGroup.addShape('path', {\n      attrs: Util.mix({\n        path: path,\n        fill: null,\n        stroke: stroke\n      }, lineStyle),\n      capture: capture\n    }); // label 对应线的动画关闭\n\n    lineShape.name = self.get('name'); // generate labelLine id according to label id\n\n    lineShape._id = label._id && label._id.replace('glabel', 'glabelline');\n    lineShape.set('coord', self.get('coord'));\n  } // 根据type对label布局\n  ;\n\n  _proto._adjustLabels = function _adjustLabels() {\n    var self = this;\n    var type = self.get('type');\n    var labels = self.getLabels();\n    var shapes = self.get('shapes');\n    var layout = LAYOUTS[type];\n\n    if (type === 'default' || !layout) {\n      return;\n    }\n\n    layout(labels, shapes);\n  }\n  /**\n   * 获取当前所有label实例\n   * @return {Array} 当前label实例\n   */\n  ;\n\n  _proto.getLabels = function getLabels() {\n    var container = this.get('container');\n\n    if (container) {\n      return Util.toArray(container.childNodes);\n    }\n\n    return this.get('group').get('children');\n  } // 先计算label的所有配置项，然后生成label实例\n  ;\n\n  _proto._addLabel = function _addLabel(item, index) {\n    var cfg = item;\n\n    if (this.get('config')) {\n      cfg = this._getLabelCfg(item, index);\n    }\n\n    return this._createText(cfg);\n  };\n\n  _proto._getLabelCfg = function _getLabelCfg(item, index) {\n    var textStyle = this.get('textStyle') || {};\n    var formatter = this.get('formatter');\n    var htmlTemplate = this.get('htmlTemplate');\n\n    if (!Util.isObject(item)) {\n      var tmp = item;\n      item = {};\n      item.text = tmp;\n    }\n\n    if (Util.isFunction(textStyle)) {\n      textStyle = textStyle(item.text, item, index);\n    }\n\n    if (formatter) {\n      item.text = formatter(item.text, item, index);\n    }\n\n    if (htmlTemplate) {\n      item.useHtml = true;\n\n      if (Util.isFunction(htmlTemplate)) {\n        item.text = htmlTemplate(item.text, item, index);\n      }\n    }\n\n    if (Util.isNil(item.text)) {\n      item.text = '';\n    }\n\n    item.text = item.text + ''; // ? 为什么转换为字符串\n\n    var cfg = Util.mix({}, item, {\n      textStyle: textStyle\n    }, {\n      x: item.x || 0,\n      y: item.y || 0\n    });\n    return cfg;\n  }\n  /**\n   * label初始化，主要针对html容器\n   */\n  ;\n\n  _proto._init = function _init() {\n    if (!this.get('group')) {\n      var group = this.get('canvas').addGroup({\n        id: 'label-group'\n      });\n      this.set('group', group);\n    }\n  };\n\n  _proto.initHtmlContainer = function initHtmlContainer() {\n    var container = this.get('container');\n\n    if (!container) {\n      var containerTpl = this.get('containerTpl');\n      var wrapper = this.get('canvas').get('el').parentNode;\n      container = DomUtil.createDom(containerTpl);\n      wrapper.style.position = 'relative';\n      wrapper.appendChild(container);\n      this.set('container', container);\n    } else if (Util.isString(container)) {\n      container = document.getElementById(container);\n\n      if (container) {\n        this.set('container', container);\n      }\n    }\n\n    return container;\n  } // 分html dom和G shape两种情况生成label实例\n  ;\n\n  _proto._createText = function _createText(config) {\n    // @2018-11-29 by blue.lb 这里由于使用delete导致之后的配置无法获取到point和rotate，出现问题，深拷贝一次比较好\n    var cfg = Util.deepMix({}, config);\n    var container = this.get('container');\n    var capture = typeof cfg.capture === 'undefined' ? this.get('capture') : cfg.capture;\n    var labelShape;\n\n    if (cfg.useHtml || cfg.htmlTemplate) {\n      if (!container) {\n        container = this.initHtmlContainer();\n      }\n\n      var node = this._createDom(cfg);\n\n      container.appendChild(node);\n\n      this._setCustomPosition(cfg, node);\n    } else {\n      var name = this.get('name');\n      var origin = cfg.point;\n      var group = this.get('group');\n      delete cfg.point; // 临时解决，否则影响动画\n\n      var rotate = cfg.rotate; // textStyle中的rotate虽然可以正常画出，但是在做动画的时候可能会导致动画异常。移出，在定义好shape后通过transform实现效果。\n\n      if (cfg.textStyle) {\n        if (cfg.textStyle.rotate) {\n          rotate = cfg.textStyle.rotate;\n          delete cfg.textStyle.rotate;\n        }\n\n        cfg = Util.mix({\n          x: cfg.x,\n          y: cfg.y,\n          textAlign: cfg.textAlign,\n          text: cfg.text\n        }, cfg.textStyle);\n      }\n\n      labelShape = group.addShape('text', {\n        attrs: cfg,\n        capture: capture\n      });\n\n      if (rotate) {\n        // rotate是用角度定义的，转换为弧度\n        if (Math.abs(rotate) > Math.PI * 2) {\n          rotate = rotate / 180 * Math.PI;\n        }\n\n        labelShape.transform([['t', -cfg.x, -cfg.y], ['r', rotate], ['t', cfg.x, cfg.y]]);\n      }\n\n      labelShape.setSilent('origin', origin || cfg);\n      labelShape.name = name; // 用于事件标注\n\n      this.get('appendInfo') && labelShape.setSilent('appendInfo', this.get('appendInfo'));\n      return labelShape;\n    }\n  };\n\n  _proto._createDom = function _createDom(cfg) {\n    var itemTpl = this.get('itemTpl');\n    var str = Util.substitute(itemTpl, {\n      text: cfg.text\n    });\n    return DomUtil.createDom(str);\n  } // 根据文本对齐方式确定dom位置\n  ;\n\n  _proto._setCustomPosition = function _setCustomPosition(cfg, htmlDom) {\n    var textAlign = cfg.textAlign || 'left';\n    var top = cfg.y;\n    var left = cfg.x;\n    var width = DomUtil.getOuterWidth(htmlDom);\n    var height = DomUtil.getOuterHeight(htmlDom);\n    top = top - height / 2;\n\n    if (textAlign === 'center') {\n      left = left - width / 2;\n    } else if (textAlign === 'right') {\n      left = left - width;\n    }\n\n    htmlDom.style.top = parseInt(top, 10) + 'px';\n    htmlDom.style.left = parseInt(left, 10) + 'px';\n  };\n\n  return Label;\n}(Component);\n\nmodule.exports = Label;"]}]}