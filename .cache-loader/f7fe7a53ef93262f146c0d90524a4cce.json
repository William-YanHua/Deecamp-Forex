{"remainingRequest":"/run/media/williamyh/新加卷/project/Deecamp-project/system/Web/node_modules/ts-loader/index.js??ref--4-1!/run/media/williamyh/新加卷/project/Deecamp-project/system/Web/node_modules/@antv/g2plot/esm/plots/calendar/util.js","dependencies":[{"path":"/run/media/williamyh/新加卷/project/Deecamp-project/system/Web/node_modules/@antv/g2plot/esm/plots/calendar/util.js","mtime":499162500000},{"path":"/run/media/williamyh/新加卷/project/Deecamp-project/system/Web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/run/media/williamyh/新加卷/project/Deecamp-project/system/Web/node_modules/ts-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import { __assign } from \"tslib\";\nimport fecha from 'fecha';\nimport { head, last, find } from '@antv/util';\nimport { DATE_FIELD, DAY_FIELD, FORMATTER, WEEK_FIELD } from './constant';\nimport { advanceBy, DAY_MS, getDay, getWeek } from '../../util/date';\nfunction parseDateRange(dateRange) {\n    var _a;\n    var from = dateRange[0], to = dateRange[1];\n    var fromDate = fecha.parse(from, FORMATTER);\n    var toDate = fecha.parse(to, FORMATTER);\n    if (fromDate > toDate) {\n        _a = [fromDate, toDate], toDate = _a[0], fromDate = _a[1];\n    }\n    return [fromDate, toDate];\n}\nexport function generateCalendarData(data, dateRange, dateField) {\n    var all = [];\n    var _a = parseDateRange(dateRange), fromDate = _a[0], toDate = _a[1];\n    var curr = new Date(fromDate);\n    var _loop_1 = function () {\n        var _a;\n        var dateString = fecha.format(curr, FORMATTER);\n        var datum = find(data, function (datum) { return datum[dateField] === dateString; });\n        all.push(__assign((_a = {}, _a[DAY_FIELD] = getDay(curr), _a[WEEK_FIELD] = \"\" + getWeek(curr), _a[dateField] = dateString, _a[DATE_FIELD] = new Date(curr), _a), datum));\n        advanceBy(curr, DAY_MS);\n    };\n    while (curr <= toDate) {\n        _loop_1();\n    }\n    return all;\n}\nexport function getMonthCenterWeek(dateRange) {\n    var _a = parseDateRange(dateRange), fromDate = _a[0], toDate = _a[1];\n    var monthWeekMap = new Map();\n    function append(current) {\n        var month = current.getMonth();\n        var week = getWeek(current);\n        if (!monthWeekMap.has(month)) {\n            monthWeekMap.set(month, []);\n        }\n        monthWeekMap.get(month).push(week);\n    }\n    var curr = new Date(fromDate);\n    while (curr <= toDate) {\n        append(curr);\n        advanceBy(curr, DAY_MS * 7);\n    }\n    if (toDate < curr) {\n        append(toDate);\n    }\n    var result = {};\n    monthWeekMap.forEach(function (v, k) {\n        var w = Math.ceil((head(v) + last(v)) / 2);\n        result[w] = k;\n    });\n    return result;\n}\n",{"version":3,"file":"/run/media/williamyh/新加卷/project/Deecamp-project/system/Web/node_modules/@antv/g2plot/esm/plots/calendar/util.js","sourceRoot":"","sources":["/run/media/williamyh/新加卷/project/Deecamp-project/system/Web/node_modules/@antv/g2plot/esm/plots/calendar/util.js"],"names":[],"mappings":"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","sourcesContent":["import { __assign } from \"tslib\";\nimport fecha from 'fecha';\nimport { head, last, find } from '@antv/util';\nimport { DATE_FIELD, DAY_FIELD, FORMATTER, WEEK_FIELD } from './constant';\nimport { advanceBy, DAY_MS, getDay, getWeek } from '../../util/date';\n/**\n * 解析日期\n * @param dateRange\n */\nfunction parseDateRange(dateRange) {\n    var _a;\n    var from = dateRange[0], to = dateRange[1];\n    var fromDate = fecha.parse(from, FORMATTER);\n    var toDate = fecha.parse(to, FORMATTER);\n    // 交换顺序\n    if (fromDate > toDate) {\n        _a = [fromDate, toDate], toDate = _a[0], fromDate = _a[1];\n    }\n    return [fromDate, toDate];\n}\n/**\n * 根据 range 补齐日历图的数据\n * @param data 传入数据\n * @param dateRange 日期区间\n * @param dateField 日期字段\n */\nexport function generateCalendarData(data, dateRange, dateField) {\n    var all = [];\n    var _a = parseDateRange(dateRange), fromDate = _a[0], toDate = _a[1];\n    // copy 一份\n    var curr = new Date(fromDate);\n    var _loop_1 = function () {\n        var _a;\n        var dateString = fecha.format(curr, FORMATTER);\n        // 找到对应的数据\n        var datum = find(data, function (datum) { return datum[dateField] === dateString; });\n        all.push(__assign((_a = {}, _a[DAY_FIELD] = getDay(curr), _a[WEEK_FIELD] = \"\" + getWeek(curr), _a[dateField] = dateString, _a[DATE_FIELD] = new Date(curr), _a), datum));\n        // 向前移动一天\n        advanceBy(curr, DAY_MS);\n    };\n    while (curr <= toDate) {\n        _loop_1();\n    }\n    return all;\n}\n/**\n * 计算每个月的中间周。\n */\nexport function getMonthCenterWeek(dateRange) {\n    var _a = parseDateRange(dateRange), fromDate = _a[0], toDate = _a[1];\n    var monthWeekMap = new Map();\n    function append(current) {\n        var month = current.getMonth(); // 从 0 开始\n        var week = getWeek(current);\n        if (!monthWeekMap.has(month)) {\n            monthWeekMap.set(month, []);\n        }\n        monthWeekMap.get(month).push(week);\n    }\n    // copy 一份\n    var curr = new Date(fromDate);\n    while (curr <= toDate) {\n        // 设置到 map 中\n        append(curr);\n        // 向前移动 7 天（一周）\n        advanceBy(curr, DAY_MS * 7);\n    }\n    // 增加最后一个日期的计算\n    if (toDate < curr) {\n        append(toDate);\n    }\n    // 处理数据，返回结果\n    var result = {}; // week -> month\n    monthWeekMap.forEach(function (v, k) {\n        var w = Math.ceil((head(v) + last(v)) / 2); // 取平均值\n        result[w] = k;\n    });\n    return result;\n}\n//# sourceMappingURL=util.js.map"]}]}