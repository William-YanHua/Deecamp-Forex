{"remainingRequest":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\ts-loader\\index.js??ref--4-1!D:\\project\\Deecamp-project\\system\\Web\\node_modules\\@antv\\g\\lib\\renderers\\canvas\\painter.js","dependencies":[{"path":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\@antv\\g\\lib\\renderers\\canvas\\painter.js","mtime":499162500000},{"path":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1595520254649},{"path":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\ts-loader\\index.js","mtime":1537906253000}],"contextDependencies":[],"result":["var Util = require('../../util');\r\nvar renderUtil = require('./util');\r\nvar SHAPE_ATTRS = ['fillStyle', 'font', 'globalAlpha', 'lineCap', 'lineWidth', 'lineJoin', 'miterLimit', 'shadowBlur', 'shadowColor', 'shadowOffsetX', 'shadowOffsetY', 'strokeStyle', 'textAlign', 'textBaseline', 'lineDash', 'lineDashOffset'];\r\nvar Painter = function () {\r\n    function Painter(dom) {\r\n        if (!dom) {\r\n            return null;\r\n        }\r\n        var canvasId = Util.uniqueId('canvas_');\r\n        var canvasDom = Util.createDom('<canvas id=\"' + canvasId + '\"></canvas>');\r\n        dom.appendChild(canvasDom);\r\n        this.type = 'canvas';\r\n        this.canvas = canvasDom;\r\n        this.context = canvasDom.getContext('2d');\r\n        this.toDraw = false;\r\n        return this;\r\n    }\r\n    var _proto = Painter.prototype;\r\n    _proto.beforeDraw = function beforeDraw() {\r\n        var el = this.canvas;\r\n        this.context && this.context.clearRect(0, 0, el.width, el.height);\r\n    };\r\n    _proto.draw = function draw(model) {\r\n        var self = this;\r\n        function drawInner() {\r\n            self.animateHandler = Util.requestAnimationFrame(function () {\r\n                self.animateHandler = undefined;\r\n                if (self.toDraw) {\r\n                    drawInner();\r\n                }\r\n            });\r\n            self.beforeDraw();\r\n            try {\r\n                self._drawGroup(model);\r\n            }\r\n            catch (ev) {\r\n                console.warn('error in draw canvas, detail as:');\r\n                console.warn(ev);\r\n                self.toDraw = false;\r\n            }\r\n            self.toDraw = false;\r\n        }\r\n        if (self.animateHandler) {\r\n            self.toDraw = true;\r\n        }\r\n        else {\r\n            drawInner();\r\n        }\r\n    };\r\n    _proto.drawSync = function drawSync(model) {\r\n        this.beforeDraw();\r\n        this._drawGroup(model);\r\n    };\r\n    _proto._drawGroup = function _drawGroup(group) {\r\n        if (group._cfg.removed || group._cfg.destroyed || !group._cfg.visible) {\r\n            return;\r\n        }\r\n        var self = this;\r\n        var children = group._cfg.children;\r\n        var child = null;\r\n        this.setContext(group);\r\n        for (var i = 0; i < children.length; i++) {\r\n            child = children[i];\r\n            if (children[i].isGroup) {\r\n                self._drawGroup(child);\r\n            }\r\n            else {\r\n                self._drawShape(child);\r\n            }\r\n        }\r\n        this.restoreContext(group);\r\n    };\r\n    _proto._drawShape = function _drawShape(shape) {\r\n        if (shape._cfg.removed || shape._cfg.destroyed || !shape._cfg.visible) {\r\n            return;\r\n        }\r\n        this.setContext(shape);\r\n        shape.drawInner(this.context);\r\n        this.restoreContext(shape);\r\n        shape._cfg.attrs = shape._attrs;\r\n        shape._cfg.hasUpdate = false;\r\n    };\r\n    _proto.setContext = function setContext(shape) {\r\n        var context = this.context;\r\n        var clip = shape._attrs.clip;\r\n        context.save();\r\n        if (clip) {\r\n            clip.resetTransform(context);\r\n            clip.createPath(context);\r\n            context.clip();\r\n        }\r\n        this.resetContext(shape);\r\n        shape.resetTransform(context);\r\n    };\r\n    _proto.restoreContext = function restoreContext() {\r\n        this.context.restore();\r\n    };\r\n    _proto.resetContext = function resetContext(shape) {\r\n        var context = this.context;\r\n        var elAttrs = shape._attrs;\r\n        if (!shape.isGroup) {\r\n            for (var k in elAttrs) {\r\n                if (SHAPE_ATTRS.indexOf(k) > -1) {\r\n                    var v = elAttrs[k];\r\n                    if (k === 'fillStyle') {\r\n                        v = renderUtil.parseStyle(v, shape, context);\r\n                    }\r\n                    if (k === 'strokeStyle') {\r\n                        v = renderUtil.parseStyle(v, shape, context);\r\n                    }\r\n                    if (k === 'lineDash' && context.setLineDash) {\r\n                        if (Util.isArray(v)) {\r\n                            context.setLineDash(v);\r\n                        }\r\n                        else if (Util.isString(v)) {\r\n                            context.setLineDash(v.split(' '));\r\n                        }\r\n                    }\r\n                    else {\r\n                        context[k] = v;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    };\r\n    return Painter;\r\n}();\r\nmodule.exports = Painter;\r\n",{"version":3,"file":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\@antv\\g\\lib\\renderers\\canvas\\painter.js","sourceRoot":"","sources":["D:\\project\\Deecamp-project\\system\\Web\\node_modules\\@antv\\g\\lib\\renderers\\canvas\\painter.js"],"names":[],"mappings":"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","sourcesContent":["var Util = require('../../util');\n\nvar renderUtil = require('./util');\n\nvar SHAPE_ATTRS = ['fillStyle', 'font', 'globalAlpha', 'lineCap', 'lineWidth', 'lineJoin', 'miterLimit', 'shadowBlur', 'shadowColor', 'shadowOffsetX', 'shadowOffsetY', 'strokeStyle', 'textAlign', 'textBaseline', 'lineDash', 'lineDashOffset'];\n\nvar Painter =\n/*#__PURE__*/\nfunction () {\n  function Painter(dom) {\n    if (!dom) {\n      return null;\n    }\n\n    var canvasId = Util.uniqueId('canvas_');\n    var canvasDom = Util.createDom('<canvas id=\"' + canvasId + '\"></canvas>');\n    dom.appendChild(canvasDom);\n    this.type = 'canvas';\n    this.canvas = canvasDom;\n    this.context = canvasDom.getContext('2d');\n    this.toDraw = false;\n    return this;\n  }\n\n  var _proto = Painter.prototype;\n\n  _proto.beforeDraw = function beforeDraw() {\n    var el = this.canvas;\n    this.context && this.context.clearRect(0, 0, el.width, el.height);\n  };\n\n  _proto.draw = function draw(model) {\n    var self = this;\n\n    function drawInner() {\n      self.animateHandler = Util.requestAnimationFrame(function () {\n        self.animateHandler = undefined;\n\n        if (self.toDraw) {\n          drawInner();\n        }\n      });\n      self.beforeDraw();\n\n      try {\n        self._drawGroup(model);\n      } catch (ev) {\n        // 绘制时异常，中断重绘\n        console.warn('error in draw canvas, detail as:');\n        console.warn(ev);\n        self.toDraw = false;\n      }\n\n      self.toDraw = false;\n    }\n\n    if (self.animateHandler) {\n      self.toDraw = true;\n    } else {\n      drawInner();\n    }\n  };\n\n  _proto.drawSync = function drawSync(model) {\n    this.beforeDraw();\n\n    this._drawGroup(model);\n  };\n\n  _proto._drawGroup = function _drawGroup(group) {\n    if (group._cfg.removed || group._cfg.destroyed || !group._cfg.visible) {\n      return;\n    }\n\n    var self = this;\n    var children = group._cfg.children;\n    var child = null;\n    this.setContext(group);\n\n    for (var i = 0; i < children.length; i++) {\n      child = children[i];\n\n      if (children[i].isGroup) {\n        self._drawGroup(child);\n      } else {\n        self._drawShape(child);\n      }\n    }\n\n    this.restoreContext(group);\n  };\n\n  _proto._drawShape = function _drawShape(shape) {\n    if (shape._cfg.removed || shape._cfg.destroyed || !shape._cfg.visible) {\n      return;\n    }\n\n    this.setContext(shape);\n    shape.drawInner(this.context);\n    this.restoreContext(shape);\n    shape._cfg.attrs = shape._attrs;\n    shape._cfg.hasUpdate = false;\n  };\n\n  _proto.setContext = function setContext(shape) {\n    var context = this.context;\n    var clip = shape._attrs.clip;\n    context.save();\n\n    if (clip) {\n      // context.save();\n      clip.resetTransform(context);\n      clip.createPath(context);\n      context.clip(); // context.restore();\n    }\n\n    this.resetContext(shape);\n    shape.resetTransform(context);\n  };\n\n  _proto.restoreContext = function restoreContext() {\n    this.context.restore();\n  };\n\n  _proto.resetContext = function resetContext(shape) {\n    var context = this.context;\n    var elAttrs = shape._attrs; // var canvas = this.get('canvas');\n\n    if (!shape.isGroup) {\n      for (var k in elAttrs) {\n        if (SHAPE_ATTRS.indexOf(k) > -1) {\n          // 非canvas属性不附加\n          var v = elAttrs[k];\n\n          if (k === 'fillStyle') {\n            v = renderUtil.parseStyle(v, shape, context);\n          }\n\n          if (k === 'strokeStyle') {\n            v = renderUtil.parseStyle(v, shape, context);\n          }\n\n          if (k === 'lineDash' && context.setLineDash) {\n            if (Util.isArray(v)) {\n              context.setLineDash(v);\n            } else if (Util.isString(v)) {\n              context.setLineDash(v.split(' '));\n            }\n          } else {\n            context[k] = v;\n          }\n        }\n      }\n    }\n  };\n\n  return Painter;\n}();\n\nmodule.exports = Painter;"]}]}