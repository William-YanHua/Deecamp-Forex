{"remainingRequest":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\ts-loader\\index.js??ref--4-1!D:\\project\\Deecamp-project\\system\\Web\\node_modules\\@antv\\g2\\lib\\geom\\base.js","dependencies":[{"path":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\@antv\\g2\\lib\\geom\\base.js","mtime":499162500000},{"path":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1595520254649},{"path":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\ts-loader\\index.js","mtime":1537906253000}],"contextDependencies":[],"result":["function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }\r\nfunction _assertThisInitialized(self) { if (self === void 0) {\r\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\r\n} return self; }\r\nvar Attr = require('@antv/attr/lib');\r\nvar Adjust = require('@antv/adjust/lib');\r\nvar Base = require('../base');\r\nvar Util = require('../util');\r\nvar Global = require('../global');\r\nvar Labels = require('./label/index');\r\nvar Shape = require('./shape/shape');\r\nvar TooltipMixin = require('./mixin/tooltip');\r\nvar ActiveMixin = require('./mixin/active');\r\nvar SelectMixin = require('./mixin/select');\r\nvar parseFields = require('./util/parse-fields');\r\nvar GROUP_ATTRS = ['color', 'shape', 'size'];\r\nvar FIELD_ORIGIN = '_origin';\r\nfunction parseAdjusts(adjusts) {\r\n    if (Util.isString(adjusts) || Util.isPlainObject(adjusts)) {\r\n        adjusts = [adjusts];\r\n    }\r\n    Util.each(adjusts, function (adjust, index) {\r\n        if (!Util.isObject(adjust)) {\r\n            adjusts[index] = {\r\n                type: adjust\r\n            };\r\n        }\r\n    });\r\n    return adjusts;\r\n}\r\nvar GeomBase = function (_Base) {\r\n    _inheritsLoose(GeomBase, _Base);\r\n    var _proto = GeomBase.prototype;\r\n    _proto.getDefaultCfg = function getDefaultCfg() {\r\n        return {\r\n            _id: null,\r\n            type: 'base',\r\n            coord: null,\r\n            attrs: {},\r\n            view: null,\r\n            data: [],\r\n            scales: {},\r\n            container: null,\r\n            labelContainer: null,\r\n            shapeContainer: null,\r\n            attrOptions: {},\r\n            styleOptions: null,\r\n            selectedOptions: null,\r\n            activedOptions: null,\r\n            hasDefaultAdjust: false,\r\n            adjusts: null,\r\n            shapeType: null,\r\n            generatePoints: false,\r\n            sortable: false,\r\n            labelCfg: null,\r\n            shareTooltip: true,\r\n            tooltipCfg: null,\r\n            animate: true,\r\n            animateCfg: null,\r\n            visible: true\r\n        };\r\n    };\r\n    function GeomBase(cfg) {\r\n        var _this;\r\n        _this = _Base.call(this, cfg) || this;\r\n        _this.viewTheme = _this.get('viewTheme');\r\n        Util.assign(_assertThisInitialized(_assertThisInitialized(_this)), TooltipMixin, ActiveMixin, SelectMixin);\r\n        if (_this.get('container')) {\r\n            _this._initContainer();\r\n        }\r\n        _this._initOptions();\r\n        return _this;\r\n    }\r\n    _proto._initOptions = function _initOptions() {\r\n        var adjusts = this.get('adjusts');\r\n        if (adjusts) {\r\n            adjusts = parseAdjusts(adjusts);\r\n            this.set('adjusts', adjusts);\r\n        }\r\n    };\r\n    _proto._createScale = function _createScale(field, data) {\r\n        var scales = this.get('scales');\r\n        var scale = scales[field];\r\n        if (!scale) {\r\n            scale = this.get('view').createScale(field, data);\r\n            scales[field] = scale;\r\n        }\r\n        return scale;\r\n    };\r\n    _proto._setAttrOptions = function _setAttrOptions(attrName, attrCfg) {\r\n        var options = this.get('attrOptions');\r\n        options[attrName] = attrCfg;\r\n    };\r\n    _proto._createAttrOption = function _createAttrOption(attrName, field, cfg, defaultValues) {\r\n        var attrCfg = {};\r\n        attrCfg.field = field;\r\n        if (cfg) {\r\n            if (Util.isFunction(cfg)) {\r\n                attrCfg.callback = cfg;\r\n            }\r\n            else {\r\n                attrCfg.values = cfg;\r\n            }\r\n        }\r\n        else if (attrName !== 'color') {\r\n            attrCfg.values = defaultValues;\r\n        }\r\n        this._setAttrOptions(attrName, attrCfg);\r\n    };\r\n    _proto.position = function position(field) {\r\n        this._setAttrOptions('position', {\r\n            field: field\r\n        });\r\n        return this;\r\n    };\r\n    _proto.color = function color(field, values) {\r\n        var viewTheme = this.viewTheme || Global;\r\n        this._createAttrOption('color', field, values, viewTheme.colors);\r\n        return this;\r\n    };\r\n    _proto.size = function size(field, values) {\r\n        var viewTheme = this.viewTheme || Global;\r\n        this._createAttrOption('size', field, values, viewTheme.sizes);\r\n        return this;\r\n    };\r\n    _proto.shape = function shape(field, values) {\r\n        var viewTheme = this.viewTheme || Global;\r\n        var type = this.get('type');\r\n        var shapes = viewTheme.shapes[type] || [];\r\n        this._createAttrOption('shape', field, values, shapes);\r\n        return this;\r\n    };\r\n    _proto.opacity = function opacity(field, values) {\r\n        var viewTheme = this.viewTheme || Global;\r\n        this._createAttrOption('opacity', field, values, viewTheme.opacities);\r\n        return this;\r\n    };\r\n    _proto.style = function style(field, cfg) {\r\n        var styleOptions = this.get('styleOptions');\r\n        if (!styleOptions) {\r\n            styleOptions = {};\r\n            this.set('styleOptions', styleOptions);\r\n        }\r\n        if (Util.isObject(field)) {\r\n            cfg = field;\r\n            field = null;\r\n        }\r\n        var fields;\r\n        if (field) {\r\n            fields = parseFields(field);\r\n        }\r\n        styleOptions.fields = fields;\r\n        styleOptions.style = cfg;\r\n        return this;\r\n    };\r\n    _proto.label = function label(field, callback, cfg) {\r\n        var self = this;\r\n        var labelCfg = self.get('labelCfg');\r\n        if (!labelCfg) {\r\n            labelCfg = {};\r\n            self.set('labelCfg', labelCfg);\r\n        }\r\n        var fields;\r\n        if (field) {\r\n            fields = parseFields(field);\r\n        }\r\n        labelCfg.fields = fields;\r\n        if (Util.isFunction(callback)) {\r\n            if (!cfg) {\r\n                cfg = {};\r\n            }\r\n            labelCfg.callback = callback;\r\n        }\r\n        else if (Util.isObject(callback)) {\r\n            cfg = callback;\r\n        }\r\n        labelCfg.globalCfg = cfg;\r\n        return this;\r\n    };\r\n    _proto.tooltip = function tooltip(field, cfg) {\r\n        var tooltipCfg = this.get('tooltipCfg');\r\n        if (!tooltipCfg) {\r\n            tooltipCfg = {};\r\n        }\r\n        if (field === false) {\r\n            this.set('tooltipCfg', false);\r\n        }\r\n        else {\r\n            var tooltipFields;\r\n            if (field) {\r\n                tooltipFields = parseFields(field);\r\n            }\r\n            tooltipCfg.fields = tooltipFields;\r\n            tooltipCfg.cfg = cfg;\r\n        }\r\n        this.set('tooltipCfg', tooltipCfg);\r\n        return this;\r\n    };\r\n    _proto.animate = function animate(cfg) {\r\n        this.set('animateCfg', cfg);\r\n        return this;\r\n    };\r\n    _proto.active = function active(enable, cfg) {\r\n        if (enable === false) {\r\n            this.set('allowActive', false);\r\n        }\r\n        else if (Util.isObject(enable)) {\r\n            this.set('allowActive', true);\r\n            this.set('activedOptions', enable);\r\n        }\r\n        else {\r\n            this.set('allowActive', true);\r\n            this.set('activedOptions', cfg);\r\n        }\r\n        return this;\r\n    };\r\n    _proto.adjust = function adjust(adjusts) {\r\n        if (!this.get('hasDefaultAdjust')) {\r\n            if (adjusts) {\r\n                adjusts = parseAdjusts(adjusts);\r\n            }\r\n            this.set('adjusts', adjusts);\r\n        }\r\n        return this;\r\n    };\r\n    _proto.select = function select(enable, cfg) {\r\n        if (enable === false) {\r\n            this.set('allowSelect', false);\r\n        }\r\n        else if (Util.isObject(enable)) {\r\n            this.set('allowSelect', true);\r\n            this.set('selectedOptions', enable);\r\n        }\r\n        else {\r\n            this.set('allowSelect', true);\r\n            this.set('selectedOptions', cfg);\r\n        }\r\n        return this;\r\n    };\r\n    _proto.hasAdjust = function hasAdjust(adjustType) {\r\n        var self = this;\r\n        var adjusts = self.get('adjusts');\r\n        if (!adjustType) {\r\n            return false;\r\n        }\r\n        var rst = false;\r\n        Util.each(adjusts, function (adjust) {\r\n            if (adjust.type === adjustType) {\r\n                rst = true;\r\n                return false;\r\n            }\r\n        });\r\n        return rst;\r\n    };\r\n    _proto.hasStack = function hasStack() {\r\n        var isStacked = this.get('isStacked');\r\n        if (Util.isNil(isStacked)) {\r\n            isStacked = this.hasAdjust('stack');\r\n            this.set('isStacked', isStacked);\r\n        }\r\n        return isStacked;\r\n    };\r\n    _proto.isInCircle = function isInCircle() {\r\n        var coord = this.get('coord');\r\n        return coord && coord.isPolar;\r\n    };\r\n    _proto._initContainer = function _initContainer() {\r\n        var self = this;\r\n        var shapeContainer = self.get('shapeContainer');\r\n        if (!shapeContainer) {\r\n            var container = self.get('container');\r\n            var view = self.get('view');\r\n            var viewId = view && view.get('_id');\r\n            shapeContainer = container.addGroup({\r\n                viewId: viewId,\r\n                visible: self.get('visible')\r\n            });\r\n            self.set('shapeContainer', shapeContainer);\r\n        }\r\n    };\r\n    _proto.init = function init() {\r\n        var self = this;\r\n        self._initContainer();\r\n        self._initAttrs();\r\n        if (self.get('tooltipCfg') && self.get('tooltipCfg').fields) {\r\n            var tooltipFields = self.get('tooltipCfg').fields;\r\n            Util.each(tooltipFields, function (field) {\r\n                self._createScale(field);\r\n            });\r\n        }\r\n        var dataArray = self._processData();\r\n        if (self.get('adjusts')) {\r\n            self._adjust(dataArray);\r\n        }\r\n        self.set('dataArray', dataArray);\r\n    };\r\n    _proto._initAttrs = function _initAttrs() {\r\n        var self = this;\r\n        var attrs = self.get('attrs');\r\n        var attrOptions = self.get('attrOptions');\r\n        var coord = self.get('coord');\r\n        var viewTheme = self.viewTheme || Global;\r\n        var isPie = false;\r\n        for (var type in attrOptions) {\r\n            if (attrOptions.hasOwnProperty(type)) {\r\n                var option = attrOptions[type];\r\n                var className = Util.upperFirst(type);\r\n                var fields = parseFields(option.field);\r\n                if (type === 'position') {\r\n                    option.coord = coord;\r\n                    if (fields.length === 1 && coord.type === 'theta') {\r\n                        fields.unshift('1');\r\n                        isPie = true;\r\n                    }\r\n                }\r\n                var scales = [];\r\n                for (var i = 0; i < fields.length; i++) {\r\n                    var field = fields[i];\r\n                    var scale = self._createScale(field);\r\n                    if (type === 'color' && Util.isNil(option.values)) {\r\n                        if (scale.values.length <= 8) {\r\n                            option.values = isPie ? viewTheme.colors_pie : viewTheme.colors;\r\n                        }\r\n                        else if (scale.values.length <= 16) {\r\n                            option.values = isPie ? viewTheme.colors_pie_16 : viewTheme.colors_16;\r\n                        }\r\n                        else {\r\n                            option.values = viewTheme.colors_24;\r\n                        }\r\n                        if (Util.isNil(option.values)) {\r\n                            option.values = viewTheme.colors;\r\n                        }\r\n                    }\r\n                    scales.push(scale);\r\n                }\r\n                if (coord.type === 'theta' && type === 'position' && scales.length > 1) {\r\n                    var yScale = scales[1];\r\n                    yScale.change({\r\n                        nice: false,\r\n                        min: 0,\r\n                        max: Math.max.apply(null, yScale.values)\r\n                    });\r\n                }\r\n                option.scales = scales;\r\n                var attr = new Attr[className](option);\r\n                attrs[type] = attr;\r\n            }\r\n        }\r\n    };\r\n    _proto._processData = function _processData() {\r\n        var self = this;\r\n        var data = this.get('data');\r\n        var dataArray = [];\r\n        var groupedArray = this._groupData(data);\r\n        for (var i = 0; i < groupedArray.length; i++) {\r\n            var subData = groupedArray[i];\r\n            var tempData = self._saveOrigin(subData);\r\n            self._numberic(tempData);\r\n            dataArray.push(tempData);\r\n        }\r\n        return dataArray;\r\n    };\r\n    _proto._groupData = function _groupData(data) {\r\n        var groupScales = this._getGroupScales();\r\n        var fields = groupScales.map(function (scale) {\r\n            return scale.field;\r\n        });\r\n        return Util.Array.group(data, fields);\r\n    };\r\n    _proto._saveOrigin = function _saveOrigin(data) {\r\n        var rst = [];\r\n        for (var i = 0; i < data.length; i++) {\r\n            var origin = data[i];\r\n            var obj = {};\r\n            for (var k in origin) {\r\n                obj[k] = origin[k];\r\n            }\r\n            obj[FIELD_ORIGIN] = origin;\r\n            rst.push(obj);\r\n        }\r\n        return rst;\r\n    };\r\n    _proto._numberic = function _numberic(data) {\r\n        var positionAttr = this.getAttr('position');\r\n        var scales = positionAttr.scales;\r\n        for (var j = 0; j < data.length; j++) {\r\n            var obj = data[j];\r\n            for (var i = 0; i < Math.min(2, scales.length); i++) {\r\n                var scale = scales[i];\r\n                if (scale.isCategory) {\r\n                    var field = scale.field;\r\n                    obj[field] = scale.translate(obj[field]);\r\n                }\r\n            }\r\n        }\r\n    };\r\n    _proto._getGroupScales = function _getGroupScales() {\r\n        var self = this;\r\n        var scales = self.get('groupScales');\r\n        if (!scales) {\r\n            scales = [];\r\n            var attrs = self.get('attrs');\r\n            Util.each(attrs, function (attr) {\r\n                if (GROUP_ATTRS.indexOf(attr.type) !== -1) {\r\n                    var attrScales = attr.scales;\r\n                    Util.each(attrScales, function (scale) {\r\n                        if (scale.isCategory && Util.indexOf(scales, scale) === -1) {\r\n                            scales.push(scale);\r\n                        }\r\n                    });\r\n                }\r\n            });\r\n            self.set('groupScales', scales);\r\n        }\r\n        return scales;\r\n    };\r\n    _proto._updateStackRange = function _updateStackRange(field, scale, dataArray) {\r\n        var mergeArray = Util.Array.merge(dataArray);\r\n        var min = scale.min;\r\n        var max = scale.max;\r\n        for (var i = 0; i < mergeArray.length; i++) {\r\n            var obj = mergeArray[i];\r\n            var tmpMin = Math.min.apply(null, obj[field]);\r\n            var tmpMax = Math.max.apply(null, obj[field]);\r\n            if (tmpMin < min) {\r\n                min = tmpMin;\r\n            }\r\n            if (tmpMax > max) {\r\n                max = tmpMax;\r\n            }\r\n        }\r\n        if (min < scale.min || max > scale.max) {\r\n            scale.change({\r\n                min: min,\r\n                max: max\r\n            });\r\n        }\r\n    };\r\n    _proto._adjust = function _adjust(dataArray) {\r\n        var self = this;\r\n        var adjusts = self.get('adjusts');\r\n        var viewTheme = this.viewTheme || Global;\r\n        var yScale = self.getYScale();\r\n        var xScale = self.getXScale();\r\n        var xField = xScale.field;\r\n        var yField = yScale ? yScale.field : null;\r\n        Util.each(adjusts, function (adjust) {\r\n            var adjustCfg = Util.mix({\r\n                xField: xField,\r\n                yField: yField\r\n            }, adjust);\r\n            var adjustType = Util.upperFirst(adjust.type);\r\n            if (adjustType === 'Dodge') {\r\n                var adjustNames = [];\r\n                if (xScale.isCategory || xScale.isIdentity) {\r\n                    adjustNames.push('x');\r\n                }\r\n                else if (!yScale) {\r\n                    adjustNames.push('y');\r\n                }\r\n                else {\r\n                    throw new Error('dodge is not support linear attribute, please use category attribute!');\r\n                }\r\n                adjustCfg.adjustNames = adjustNames;\r\n                adjustCfg.dodgeRatio = viewTheme.widthRatio.column;\r\n            }\r\n            else if (adjustType === 'Stack') {\r\n                var coord = self.get('coord');\r\n                if (!yScale) {\r\n                    adjustCfg.height = coord.getHeight();\r\n                    var size = self.getDefaultValue('size') || 3;\r\n                    adjustCfg.size = size;\r\n                }\r\n                if (!coord.isTransposed && Util.isNil(adjustCfg.reverseOrder)) {\r\n                    adjustCfg.reverseOrder = true;\r\n                }\r\n            }\r\n            var adjustElement = new Adjust[adjustType](adjustCfg);\r\n            adjustElement.processAdjust(dataArray);\r\n            if (adjustType === 'Stack' && yScale) {\r\n                self._updateStackRange(yField, yScale, dataArray);\r\n            }\r\n        });\r\n    };\r\n    _proto.setCoord = function setCoord(coord) {\r\n        this.set('coord', coord);\r\n        var position = this.getAttr('position');\r\n        var shapeContainer = this.get('shapeContainer');\r\n        shapeContainer.setMatrix(coord.matrix);\r\n        if (position) {\r\n            position.coord = coord;\r\n        }\r\n    };\r\n    _proto.paint = function paint() {\r\n        var self = this;\r\n        var dataArray = self.get('dataArray');\r\n        var mappedArray = [];\r\n        var shapeFactory = self.getShapeFactory();\r\n        shapeFactory.setCoord(self.get('coord'));\r\n        var shapeContainer = self.get('shapeContainer');\r\n        self._beforeMapping(dataArray);\r\n        for (var i = 0; i < dataArray.length; i++) {\r\n            var data = dataArray[i];\r\n            var index = i;\r\n            data = self._mapping(data);\r\n            mappedArray.push(data);\r\n            self.draw(data, shapeContainer, shapeFactory, index);\r\n        }\r\n        if (self.get('labelCfg')) {\r\n            self._addLabels(Util.union.apply(null, mappedArray), shapeContainer.get('children'));\r\n        }\r\n        if (!self.get('sortable')) {\r\n            self._sort(mappedArray);\r\n        }\r\n        else {\r\n            self.set('dataArray', mappedArray);\r\n        }\r\n    };\r\n    _proto._sort = function _sort(mappedArray) {\r\n        var self = this;\r\n        var xScale = self.getXScale();\r\n        var xField = xScale.field;\r\n        Util.each(mappedArray, function (itemArr) {\r\n            itemArr.sort(function (obj1, obj2) {\r\n                return xScale.translate(obj1[FIELD_ORIGIN][xField]) - xScale.translate(obj2[FIELD_ORIGIN][xField]);\r\n            });\r\n        });\r\n        self.set('dataArray', mappedArray);\r\n    };\r\n    _proto._beforeMapping = function _beforeMapping(dataArray) {\r\n        var self = this;\r\n        if (self.get('sortable')) {\r\n            var xScale = self.getXScale();\r\n            var field = xScale.field;\r\n            Util.each(dataArray, function (data) {\r\n                data.sort(function (v1, v2) {\r\n                    return xScale.translate(v1[field]) - xScale.translate(v2[field]);\r\n                });\r\n            });\r\n        }\r\n        if (self.get('generatePoints')) {\r\n            Util.each(dataArray, function (data) {\r\n                self._generatePoints(data);\r\n            });\r\n            Util.each(dataArray, function (data, index) {\r\n                var nextData = dataArray[index + 1];\r\n                if (nextData) {\r\n                    data[0].nextPoints = nextData[0].points;\r\n                }\r\n            });\r\n        }\r\n    };\r\n    _proto._addLabels = function _addLabels(points, shapes) {\r\n        var self = this;\r\n        var type = self.get('type');\r\n        var viewTheme = self.get('viewTheme') || Global;\r\n        var coord = self.get('coord');\r\n        var C = Labels.getLabelsClass(coord.type, type);\r\n        var container = self.get('container');\r\n        var scales = Util.map(self.get('labelCfg').fields, function (field) {\r\n            return self._createScale(field);\r\n        });\r\n        var labelContainer = container.addGroup(C, {\r\n            _id: this.get('_id'),\r\n            labelCfg: Util.mix({\r\n                scales: scales\r\n            }, self.get('labelCfg')),\r\n            coord: coord,\r\n            geom: self,\r\n            geomType: type,\r\n            viewTheme: viewTheme,\r\n            visible: self.get('visible')\r\n        });\r\n        labelContainer.showLabels(points, shapes);\r\n        self.set('labelContainer', labelContainer);\r\n    };\r\n    _proto.getShapeFactory = function getShapeFactory() {\r\n        var shapeFactory = this.get('shapeFactory');\r\n        if (!shapeFactory) {\r\n            var shapeType = this.get('shapeType');\r\n            shapeFactory = Shape.getShapeFactory(shapeType);\r\n            this.set('shapeFactory', shapeFactory);\r\n        }\r\n        return shapeFactory;\r\n    };\r\n    _proto._generatePoints = function _generatePoints(data) {\r\n        var self = this;\r\n        var shapeFactory = self.getShapeFactory();\r\n        var shapeAttr = self.getAttr('shape');\r\n        for (var i = 0; i < data.length; i++) {\r\n            var obj = data[i];\r\n            var cfg = self.createShapePointsCfg(obj);\r\n            var shape = shapeAttr ? self._getAttrValues(shapeAttr, obj) : null;\r\n            var points = shapeFactory.getShapePoints(shape, cfg);\r\n            obj.points = points;\r\n        }\r\n    };\r\n    _proto.createShapePointsCfg = function createShapePointsCfg(obj) {\r\n        var xScale = this.getXScale();\r\n        var yScale = this.getYScale();\r\n        var x = this._normalizeValues(obj[xScale.field], xScale);\r\n        var y;\r\n        if (yScale) {\r\n            y = this._normalizeValues(obj[yScale.field], yScale);\r\n        }\r\n        else {\r\n            y = obj.y ? obj.y : 0.1;\r\n        }\r\n        return {\r\n            x: x,\r\n            y: y,\r\n            y0: yScale ? yScale.scale(this.getYMinValue()) : undefined\r\n        };\r\n    };\r\n    _proto.getYMinValue = function getYMinValue() {\r\n        var yScale = this.getYScale();\r\n        var min = yScale.min, max = yScale.max;\r\n        var value;\r\n        if (min >= 0) {\r\n            value = min;\r\n        }\r\n        else if (max <= 0) {\r\n            value = max;\r\n        }\r\n        else {\r\n            value = 0;\r\n        }\r\n        return value;\r\n    };\r\n    _proto._normalizeValues = function _normalizeValues(values, scale) {\r\n        var rst = [];\r\n        if (Util.isArray(values)) {\r\n            for (var i = 0; i < values.length; i++) {\r\n                var v = values[i];\r\n                rst.push(scale.scale(v));\r\n            }\r\n        }\r\n        else {\r\n            rst = scale.scale(values);\r\n        }\r\n        return rst;\r\n    };\r\n    _proto._mapping = function _mapping(data) {\r\n        var self = this;\r\n        var attrs = self.get('attrs');\r\n        var mappedData = [];\r\n        for (var i = 0; i < data.length; i++) {\r\n            var record = data[i];\r\n            var newRecord = {};\r\n            newRecord[FIELD_ORIGIN] = record[FIELD_ORIGIN];\r\n            newRecord.points = record.points;\r\n            newRecord.nextPoints = record.nextPoints;\r\n            for (var k in attrs) {\r\n                if (attrs.hasOwnProperty(k)) {\r\n                    var attr = attrs[k];\r\n                    var names = attr.names;\r\n                    var values = self._getAttrValues(attr, record);\r\n                    if (names.length > 1) {\r\n                        for (var j = 0; j < values.length; j++) {\r\n                            var val = values[j];\r\n                            var name = names[j];\r\n                            newRecord[name] = Util.isArray(val) && val.length === 1 ? val[0] : val;\r\n                        }\r\n                    }\r\n                    else {\r\n                        newRecord[names[0]] = values.length === 1 ? values[0] : values;\r\n                    }\r\n                }\r\n            }\r\n            mappedData.push(newRecord);\r\n        }\r\n        return mappedData;\r\n    };\r\n    _proto._getAttrValues = function _getAttrValues(attr, record) {\r\n        var scales = attr.scales;\r\n        var params = [];\r\n        for (var i = 0; i < scales.length; i++) {\r\n            var scale = scales[i];\r\n            var field = scale.field;\r\n            if (scale.type === 'identity') {\r\n                params.push(scale.value);\r\n            }\r\n            else {\r\n                params.push(record[field]);\r\n            }\r\n        }\r\n        var values = attr.mapping.apply(attr, params);\r\n        return values;\r\n    };\r\n    _proto.getAttrValue = function getAttrValue(attrName, record) {\r\n        var attr = this.getAttr(attrName);\r\n        var rst = null;\r\n        if (attr) {\r\n            var values = this._getAttrValues(attr, record);\r\n            rst = values[0];\r\n        }\r\n        return rst;\r\n    };\r\n    _proto.getDefaultValue = function getDefaultValue(attrName) {\r\n        var value = this.get(attrName);\r\n        var attr = this.getAttr(attrName);\r\n        if (attr) {\r\n            var scale = attr.getScale(attrName);\r\n            if (scale.type === 'identity') {\r\n                value = scale.value;\r\n            }\r\n        }\r\n        return value;\r\n    };\r\n    _proto.draw = function draw(data, container, shapeFactory, index) {\r\n        var self = this;\r\n        for (var i = 0; i < data.length; i++) {\r\n            var obj = data[i];\r\n            self.drawPoint(obj, container, shapeFactory, index + i);\r\n        }\r\n    };\r\n    _proto.getCallbackCfg = function getCallbackCfg(fields, cfg, origin) {\r\n        if (!fields) {\r\n            return cfg;\r\n        }\r\n        var tmpCfg = {};\r\n        var params = fields.map(function (field) {\r\n            return origin[field];\r\n        });\r\n        Util.each(cfg, function (v, k) {\r\n            if (Util.isFunction(v)) {\r\n                tmpCfg[k] = v.apply(null, params);\r\n            }\r\n            else {\r\n                tmpCfg[k] = v;\r\n            }\r\n        });\r\n        return tmpCfg;\r\n    };\r\n    _proto._getShapeId = function _getShapeId(dataObj) {\r\n        var id = this.get('_id');\r\n        var keyFields = this.get('keyFields');\r\n        if (keyFields && keyFields.length > 0) {\r\n            Util.each(keyFields, function (key) {\r\n                id += '-' + dataObj[key];\r\n            });\r\n        }\r\n        else {\r\n            var type = this.get('type');\r\n            var xScale = this.getXScale();\r\n            var yScale = this.getYScale();\r\n            var xField = xScale.field || 'x';\r\n            var yField = yScale.field || 'y';\r\n            var yVal = dataObj[yField];\r\n            var xVal;\r\n            if (xScale.isIdentity) {\r\n                xVal = xScale.value;\r\n            }\r\n            else {\r\n                xVal = dataObj[xField];\r\n            }\r\n            if (type === 'interval' || type === 'schema') {\r\n                id += '-' + xVal;\r\n            }\r\n            else if (type === 'line' || type === 'area' || type === 'path') {\r\n                id += '-' + type;\r\n            }\r\n            else {\r\n                id += '-' + xVal + '-' + yVal;\r\n            }\r\n            var groupScales = this._getGroupScales();\r\n            if (!Util.isEmpty(groupScales)) {\r\n                Util.each(groupScales, function (groupScale) {\r\n                    var field = groupScale.field;\r\n                    if (groupScale.type !== 'identity') {\r\n                        id += '-' + dataObj[field];\r\n                    }\r\n                });\r\n            }\r\n        }\r\n        return id;\r\n    };\r\n    _proto.getDrawCfg = function getDrawCfg(obj) {\r\n        var self = this;\r\n        var cfg = {\r\n            origin: obj,\r\n            x: obj.x,\r\n            y: obj.y,\r\n            color: obj.color,\r\n            size: obj.size,\r\n            shape: obj.shape,\r\n            isInCircle: self.isInCircle(),\r\n            opacity: obj.opacity\r\n        };\r\n        var styleOptions = self.get('styleOptions');\r\n        if (styleOptions && styleOptions.style) {\r\n            cfg.style = self.getCallbackCfg(styleOptions.fields, styleOptions.style, obj[FIELD_ORIGIN]);\r\n        }\r\n        if (this.get('generatePoints')) {\r\n            cfg.points = obj.points;\r\n            cfg.nextPoints = obj.nextPoints;\r\n        }\r\n        if (this.get('animate')) {\r\n            cfg._id = self._getShapeId(obj[FIELD_ORIGIN]);\r\n        }\r\n        return cfg;\r\n    };\r\n    _proto.appendShapeInfo = function appendShapeInfo(shape, index) {\r\n        if (shape) {\r\n            shape.setSilent('index', index);\r\n            shape.setSilent('coord', this.get('coord'));\r\n            if (this.get('animate') && this.get('animateCfg')) {\r\n                shape.setSilent('animateCfg', this.get('animateCfg'));\r\n            }\r\n        }\r\n    };\r\n    _proto.drawPoint = function drawPoint(obj, container, shapeFactory, index) {\r\n        var shape = obj.shape;\r\n        var cfg = this.getDrawCfg(obj);\r\n        var geomShape = shapeFactory.drawShape(shape, cfg, container);\r\n        this.appendShapeInfo(geomShape, index);\r\n    };\r\n    _proto.getAttr = function getAttr(name) {\r\n        return this.get('attrs')[name];\r\n    };\r\n    _proto.getXScale = function getXScale() {\r\n        return this.getAttr('position').scales[0];\r\n    };\r\n    _proto.getYScale = function getYScale() {\r\n        return this.getAttr('position').scales[1];\r\n    };\r\n    _proto.getShapes = function getShapes() {\r\n        var result = [];\r\n        var shapeContainer = this.get('shapeContainer');\r\n        var children = shapeContainer.get('children');\r\n        Util.each(children, function (child) {\r\n            if (child.get('origin')) {\r\n                result.push(child);\r\n            }\r\n        });\r\n        return result;\r\n    };\r\n    _proto.getAttrsForLegend = function getAttrsForLegend() {\r\n        var attrs = this.get('attrs');\r\n        var rst = [];\r\n        Util.each(attrs, function (attr) {\r\n            if (GROUP_ATTRS.indexOf(attr.type) !== -1) {\r\n                rst.push(attr);\r\n            }\r\n        });\r\n        return rst;\r\n    };\r\n    _proto.getFieldsForLegend = function getFieldsForLegend() {\r\n        var fields = [];\r\n        var attrOptions = this.get('attrOptions');\r\n        Util.each(GROUP_ATTRS, function (attrName) {\r\n            var attrCfg = attrOptions[attrName];\r\n            if (attrCfg && attrCfg.field && Util.isString(attrCfg.field)) {\r\n                fields = fields.concat(attrCfg.field.split('*'));\r\n            }\r\n        });\r\n        return Util.uniq(fields);\r\n    };\r\n    _proto.changeVisible = function changeVisible(visible, stopDraw) {\r\n        var me = this;\r\n        me.set('visible', visible);\r\n        var shapeContainer = this.get('shapeContainer');\r\n        if (shapeContainer) {\r\n            shapeContainer.set('visible', visible);\r\n        }\r\n        var labelContainer = this.get('labelContainer');\r\n        if (labelContainer) {\r\n            labelContainer.set('visible', visible);\r\n        }\r\n        if (!stopDraw && shapeContainer) {\r\n            var canvas = shapeContainer.get('canvas');\r\n            canvas.draw();\r\n        }\r\n    };\r\n    _proto.reset = function reset() {\r\n        this.set('attrOptions', {});\r\n        this.clearInner();\r\n    };\r\n    _proto.clearInner = function clearInner() {\r\n        this.clearActivedShapes();\r\n        this.clearSelected();\r\n        var shapeContainer = this.get('shapeContainer');\r\n        shapeContainer && shapeContainer.clear();\r\n        var labelContainer = this.get('labelContainer');\r\n        labelContainer && labelContainer.remove();\r\n        this.set('attrs', {});\r\n        this.set('groupScales', null);\r\n        this.set('labelContainer', null);\r\n        this.set('xDistance', null);\r\n        this.set('isStacked', null);\r\n    };\r\n    _proto.clear = function clear() {\r\n        this.clearInner();\r\n        this.set('scales', {});\r\n    };\r\n    _proto.destroy = function destroy() {\r\n        this.clear();\r\n        var shapeContainer = this.get('shapeContainer');\r\n        shapeContainer && shapeContainer.remove();\r\n        this.offEvents();\r\n        _Base.prototype.destroy.call(this);\r\n    };\r\n    _proto.bindEvents = function bindEvents() {\r\n        if (this.get('view')) {\r\n            this._bindActiveAction();\r\n            this._bindSelectedAction();\r\n        }\r\n    };\r\n    _proto.offEvents = function offEvents() {\r\n        if (this.get('view')) {\r\n            this._offActiveAction();\r\n            this._offSelectedAction();\r\n        }\r\n    };\r\n    return GeomBase;\r\n}(Base);\r\nmodule.exports = GeomBase;\r\n",{"version":3,"file":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\@antv\\g2\\lib\\geom\\base.js","sourceRoot":"","sources":["D:\\project\\Deecamp-project\\system\\Web\\node_modules\\@antv\\g2\\lib\\geom\\base.js"],"names":[],"mappings":"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","sourcesContent":["function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\n/**\n * @fileOverview 所有 Geometry 的基类\n * @author dxq613@gmail.com\n */\nvar Attr = require('@antv/attr/lib');\n\nvar Adjust = require('@antv/adjust/lib');\n\nvar Base = require('../base');\n\nvar Util = require('../util');\n\nvar Global = require('../global');\n\nvar Labels = require('./label/index');\n\nvar Shape = require('./shape/shape');\n\nvar TooltipMixin = require('./mixin/tooltip');\n\nvar ActiveMixin = require('./mixin/active');\n\nvar SelectMixin = require('./mixin/select');\n\nvar parseFields = require('./util/parse-fields');\n\nvar GROUP_ATTRS = ['color', 'shape', 'size'];\nvar FIELD_ORIGIN = '_origin'; // 转换成对象的数组 [{type: 'adjust'}]\n\nfunction parseAdjusts(adjusts) {\n  // 如果是字符串或者对象转换成数组\n  if (Util.isString(adjusts) || Util.isPlainObject(adjusts)) {\n    adjusts = [adjusts];\n  }\n\n  Util.each(adjusts, function (adjust, index) {\n    if (!Util.isObject(adjust)) {\n      adjusts[index] = {\n        type: adjust\n      };\n    }\n  });\n  return adjusts;\n}\n/**\n * 几何标记\n * @class Geom\n */\n\n\nvar GeomBase =\n/*#__PURE__*/\nfunction (_Base) {\n  _inheritsLoose(GeomBase, _Base);\n\n  var _proto = GeomBase.prototype;\n\n  /**\n   * 获取默认的配置属性\n   * @protected\n   * @return {Object} 默认属性\n   */\n  _proto.getDefaultCfg = function getDefaultCfg() {\n    return {\n      /**\n       * 标记 _id 用于区分执行动画\n       * @type {String}\n       */\n      _id: null,\n\n      /**\n       * 类型\n       * @type {String}\n       */\n      type: 'base',\n\n      /**\n       * 坐标系\n       * @type {Object}\n       */\n      coord: null,\n\n      /**\n       * 属性映射集\n       * @protected\n       * @type {Object}\n       */\n      attrs: {},\n\n      /**\n       * 所属的View\n       * @type {View}\n       */\n      view: null,\n\n      /**\n       * 几何标记显示的数据\n       * @type {Array}\n       */\n      data: [],\n\n      /**\n       * 相关的度量\n       * @type {Object}\n       */\n      scales: {},\n\n      /**\n       * 绘图容器\n       * @type {Object}\n       */\n      container: null,\n\n      /**\n       * 文本容器\n       * @type {Object}\n       */\n      labelContainer: null,\n\n      /**\n       * 图形容器\n       * @type {Object}\n       */\n      shapeContainer: null,\n\n      /**\n       * 几何标记的一些配置项，用于延迟生成图表\n       * @type {Object}\n       */\n      attrOptions: {},\n      // 样式配置项\n      styleOptions: null,\n      // 选中时的配置项\n      selectedOptions: null,\n      // active 时的配置项\n      activedOptions: null,\n\n      /**\n       * 某些类存在默认的adjust，不能更改 adjust\n       * @type {Boolean}\n       */\n      hasDefaultAdjust: false,\n      // 数据调整类型\n      adjusts: null,\n\n      /**\n       * 使用形状的类型\n       * @protected\n       * @type {String}\n       */\n      shapeType: null,\n\n      /**\n       * 是否生成多个点来绘制图形\n       * @protected\n       * @type {Boolean}\n       */\n      generatePoints: false,\n\n      /**\n       * 数据是否进行排序\n       * @type {Boolean}\n       */\n      sortable: false,\n      labelCfg: null,\n\n      /**\n       * 是否共享 tooltip\n       * @type {Boolean}\n       */\n      shareTooltip: true,\n      tooltipCfg: null,\n\n      /**\n       * 是否执行动画，默认执行\n       * @type {Boolean}\n       */\n      animate: true,\n\n      /**\n       * 动画配置\n       * @type {[type]}\n       */\n      animateCfg: null,\n      visible: true\n    };\n  };\n\n  function GeomBase(cfg) {\n    var _this;\n\n    _this = _Base.call(this, cfg) || this;\n    _this.viewTheme = _this.get('viewTheme');\n    Util.assign(_assertThisInitialized(_assertThisInitialized(_this)), TooltipMixin, ActiveMixin, SelectMixin);\n\n    if (_this.get('container')) {\n      _this._initContainer();\n    }\n\n    _this._initOptions();\n\n    return _this;\n  } // 初始化时对配置项的格式化\n\n\n  _proto._initOptions = function _initOptions() {\n    var adjusts = this.get('adjusts');\n\n    if (adjusts) {\n      adjusts = parseAdjusts(adjusts);\n      this.set('adjusts', adjusts);\n    }\n  };\n\n  _proto._createScale = function _createScale(field, data) {\n    var scales = this.get('scales');\n    var scale = scales[field];\n\n    if (!scale) {\n      scale = this.get('view').createScale(field, data);\n      scales[field] = scale;\n    }\n\n    return scale;\n  };\n\n  _proto._setAttrOptions = function _setAttrOptions(attrName, attrCfg) {\n    var options = this.get('attrOptions');\n    options[attrName] = attrCfg;\n  };\n\n  _proto._createAttrOption = function _createAttrOption(attrName, field, cfg, defaultValues) {\n    var attrCfg = {};\n    attrCfg.field = field;\n\n    if (cfg) {\n      if (Util.isFunction(cfg)) {\n        attrCfg.callback = cfg;\n      } else {\n        attrCfg.values = cfg;\n      }\n    } else if (attrName !== 'color') {\n      attrCfg.values = defaultValues;\n    }\n\n    this._setAttrOptions(attrName, attrCfg);\n  };\n  /**\n   * 位置属性映射\n   * @chainable\n   * @param  {String} field 字段名\n   * @return {Geom} geom 当前几何标记\n   */\n\n\n  _proto.position = function position(field) {\n    this._setAttrOptions('position', {\n      field: field\n    });\n\n    return this;\n  };\n  /**\n   * 颜色属性映射\n   * @chainable\n   * @param  {String} field 字段名\n   * @param  {Array|Function} values 颜色的数组或者回调函数\n   * @return {Geom} geom 当前几何标记\n   */\n\n\n  _proto.color = function color(field, values) {\n    var viewTheme = this.viewTheme || Global;\n\n    this._createAttrOption('color', field, values, viewTheme.colors);\n\n    return this;\n  };\n  /**\n   * 大小属性映射\n   * @chainable\n   * @param  {String} field 字段名\n   * @param  {Array|Function} values 大小的数组或者回调函数\n   * @return {Geom} geom 当前几何标记\n   */\n\n\n  _proto.size = function size(field, values) {\n    var viewTheme = this.viewTheme || Global;\n\n    this._createAttrOption('size', field, values, viewTheme.sizes);\n\n    return this;\n  };\n  /**\n   * 形状属性映射\n   * @chainable\n   * @param  {String} field 字段名\n   * @param  {Array|Function} values 大小的数组或者回调函数\n   * @return {Geom} geom 当前几何标记\n   */\n\n\n  _proto.shape = function shape(field, values) {\n    var viewTheme = this.viewTheme || Global;\n    var type = this.get('type');\n    var shapes = viewTheme.shapes[type] || [];\n\n    this._createAttrOption('shape', field, values, shapes);\n\n    return this;\n  };\n  /**\n   * 透明度属性映射\n   * @chainable\n   * @param  {String} field 字段名\n   * @param  {Array|Function} values 透明度的数组或者回调函数\n   * @return {Geom} geom 当前几何标记\n   */\n\n\n  _proto.opacity = function opacity(field, values) {\n    var viewTheme = this.viewTheme || Global;\n\n    this._createAttrOption('opacity', field, values, viewTheme.opacities);\n\n    return this;\n  };\n\n  _proto.style = function style(field, cfg) {\n    var styleOptions = this.get('styleOptions');\n\n    if (!styleOptions) {\n      styleOptions = {};\n      this.set('styleOptions', styleOptions);\n    }\n\n    if (Util.isObject(field)) {\n      cfg = field;\n      field = null;\n    }\n\n    var fields;\n\n    if (field) {\n      fields = parseFields(field);\n    }\n\n    styleOptions.fields = fields;\n    styleOptions.style = cfg;\n    return this;\n  };\n\n  _proto.label = function label(field, callback, cfg) {\n    var self = this;\n    var labelCfg = self.get('labelCfg'); // const scales = Util.map(self.get('labelCfg').fields, field => self._createScale(field));\n\n    if (!labelCfg) {\n      labelCfg = {};\n      self.set('labelCfg', labelCfg);\n    }\n\n    var fields;\n\n    if (field) {\n      fields = parseFields(field);\n    }\n\n    labelCfg.fields = fields; // 如果存在回调函数\n\n    if (Util.isFunction(callback)) {\n      if (!cfg) {\n        cfg = {};\n      }\n\n      labelCfg.callback = callback;\n    } else if (Util.isObject(callback)) {\n      // 如果没有设置回调函数\n      cfg = callback;\n    }\n\n    labelCfg.globalCfg = cfg;\n    return this;\n  };\n\n  _proto.tooltip = function tooltip(field, cfg) {\n    var tooltipCfg = this.get('tooltipCfg');\n\n    if (!tooltipCfg) {\n      tooltipCfg = {};\n    }\n\n    if (field === false) {\n      // geom 关闭 tooltip\n      this.set('tooltipCfg', false);\n    } else {\n      var tooltipFields;\n\n      if (field) {\n        tooltipFields = parseFields(field);\n      }\n\n      tooltipCfg.fields = tooltipFields;\n      tooltipCfg.cfg = cfg;\n    }\n\n    this.set('tooltipCfg', tooltipCfg);\n    return this;\n  };\n\n  _proto.animate = function animate(cfg) {\n    this.set('animateCfg', cfg);\n    return this;\n  };\n  /**\n   * 是否允许使用默认的图形激活交互\n   * @param  {Boolean} enable 是否允许激活开关\n   * @param {Object} cfg 激活的配置项\n   * @return {Geom}    返回 geom 自身\n   */\n\n\n  _proto.active = function active(enable, cfg) {\n    if (enable === false) {\n      this.set('allowActive', false);\n    } else if (Util.isObject(enable)) {\n      this.set('allowActive', true);\n      this.set('activedOptions', enable);\n    } else {\n      this.set('allowActive', true);\n      this.set('activedOptions', cfg);\n    }\n\n    return this;\n  };\n  /**\n   * 对 geometry 进行数据调整\n   * @chainable\n   * @param  {String|Array|null} adjusts 数据调整的类型\n   * @return {Object} geometry 对象\n   */\n\n\n  _proto.adjust = function adjust(adjusts) {\n    if (!this.get('hasDefaultAdjust')) {\n      if (adjusts) {\n        adjusts = parseAdjusts(adjusts);\n      }\n\n      this.set('adjusts', adjusts);\n    }\n\n    return this;\n  };\n  /**\n   * 设置图形的选中模式\n   * @param  {Boolean|Object} enable 布尔类型用于模式开关，对象类型用于配置\n   * @param  {Object} cfg    选中配置项\n   * @return {Geom}          返回 geom 自身\n   */\n\n\n  _proto.select = function select(enable, cfg) {\n    if (enable === false) {\n      this.set('allowSelect', false);\n    } else if (Util.isObject(enable)) {\n      this.set('allowSelect', true);\n      this.set('selectedOptions', enable);\n    } else {\n      this.set('allowSelect', true);\n      this.set('selectedOptions', cfg);\n    }\n\n    return this;\n  };\n\n  _proto.hasAdjust = function hasAdjust(adjustType) {\n    var self = this;\n    var adjusts = self.get('adjusts');\n\n    if (!adjustType) {\n      return false;\n    }\n\n    var rst = false;\n    Util.each(adjusts, function (adjust) {\n      if (adjust.type === adjustType) {\n        rst = true;\n        return false;\n      }\n    });\n    return rst;\n  };\n\n  _proto.hasStack = function hasStack() {\n    var isStacked = this.get('isStacked');\n\n    if (Util.isNil(isStacked)) {\n      isStacked = this.hasAdjust('stack');\n      this.set('isStacked', isStacked);\n    }\n\n    return isStacked;\n  };\n\n  _proto.isInCircle = function isInCircle() {\n    var coord = this.get('coord');\n    return coord && coord.isPolar;\n  };\n\n  _proto._initContainer = function _initContainer() {\n    var self = this;\n    var shapeContainer = self.get('shapeContainer');\n\n    if (!shapeContainer) {\n      var container = self.get('container');\n      var view = self.get('view');\n      var viewId = view && view.get('_id');\n      shapeContainer = container.addGroup({\n        viewId: viewId,\n        visible: self.get('visible')\n      });\n      self.set('shapeContainer', shapeContainer);\n    }\n  };\n\n  _proto.init = function init() {\n    var self = this;\n\n    self._initContainer();\n\n    self._initAttrs();\n\n    if (self.get('tooltipCfg') && self.get('tooltipCfg').fields) {\n      var tooltipFields = self.get('tooltipCfg').fields;\n      Util.each(tooltipFields, function (field) {\n        self._createScale(field);\n      });\n    }\n\n    var dataArray = self._processData();\n\n    if (self.get('adjusts')) {\n      self._adjust(dataArray);\n    }\n\n    self.set('dataArray', dataArray);\n  }; // step 1: init attrs\n\n\n  _proto._initAttrs = function _initAttrs() {\n    var self = this;\n    var attrs = self.get('attrs');\n    var attrOptions = self.get('attrOptions');\n    var coord = self.get('coord');\n    var viewTheme = self.viewTheme || Global;\n    var isPie = false;\n\n    for (var type in attrOptions) {\n      if (attrOptions.hasOwnProperty(type)) {\n        var option = attrOptions[type];\n        var className = Util.upperFirst(type);\n        var fields = parseFields(option.field);\n\n        if (type === 'position') {\n          option.coord = coord; // 饼图坐标系下，填充一维\n\n          if (fields.length === 1 && coord.type === 'theta') {\n            fields.unshift('1');\n            isPie = true;\n          }\n        }\n\n        var scales = [];\n\n        for (var i = 0; i < fields.length; i++) {\n          var field = fields[i];\n\n          var scale = self._createScale(field);\n\n          if (type === 'color' && Util.isNil(option.values)) {\n            // 设置 color 的默认色值\n            if (scale.values.length <= 8) {\n              option.values = isPie ? viewTheme.colors_pie : viewTheme.colors;\n            } else if (scale.values.length <= 16) {\n              option.values = isPie ? viewTheme.colors_pie_16 : viewTheme.colors_16;\n            } else {\n              option.values = viewTheme.colors_24;\n            }\n\n            if (Util.isNil(option.values)) {\n              option.values = viewTheme.colors; // 防止主题没有声明诸如 colors_pie 的属性\n            }\n          }\n\n          scales.push(scale);\n        } // 饼图需要填充满整个空间\n\n\n        if (coord.type === 'theta' && type === 'position' && scales.length > 1) {\n          var yScale = scales[1];\n          yScale.change({\n            nice: false,\n            min: 0,\n            max: Math.max.apply(null, yScale.values)\n          });\n        }\n\n        option.scales = scales;\n        var attr = new Attr[className](option);\n        attrs[type] = attr;\n      }\n    }\n  }; // step 2: 处理数据\n\n\n  _proto._processData = function _processData() {\n    var self = this;\n    var data = this.get('data');\n    var dataArray = [];\n\n    var groupedArray = this._groupData(data);\n\n    for (var i = 0; i < groupedArray.length; i++) {\n      var subData = groupedArray[i];\n\n      var tempData = self._saveOrigin(subData);\n\n      self._numberic(tempData);\n\n      dataArray.push(tempData);\n    }\n\n    return dataArray;\n  }; // step 2.1 数据分组\n\n\n  _proto._groupData = function _groupData(data) {\n    var groupScales = this._getGroupScales();\n\n    var fields = groupScales.map(function (scale) {\n      return scale.field;\n    });\n    return Util.Array.group(data, fields);\n  }; // step 2.2 数据调整前保存原始数据\n\n\n  _proto._saveOrigin = function _saveOrigin(data) {\n    var rst = [];\n\n    for (var i = 0; i < data.length; i++) {\n      var origin = data[i];\n      var obj = {};\n\n      for (var k in origin) {\n        obj[k] = origin[k];\n      } // const obj = Util.mix({}, origin);\n\n\n      obj[FIELD_ORIGIN] = origin;\n      rst.push(obj);\n    }\n\n    return rst;\n  }; // step 2.3 将分类数据翻译成数据, 仅对位置相关的度量进行数字化处理\n\n\n  _proto._numberic = function _numberic(data) {\n    var positionAttr = this.getAttr('position');\n    var scales = positionAttr.scales;\n\n    for (var j = 0; j < data.length; j++) {\n      var obj = data[j];\n\n      for (var i = 0; i < Math.min(2, scales.length); i++) {\n        var scale = scales[i];\n\n        if (scale.isCategory) {\n          var field = scale.field;\n          obj[field] = scale.translate(obj[field]);\n        }\n      }\n    }\n  };\n\n  _proto._getGroupScales = function _getGroupScales() {\n    var self = this;\n    var scales = self.get('groupScales');\n\n    if (!scales) {\n      scales = [];\n      var attrs = self.get('attrs');\n      Util.each(attrs, function (attr) {\n        if (GROUP_ATTRS.indexOf(attr.type) !== -1) {\n          var attrScales = attr.scales;\n          Util.each(attrScales, function (scale) {\n            if (scale.isCategory && Util.indexOf(scales, scale) === -1) {\n              scales.push(scale);\n            }\n          });\n        }\n      });\n      self.set('groupScales', scales);\n    }\n\n    return scales;\n  };\n\n  _proto._updateStackRange = function _updateStackRange(field, scale, dataArray) {\n    var mergeArray = Util.Array.merge(dataArray);\n    var min = scale.min;\n    var max = scale.max;\n\n    for (var i = 0; i < mergeArray.length; i++) {\n      var obj = mergeArray[i];\n      var tmpMin = Math.min.apply(null, obj[field]);\n      var tmpMax = Math.max.apply(null, obj[field]);\n\n      if (tmpMin < min) {\n        min = tmpMin;\n      }\n\n      if (tmpMax > max) {\n        max = tmpMax;\n      }\n    }\n\n    if (min < scale.min || max > scale.max) {\n      scale.change({\n        min: min,\n        max: max\n      });\n    }\n  }; // step 2.2 调整数据\n\n\n  _proto._adjust = function _adjust(dataArray) {\n    var self = this;\n    var adjusts = self.get('adjusts');\n    var viewTheme = this.viewTheme || Global;\n    var yScale = self.getYScale();\n    var xScale = self.getXScale();\n    var xField = xScale.field;\n    var yField = yScale ? yScale.field : null;\n    Util.each(adjusts, function (adjust) {\n      var adjustCfg = Util.mix({\n        xField: xField,\n        yField: yField\n      }, adjust);\n      var adjustType = Util.upperFirst(adjust.type);\n\n      if (adjustType === 'Dodge') {\n        var adjustNames = [];\n\n        if (xScale.isCategory || xScale.isIdentity) {\n          adjustNames.push('x');\n        } else if (!yScale) {\n          adjustNames.push('y');\n        } else {\n          throw new Error('dodge is not support linear attribute, please use category attribute!');\n        }\n\n        adjustCfg.adjustNames = adjustNames;\n        adjustCfg.dodgeRatio = viewTheme.widthRatio.column;\n        /* if (self.isInCircle()) {\n          adjustCfg.dodgeRatio = 1;\n          adjustCfg.marginRatio = 0;\n        }*/\n      } else if (adjustType === 'Stack') {\n        var coord = self.get('coord');\n\n        if (!yScale) {\n          // 一维的情况下获取高度和默认size\n          adjustCfg.height = coord.getHeight();\n          var size = self.getDefaultValue('size') || 3;\n          adjustCfg.size = size;\n        } // 不进行 transpose 时，用户又没有设置这个参数时，默认从上向下\n\n\n        if (!coord.isTransposed && Util.isNil(adjustCfg.reverseOrder)) {\n          adjustCfg.reverseOrder = true;\n        }\n      }\n\n      var adjustElement = new Adjust[adjustType](adjustCfg);\n      adjustElement.processAdjust(dataArray);\n\n      if (adjustType === 'Stack' && yScale) {\n        self._updateStackRange(yField, yScale, dataArray);\n      }\n    });\n  };\n  /**\n   * @internal 设置coord，通常外部容器变化时，coord 会发生变化\n   * @param {Object} coord 坐标系\n   */\n\n\n  _proto.setCoord = function setCoord(coord) {\n    this.set('coord', coord);\n    var position = this.getAttr('position');\n    var shapeContainer = this.get('shapeContainer');\n    shapeContainer.setMatrix(coord.matrix);\n\n    if (position) {\n      position.coord = coord;\n    }\n  }; // step 3 绘制\n\n\n  _proto.paint = function paint() {\n    var self = this;\n    var dataArray = self.get('dataArray');\n    var mappedArray = [];\n    var shapeFactory = self.getShapeFactory();\n    shapeFactory.setCoord(self.get('coord'));\n    var shapeContainer = self.get('shapeContainer');\n\n    self._beforeMapping(dataArray);\n\n    for (var i = 0; i < dataArray.length; i++) {\n      var data = dataArray[i];\n      var index = i;\n      data = self._mapping(data);\n      mappedArray.push(data);\n      self.draw(data, shapeContainer, shapeFactory, index);\n    }\n\n    if (self.get('labelCfg')) {\n      self._addLabels(Util.union.apply(null, mappedArray), shapeContainer.get('children'));\n    }\n\n    if (!self.get('sortable')) {\n      self._sort(mappedArray); // 便于数据的查找，需要对数据进行排序，用于 geom.findPoint()\n\n    } else {\n      self.set('dataArray', mappedArray);\n    }\n  };\n\n  _proto._sort = function _sort(mappedArray) {\n    var self = this;\n    var xScale = self.getXScale();\n    var xField = xScale.field;\n    Util.each(mappedArray, function (itemArr) {\n      itemArr.sort(function (obj1, obj2) {\n        return xScale.translate(obj1[FIELD_ORIGIN][xField]) - xScale.translate(obj2[FIELD_ORIGIN][xField]);\n      });\n    });\n    self.set('dataArray', mappedArray);\n  }; // step 3.1 before mapping\n\n\n  _proto._beforeMapping = function _beforeMapping(dataArray) {\n    var self = this;\n\n    if (self.get('sortable')) {\n      var xScale = self.getXScale();\n      var field = xScale.field;\n      Util.each(dataArray, function (data) {\n        data.sort(function (v1, v2) {\n          return xScale.translate(v1[field]) - xScale.translate(v2[field]);\n        });\n      });\n    }\n\n    if (self.get('generatePoints')) {\n      Util.each(dataArray, function (data) {\n        self._generatePoints(data);\n      });\n      Util.each(dataArray, function (data, index) {\n        var nextData = dataArray[index + 1];\n\n        if (nextData) {\n          data[0].nextPoints = nextData[0].points;\n        }\n      });\n    }\n  }; // step 3.2 add labels\n\n\n  _proto._addLabels = function _addLabels(points, shapes) {\n    var self = this;\n    var type = self.get('type');\n    var viewTheme = self.get('viewTheme') || Global;\n    var coord = self.get('coord');\n    var C = Labels.getLabelsClass(coord.type, type);\n    var container = self.get('container');\n    var scales = Util.map(self.get('labelCfg').fields, function (field) {\n      return self._createScale(field);\n    });\n    var labelContainer = container.addGroup(C, {\n      _id: this.get('_id'),\n      labelCfg: Util.mix({\n        scales: scales\n      }, self.get('labelCfg')),\n      coord: coord,\n      geom: self,\n      geomType: type,\n      viewTheme: viewTheme,\n      visible: self.get('visible')\n    });\n    labelContainer.showLabels(points, shapes);\n    self.set('labelContainer', labelContainer);\n  };\n  /**\n   * @protected\n   * 获取图形的工厂类\n   * @return {Object} 工厂类对象\n   */\n\n\n  _proto.getShapeFactory = function getShapeFactory() {\n    var shapeFactory = this.get('shapeFactory');\n\n    if (!shapeFactory) {\n      var shapeType = this.get('shapeType');\n      shapeFactory = Shape.getShapeFactory(shapeType);\n      this.set('shapeFactory', shapeFactory);\n    }\n\n    return shapeFactory;\n  }; // step 3.2 generate points\n\n\n  _proto._generatePoints = function _generatePoints(data) {\n    var self = this;\n    var shapeFactory = self.getShapeFactory();\n    var shapeAttr = self.getAttr('shape');\n\n    for (var i = 0; i < data.length; i++) {\n      var obj = data[i];\n      var cfg = self.createShapePointsCfg(obj);\n      var shape = shapeAttr ? self._getAttrValues(shapeAttr, obj) : null;\n      var points = shapeFactory.getShapePoints(shape, cfg);\n      obj.points = points;\n    }\n  };\n  /**\n   * 获取图形对应点的配置项\n   * @protected\n   * @param  {Object} obj 数据对象\n   * @return {Object} cfg 获取图形对应点的配置项\n   */\n\n\n  _proto.createShapePointsCfg = function createShapePointsCfg(obj) {\n    var xScale = this.getXScale();\n    var yScale = this.getYScale();\n\n    var x = this._normalizeValues(obj[xScale.field], xScale);\n\n    var y; // 存在没有 y 的情况\n\n    if (yScale) {\n      y = this._normalizeValues(obj[yScale.field], yScale);\n    } else {\n      y = obj.y ? obj.y : 0.1;\n    }\n\n    return {\n      x: x,\n      y: y,\n      y0: yScale ? yScale.scale(this.getYMinValue()) : undefined\n    };\n  };\n  /**\n   * @protected\n   * 如果y轴的最小值小于0则返回0，否则返回最小值\n   * @return {Number} y轴上的最小值\n   */\n\n\n  _proto.getYMinValue = function getYMinValue() {\n    var yScale = this.getYScale();\n    var min = yScale.min,\n        max = yScale.max;\n    var value;\n\n    if (min >= 0) {\n      value = min;\n    } else if (max <= 0) {\n      // 当值全位于负区间时，需要保证 ymin 在区域内，不可为 0\n      value = max;\n    } else {\n      value = 0;\n    }\n\n    return value;\n  }; // 将数据归一化\n\n\n  _proto._normalizeValues = function _normalizeValues(values, scale) {\n    var rst = [];\n\n    if (Util.isArray(values)) {\n      for (var i = 0; i < values.length; i++) {\n        var v = values[i];\n        rst.push(scale.scale(v));\n      }\n    } else {\n      rst = scale.scale(values);\n    }\n\n    return rst;\n  }; // step 3.2 mapping\n\n\n  _proto._mapping = function _mapping(data) {\n    var self = this;\n    var attrs = self.get('attrs');\n    var mappedData = [];\n\n    for (var i = 0; i < data.length; i++) {\n      var record = data[i];\n      var newRecord = {};\n      newRecord[FIELD_ORIGIN] = record[FIELD_ORIGIN];\n      newRecord.points = record.points;\n      newRecord.nextPoints = record.nextPoints;\n\n      for (var k in attrs) {\n        if (attrs.hasOwnProperty(k)) {\n          var attr = attrs[k];\n          var names = attr.names;\n\n          var values = self._getAttrValues(attr, record);\n\n          if (names.length > 1) {\n            // position 之类的生成多个字段的属性\n            for (var j = 0; j < values.length; j++) {\n              var val = values[j];\n              var name = names[j];\n              newRecord[name] = Util.isArray(val) && val.length === 1 ? val[0] : val; // 只有一个值时返回第一个属性值\n            }\n          } else {\n            newRecord[names[0]] = values.length === 1 ? values[0] : values;\n          }\n        }\n      }\n\n      mappedData.push(newRecord);\n    }\n\n    return mappedData;\n  }; // 获取属性映射的值\n\n\n  _proto._getAttrValues = function _getAttrValues(attr, record) {\n    var scales = attr.scales;\n    var params = [];\n\n    for (var i = 0; i < scales.length; i++) {\n      var scale = scales[i];\n      var field = scale.field;\n\n      if (scale.type === 'identity') {\n        params.push(scale.value);\n      } else {\n        params.push(record[field]);\n      }\n    }\n\n    var values = attr.mapping.apply(attr, params);\n    return values;\n  };\n\n  _proto.getAttrValue = function getAttrValue(attrName, record) {\n    var attr = this.getAttr(attrName);\n    var rst = null;\n\n    if (attr) {\n      var values = this._getAttrValues(attr, record);\n\n      rst = values[0];\n    }\n\n    return rst;\n  };\n\n  _proto.getDefaultValue = function getDefaultValue(attrName) {\n    var value = this.get(attrName);\n    var attr = this.getAttr(attrName);\n\n    if (attr) {\n      var scale = attr.getScale(attrName);\n\n      if (scale.type === 'identity') {\n        value = scale.value;\n      }\n    }\n\n    return value;\n  };\n  /**\n   * step 3.3 draw\n   * @protected\n   * @param  {Array} data 绘制图形\n   * @param {Object} container 绘图容器\n   * @param {Object} shapeFactory 绘制图形的工厂类\n   * @param {Number} index 每个 shape 的索引值\n   */\n\n\n  _proto.draw = function draw(data, container, shapeFactory, index) {\n    var self = this;\n\n    for (var i = 0; i < data.length; i++) {\n      var obj = data[i];\n      self.drawPoint(obj, container, shapeFactory, index + i);\n    }\n  };\n\n  _proto.getCallbackCfg = function getCallbackCfg(fields, cfg, origin) {\n    if (!fields) {\n      return cfg;\n    }\n\n    var tmpCfg = {};\n    var params = fields.map(function (field) {\n      return origin[field];\n    });\n    Util.each(cfg, function (v, k) {\n      if (Util.isFunction(v)) {\n        tmpCfg[k] = v.apply(null, params);\n      } else {\n        tmpCfg[k] = v;\n      }\n    });\n    return tmpCfg;\n  };\n\n  _proto._getShapeId = function _getShapeId(dataObj) {\n    var id = this.get('_id');\n    var keyFields = this.get('keyFields');\n\n    if (keyFields && keyFields.length > 0) {\n      Util.each(keyFields, function (key) {\n        id += '-' + dataObj[key];\n      });\n    } else {\n      var type = this.get('type');\n      var xScale = this.getXScale();\n      var yScale = this.getYScale();\n      var xField = xScale.field || 'x';\n      var yField = yScale.field || 'y';\n      var yVal = dataObj[yField];\n      var xVal;\n\n      if (xScale.isIdentity) {\n        xVal = xScale.value;\n      } else {\n        xVal = dataObj[xField];\n      }\n\n      if (type === 'interval' || type === 'schema') {\n        id += '-' + xVal;\n      } else if (type === 'line' || type === 'area' || type === 'path') {\n        id += '-' + type;\n      } else {\n        id += '-' + xVal + '-' + yVal;\n      }\n\n      var groupScales = this._getGroupScales();\n\n      if (!Util.isEmpty(groupScales)) {\n        Util.each(groupScales, function (groupScale) {\n          var field = groupScale.field;\n\n          if (groupScale.type !== 'identity') {\n            id += '-' + dataObj[field];\n          }\n        });\n      }\n    }\n\n    return id;\n  };\n\n  _proto.getDrawCfg = function getDrawCfg(obj) {\n    var self = this;\n    var cfg = {\n      origin: obj,\n      x: obj.x,\n      y: obj.y,\n      color: obj.color,\n      size: obj.size,\n      shape: obj.shape,\n      isInCircle: self.isInCircle(),\n      opacity: obj.opacity\n    };\n    var styleOptions = self.get('styleOptions');\n\n    if (styleOptions && styleOptions.style) {\n      cfg.style = self.getCallbackCfg(styleOptions.fields, styleOptions.style, obj[FIELD_ORIGIN]);\n    }\n\n    if (this.get('generatePoints')) {\n      cfg.points = obj.points;\n      cfg.nextPoints = obj.nextPoints;\n    }\n\n    if (this.get('animate')) {\n      // _id 字段仅用于动画\n      cfg._id = self._getShapeId(obj[FIELD_ORIGIN]);\n    }\n\n    return cfg;\n  };\n\n  _proto.appendShapeInfo = function appendShapeInfo(shape, index) {\n    if (shape) {\n      shape.setSilent('index', index);\n      shape.setSilent('coord', this.get('coord'));\n\n      if (this.get('animate') && this.get('animateCfg')) {\n        shape.setSilent('animateCfg', this.get('animateCfg'));\n      }\n    }\n  };\n\n  _proto.drawPoint = function drawPoint(obj, container, shapeFactory, index) {\n    var shape = obj.shape;\n    var cfg = this.getDrawCfg(obj);\n    var geomShape = shapeFactory.drawShape(shape, cfg, container);\n    this.appendShapeInfo(geomShape, index);\n  };\n  /**\n   * 获取属性\n   * @protected\n   * @param {String} name 属性名\n   * @return {Scale} 度量\n   */\n\n\n  _proto.getAttr = function getAttr(name) {\n    return this.get('attrs')[name];\n  };\n  /**\n   * 获取 x 对应的度量\n   * @return {Scale} x 对应的度量\n   */\n\n\n  _proto.getXScale = function getXScale() {\n    return this.getAttr('position').scales[0];\n  };\n  /**\n   * 获取 y 对应的度量\n   * @return {Scale} y 对应的度量\n   */\n\n\n  _proto.getYScale = function getYScale() {\n    return this.getAttr('position').scales[1];\n  };\n\n  _proto.getShapes = function getShapes() {\n    var result = [];\n    var shapeContainer = this.get('shapeContainer');\n    var children = shapeContainer.get('children');\n    Util.each(children, function (child) {\n      if (child.get('origin')) {\n        // 过滤 label\n        result.push(child);\n      }\n    });\n    return result;\n  };\n\n  _proto.getAttrsForLegend = function getAttrsForLegend() {\n    var attrs = this.get('attrs');\n    var rst = [];\n    Util.each(attrs, function (attr) {\n      if (GROUP_ATTRS.indexOf(attr.type) !== -1) {\n        rst.push(attr);\n      }\n    });\n    return rst;\n  };\n\n  _proto.getFieldsForLegend = function getFieldsForLegend() {\n    var fields = [];\n    var attrOptions = this.get('attrOptions');\n    Util.each(GROUP_ATTRS, function (attrName) {\n      var attrCfg = attrOptions[attrName];\n\n      if (attrCfg && attrCfg.field && Util.isString(attrCfg.field)) {\n        fields = fields.concat(attrCfg.field.split('*'));\n      }\n    });\n    return Util.uniq(fields);\n  };\n\n  _proto.changeVisible = function changeVisible(visible, stopDraw) {\n    var me = this;\n    me.set('visible', visible);\n    var shapeContainer = this.get('shapeContainer');\n\n    if (shapeContainer) {\n      shapeContainer.set('visible', visible);\n    }\n\n    var labelContainer = this.get('labelContainer');\n\n    if (labelContainer) {\n      labelContainer.set('visible', visible);\n    }\n\n    if (!stopDraw && shapeContainer) {\n      var canvas = shapeContainer.get('canvas');\n      canvas.draw();\n    }\n  };\n\n  _proto.reset = function reset() {\n    this.set('attrOptions', {});\n    this.clearInner();\n  };\n\n  _proto.clearInner = function clearInner() {\n    this.clearActivedShapes();\n    this.clearSelected();\n    var shapeContainer = this.get('shapeContainer');\n    shapeContainer && shapeContainer.clear(); // 由于 Labels 对应的模块需要生成group，所以这个地方需要删除\n\n    var labelContainer = this.get('labelContainer');\n    labelContainer && labelContainer.remove();\n    this.set('attrs', {});\n    this.set('groupScales', null); // if (!this.get('hasDefaultAdjust')) {\n    //   this.set('adjusts', null);\n    // }\n\n    this.set('labelContainer', null);\n    this.set('xDistance', null);\n    this.set('isStacked', null);\n  };\n\n  _proto.clear = function clear() {\n    this.clearInner();\n    this.set('scales', {});\n  };\n\n  _proto.destroy = function destroy() {\n    this.clear();\n    var shapeContainer = this.get('shapeContainer');\n    shapeContainer && shapeContainer.remove();\n    this.offEvents();\n\n    _Base.prototype.destroy.call(this);\n  };\n\n  _proto.bindEvents = function bindEvents() {\n    if (this.get('view')) {\n      this._bindActiveAction();\n\n      this._bindSelectedAction();\n    }\n  };\n\n  _proto.offEvents = function offEvents() {\n    if (this.get('view')) {\n      this._offActiveAction();\n\n      this._offSelectedAction();\n    }\n  };\n\n  return GeomBase;\n}(Base);\n\nmodule.exports = GeomBase;"]}]}