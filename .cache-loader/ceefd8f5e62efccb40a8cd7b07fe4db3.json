{"remainingRequest":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\ts-loader\\index.js??ref--4-1!D:\\project\\Deecamp-project\\system\\Web\\node_modules\\@antv\\g2\\node_modules\\@antv\\component\\lib\\tooltip\\html.js","dependencies":[{"path":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\@antv\\g2\\node_modules\\@antv\\component\\lib\\tooltip\\html.js","mtime":499162500000},{"path":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1595520254649},{"path":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\ts-loader\\index.js","mtime":1537906253000}],"contextDependencies":[],"result":["function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }\r\nfunction _assertThisInitialized(self) { if (self === void 0) {\r\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\r\n} return self; }\r\nvar Tooltip = require('./base');\r\nvar Util = require('../util');\r\nvar DomUtil = Util.DomUtil;\r\nvar TooltipTheme = require('./theme');\r\nvar Crosshair = require('./crosshair');\r\nvar PositionMixin = require('./mixin/position');\r\nvar MarkerGroupMixin = require('./mixin/marker-group');\r\nvar CONTAINER_CLASS = 'g2-tooltip';\r\nvar TITLE_CLASS = 'g2-tooltip-title';\r\nvar LIST_CLASS = 'g2-tooltip-list';\r\nvar MARKER_CLASS = 'g2-tooltip-marker';\r\nvar VALUE_CLASS = 'g2-tooltip-value';\r\nvar LIST_ITEM_CLASS = 'g2-tooltip-list-item';\r\nfunction find(dom, cls) {\r\n    return dom.getElementsByClassName(cls)[0];\r\n}\r\nfunction mergeStyles(styles, cfg) {\r\n    Object.keys(styles).forEach(function (k) {\r\n        if (cfg[k]) {\r\n            styles[k] = Util.mix(styles[k], cfg[k]);\r\n        }\r\n    });\r\n    return styles;\r\n}\r\nvar HtmlTooltip = function (_Tooltip) {\r\n    _inheritsLoose(HtmlTooltip, _Tooltip);\r\n    var _proto = HtmlTooltip.prototype;\r\n    _proto.getDefaultCfg = function getDefaultCfg() {\r\n        var cfg = _Tooltip.prototype.getDefaultCfg.call(this);\r\n        return Util.mix({}, cfg, {\r\n            containerTpl: ' <div class=\"' + CONTAINER_CLASS + '\"> ' + '<div class=\"' + TITLE_CLASS + '\"></div>' + '<ul class=\"' + LIST_CLASS + '\"></ul>' + '</div>',\r\n            itemTpl: '<li data-index={index}>' + '<span style=\"background-color:{color};\" class=' + MARKER_CLASS + '></span>' + '{name}<span class=' + VALUE_CLASS + '>{value}</span></li>',\r\n            htmlContent: null,\r\n            follow: true,\r\n            enterable: false\r\n        });\r\n    };\r\n    function HtmlTooltip(cfg) {\r\n        var _this;\r\n        _this = _Tooltip.call(this, cfg) || this;\r\n        Util.assign(_assertThisInitialized(_assertThisInitialized(_this)), PositionMixin);\r\n        Util.assign(_assertThisInitialized(_assertThisInitialized(_this)), MarkerGroupMixin);\r\n        var style = _this.get('viewTheme') || TooltipTheme;\r\n        _this.style = mergeStyles(style, cfg);\r\n        _this._init_();\r\n        if (_this.get('items')) {\r\n            _this.render();\r\n        }\r\n        var crosshair = _this.get('crosshairs');\r\n        if (crosshair) {\r\n            var plot = crosshair.type === 'rect' ? _this.get('backPlot') : _this.get('frontPlot');\r\n            var crosshairGroup = new Crosshair(Util.mix({\r\n                plot: plot,\r\n                plotRange: _this.get('plotRange'),\r\n                canvas: _this.get('canvas')\r\n            }, _this.get('crosshairs')));\r\n            crosshairGroup.hide();\r\n            _this.set('crosshairGroup', crosshairGroup);\r\n        }\r\n        return _this;\r\n    }\r\n    _proto._init_ = function _init_() {\r\n        var self = this;\r\n        var containerTpl = self.get('containerTpl');\r\n        var outterNode = self.get('canvas').get('el').parentNode;\r\n        var container;\r\n        if (!this.get('htmlContent')) {\r\n            if (/^\\#/.test(containerTpl)) {\r\n                var id = containerTpl.replace('#', '');\r\n                container = document.getElementById(id);\r\n            }\r\n            else {\r\n                container = DomUtil.createDom(containerTpl);\r\n                DomUtil.modifyCSS(container, self.style[CONTAINER_CLASS]);\r\n                outterNode.appendChild(container);\r\n                outterNode.style.position = 'relative';\r\n            }\r\n            self.set('container', container);\r\n        }\r\n    };\r\n    _proto.render = function render() {\r\n        var self = this;\r\n        self.clear();\r\n        if (self.get('htmlContent')) {\r\n            var outterNode = self.get('canvas').get('el').parentNode;\r\n            var container = self._getHtmlContent();\r\n            outterNode.appendChild(container);\r\n            self.set('container', container);\r\n        }\r\n        else {\r\n            self._renderTpl();\r\n        }\r\n    };\r\n    _proto._renderTpl = function _renderTpl() {\r\n        var self = this;\r\n        var showTitle = self.get('showTitle');\r\n        var titleContent = self.get('titleContent');\r\n        var container = self.get('container');\r\n        var titleDom = find(container, TITLE_CLASS);\r\n        var listDom = find(container, LIST_CLASS);\r\n        var items = self.get('items');\r\n        if (titleDom && showTitle) {\r\n            DomUtil.modifyCSS(titleDom, self.style[TITLE_CLASS]);\r\n            titleDom.innerHTML = titleContent;\r\n        }\r\n        if (listDom) {\r\n            DomUtil.modifyCSS(listDom, self.style[LIST_CLASS]);\r\n            Util.each(items, function (item, index) {\r\n                listDom.appendChild(self._addItem(item, index));\r\n            });\r\n        }\r\n    };\r\n    _proto.clear = function clear() {\r\n        var container = this.get('container');\r\n        if (this.get('htmlContent')) {\r\n            container && container.remove();\r\n        }\r\n        else {\r\n            var titleDom = find(container, TITLE_CLASS);\r\n            var listDom = find(container, LIST_CLASS);\r\n            if (titleDom) {\r\n                titleDom.innerHTML = '';\r\n            }\r\n            if (listDom) {\r\n                listDom.innerHTML = '';\r\n            }\r\n        }\r\n    };\r\n    _proto.show = function show() {\r\n        var container = this.get('container');\r\n        container.style.visibility = 'visible';\r\n        var crosshairGroup = this.get('crosshairGroup');\r\n        crosshairGroup && crosshairGroup.show();\r\n        var markerGroup = this.get('markerGroup');\r\n        markerGroup && markerGroup.show();\r\n        _Tooltip.prototype.show.call(this);\r\n        this.get('canvas').draw();\r\n    };\r\n    _proto.hide = function hide() {\r\n        var container = this.get('container');\r\n        container.style.visibility = 'hidden';\r\n        var crosshairGroup = this.get('crosshairGroup');\r\n        crosshairGroup && crosshairGroup.hide();\r\n        var markerGroup = this.get('markerGroup');\r\n        markerGroup && markerGroup.hide();\r\n        _Tooltip.prototype.hide.call(this);\r\n        this.get('canvas').draw();\r\n    };\r\n    _proto.destroy = function destroy() {\r\n        var self = this;\r\n        var container = self.get('container');\r\n        var containerTpl = self.get('containerTpl');\r\n        if (container && !/^\\#/.test(containerTpl)) {\r\n            container.parentNode.removeChild(container);\r\n        }\r\n        var crosshairGroup = this.get('crosshairGroup');\r\n        crosshairGroup && crosshairGroup.destroy();\r\n        var markerGroup = this.get('markerGroup');\r\n        markerGroup && markerGroup.remove();\r\n        _Tooltip.prototype.destroy.call(this);\r\n    };\r\n    _proto._addItem = function _addItem(item, index) {\r\n        var itemTpl = this.get('itemTpl');\r\n        var itemDiv = Util.substitute(itemTpl, Util.mix({\r\n            index: index\r\n        }, item));\r\n        var itemDOM = DomUtil.createDom(itemDiv);\r\n        DomUtil.modifyCSS(itemDOM, this.style[LIST_ITEM_CLASS]);\r\n        var markerDom = find(itemDOM, MARKER_CLASS);\r\n        if (markerDom) {\r\n            DomUtil.modifyCSS(markerDom, this.style[MARKER_CLASS]);\r\n        }\r\n        var valueDom = find(itemDOM, VALUE_CLASS);\r\n        if (valueDom) {\r\n            DomUtil.modifyCSS(valueDom, this.style[VALUE_CLASS]);\r\n        }\r\n        return itemDOM;\r\n    };\r\n    _proto._getHtmlContent = function _getHtmlContent() {\r\n        var htmlContent = this.get('htmlContent');\r\n        var title = this.get('titleContent');\r\n        var items = this.get('items');\r\n        var htmlString = htmlContent(title, items);\r\n        var ele = DomUtil.createDom(htmlString);\r\n        return ele;\r\n    };\r\n    _proto.setPosition = function setPosition(x, y, target) {\r\n        var container = this.get('container');\r\n        var outterNode = this.get('canvas').get('el');\r\n        var viewWidth = DomUtil.getWidth(outterNode);\r\n        var viewHeight = DomUtil.getHeight(outterNode);\r\n        var containerWidth = container.clientWidth;\r\n        var containerHeight = container.clientHeight;\r\n        var endx = x;\r\n        var endy = y;\r\n        var position;\r\n        var prePosition = this.get('prePosition') || {\r\n            x: 0,\r\n            y: 0\r\n        };\r\n        if (this.get('enterable')) {\r\n            y = y - container.clientHeight / 2;\r\n            position = [x, y];\r\n            if (prePosition && x - prePosition.x > 0) {\r\n                x -= container.clientWidth + 1;\r\n            }\r\n            else {\r\n                x += 1;\r\n            }\r\n        }\r\n        else if (this.get('position')) {\r\n            var _containerWidth = container.clientWidth;\r\n            var _containerHeight = container.clientHeight;\r\n            position = this._calcTooltipPosition(x, y, this.get('position'), _containerWidth, _containerHeight, target);\r\n            x = position[0];\r\n            y = position[1];\r\n        }\r\n        else {\r\n            position = this._constraintPositionInBoundary(x, y, containerWidth, containerHeight, viewWidth, viewHeight);\r\n            x = position[0];\r\n            y = position[1];\r\n        }\r\n        if (this.get('inPlot')) {\r\n            var plotRange = this.get('plotRange');\r\n            position = this._constraintPositionInPlot(x, y, containerWidth, containerHeight, plotRange, this.get('enterable'));\r\n            x = position[0];\r\n            y = position[1];\r\n        }\r\n        var markerItems = this.get('markerItems');\r\n        if (!Util.isEmpty(markerItems)) {\r\n            endx = markerItems[0].x;\r\n            endy = markerItems[0].y;\r\n        }\r\n        this.set('prePosition', position);\r\n        var follow = this.get('follow');\r\n        container.style.left = follow ? x + 'px' : 0;\r\n        container.style.top = follow ? y + 'px' : 0;\r\n        var crosshairGroup = this.get('crosshairGroup');\r\n        if (crosshairGroup) {\r\n            var items = this.get('items');\r\n            crosshairGroup.setPosition(endx, endy, items);\r\n        }\r\n        _Tooltip.prototype.setPosition.call(this, x, y);\r\n    };\r\n    return HtmlTooltip;\r\n}(Tooltip);\r\nmodule.exports = HtmlTooltip;\r\n",{"version":3,"file":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\@antv\\g2\\node_modules\\@antv\\component\\lib\\tooltip\\html.js","sourceRoot":"","sources":["D:\\project\\Deecamp-project\\system\\Web\\node_modules\\@antv\\g2\\node_modules\\@antv\\component\\lib\\tooltip\\html.js"],"names":[],"mappings":"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","sourcesContent":["function _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nvar Tooltip = require('./base');\n\nvar Util = require('../util');\n\nvar DomUtil = Util.DomUtil;\n\nvar TooltipTheme = require('./theme');\n\nvar Crosshair = require('./crosshair');\n\nvar PositionMixin = require('./mixin/position');\n\nvar MarkerGroupMixin = require('./mixin/marker-group');\n\nvar CONTAINER_CLASS = 'g2-tooltip';\nvar TITLE_CLASS = 'g2-tooltip-title';\nvar LIST_CLASS = 'g2-tooltip-list';\nvar MARKER_CLASS = 'g2-tooltip-marker';\nvar VALUE_CLASS = 'g2-tooltip-value';\nvar LIST_ITEM_CLASS = 'g2-tooltip-list-item';\n\nfunction find(dom, cls) {\n  return dom.getElementsByClassName(cls)[0];\n}\n\nfunction mergeStyles(styles, cfg) {\n  Object.keys(styles).forEach(function (k) {\n    if (cfg[k]) {\n      styles[k] = Util.mix(styles[k], cfg[k]);\n    }\n  });\n  return styles;\n}\n\nvar HtmlTooltip =\n/*#__PURE__*/\nfunction (_Tooltip) {\n  _inheritsLoose(HtmlTooltip, _Tooltip);\n\n  var _proto = HtmlTooltip.prototype;\n\n  _proto.getDefaultCfg = function getDefaultCfg() {\n    var cfg = _Tooltip.prototype.getDefaultCfg.call(this);\n\n    return Util.mix({}, cfg, {\n      /**\n         * tooltip 容器模板\n         * @type {String}\n      */\n      containerTpl: ' <div class=\"' + CONTAINER_CLASS + '\"> ' + '<div class=\"' + TITLE_CLASS + '\"></div>' + '<ul class=\"' + LIST_CLASS + '\"></ul>' + '</div>',\n\n      /**\n       * tooltip 列表项模板\n       * @type {String}\n       */\n      itemTpl: '<li data-index={index}>' + '<span style=\"background-color:{color};\" class=' + MARKER_CLASS + '></span>' + '{name}<span class=' + VALUE_CLASS + '>{value}</span></li>',\n\n      /**\n       * tooltip html内容\n       * @type {String}\n       */\n      htmlContent: null,\n\n      /**\n       * tooltip 内容跟随鼠标移动\n       * @type {Boolean}\n       */\n      follow: true,\n\n      /**\n       * 是否允许鼠标停留在 tooltip 上，默认不允许\n       * @type {Boolean}\n       */\n      enterable: false\n    });\n  };\n\n  function HtmlTooltip(cfg) {\n    var _this;\n\n    _this = _Tooltip.call(this, cfg) || this;\n    Util.assign(_assertThisInitialized(_assertThisInitialized(_this)), PositionMixin);\n    Util.assign(_assertThisInitialized(_assertThisInitialized(_this)), MarkerGroupMixin);\n    var style = _this.get('viewTheme') || TooltipTheme;\n    _this.style = mergeStyles(style, cfg);\n\n    _this._init_();\n\n    if (_this.get('items')) {\n      _this.render();\n    } // crosshair\n\n\n    var crosshair = _this.get('crosshairs');\n\n    if (crosshair) {\n      var plot = crosshair.type === 'rect' ? _this.get('backPlot') : _this.get('frontPlot');\n      var crosshairGroup = new Crosshair(Util.mix({\n        plot: plot,\n        plotRange: _this.get('plotRange'),\n        canvas: _this.get('canvas')\n      }, _this.get('crosshairs')));\n      crosshairGroup.hide();\n\n      _this.set('crosshairGroup', crosshairGroup);\n    }\n\n    return _this;\n  }\n\n  _proto._init_ = function _init_() {\n    var self = this;\n    var containerTpl = self.get('containerTpl');\n    var outterNode = self.get('canvas').get('el').parentNode;\n    var container;\n\n    if (!this.get('htmlContent')) {\n      if (/^\\#/.test(containerTpl)) {\n        // 如果传入 dom 节点的 id\n        var id = containerTpl.replace('#', '');\n        container = document.getElementById(id);\n      } else {\n        container = DomUtil.createDom(containerTpl);\n        DomUtil.modifyCSS(container, self.style[CONTAINER_CLASS]);\n        outterNode.appendChild(container);\n        outterNode.style.position = 'relative';\n      }\n\n      self.set('container', container);\n    }\n  };\n\n  _proto.render = function render() {\n    var self = this;\n    self.clear();\n\n    if (self.get('htmlContent')) {\n      var outterNode = self.get('canvas').get('el').parentNode;\n\n      var container = self._getHtmlContent();\n\n      outterNode.appendChild(container);\n      self.set('container', container);\n    } else {\n      self._renderTpl();\n    }\n  };\n\n  _proto._renderTpl = function _renderTpl() {\n    var self = this;\n    var showTitle = self.get('showTitle');\n    var titleContent = self.get('titleContent');\n    var container = self.get('container');\n    var titleDom = find(container, TITLE_CLASS);\n    var listDom = find(container, LIST_CLASS);\n    var items = self.get('items');\n\n    if (titleDom && showTitle) {\n      DomUtil.modifyCSS(titleDom, self.style[TITLE_CLASS]);\n      titleDom.innerHTML = titleContent;\n    }\n\n    if (listDom) {\n      DomUtil.modifyCSS(listDom, self.style[LIST_CLASS]);\n      Util.each(items, function (item, index) {\n        listDom.appendChild(self._addItem(item, index));\n      });\n    }\n  };\n\n  _proto.clear = function clear() {\n    var container = this.get('container');\n\n    if (this.get('htmlContent')) {\n      container && container.remove();\n    } else {\n      var titleDom = find(container, TITLE_CLASS);\n      var listDom = find(container, LIST_CLASS);\n\n      if (titleDom) {\n        titleDom.innerHTML = '';\n      }\n\n      if (listDom) {\n        listDom.innerHTML = '';\n      }\n    }\n  };\n\n  _proto.show = function show() {\n    var container = this.get('container');\n    container.style.visibility = 'visible';\n    var crosshairGroup = this.get('crosshairGroup');\n    crosshairGroup && crosshairGroup.show();\n    var markerGroup = this.get('markerGroup');\n    markerGroup && markerGroup.show();\n\n    _Tooltip.prototype.show.call(this);\n\n    this.get('canvas').draw();\n  };\n\n  _proto.hide = function hide() {\n    var container = this.get('container');\n    container.style.visibility = 'hidden';\n    var crosshairGroup = this.get('crosshairGroup');\n    crosshairGroup && crosshairGroup.hide();\n    var markerGroup = this.get('markerGroup');\n    markerGroup && markerGroup.hide();\n\n    _Tooltip.prototype.hide.call(this);\n\n    this.get('canvas').draw();\n  };\n\n  _proto.destroy = function destroy() {\n    var self = this;\n    var container = self.get('container');\n    var containerTpl = self.get('containerTpl');\n\n    if (container && !/^\\#/.test(containerTpl)) {\n      container.parentNode.removeChild(container);\n    }\n\n    var crosshairGroup = this.get('crosshairGroup');\n    crosshairGroup && crosshairGroup.destroy();\n    var markerGroup = this.get('markerGroup');\n    markerGroup && markerGroup.remove();\n\n    _Tooltip.prototype.destroy.call(this);\n  };\n\n  _proto._addItem = function _addItem(item, index) {\n    var itemTpl = this.get('itemTpl'); // TODO: 有可能是个回调函数\n\n    var itemDiv = Util.substitute(itemTpl, Util.mix({\n      index: index\n    }, item));\n    var itemDOM = DomUtil.createDom(itemDiv);\n    DomUtil.modifyCSS(itemDOM, this.style[LIST_ITEM_CLASS]);\n    var markerDom = find(itemDOM, MARKER_CLASS);\n\n    if (markerDom) {\n      DomUtil.modifyCSS(markerDom, this.style[MARKER_CLASS]);\n    }\n\n    var valueDom = find(itemDOM, VALUE_CLASS);\n\n    if (valueDom) {\n      DomUtil.modifyCSS(valueDom, this.style[VALUE_CLASS]);\n    }\n\n    return itemDOM;\n  };\n\n  _proto._getHtmlContent = function _getHtmlContent() {\n    var htmlContent = this.get('htmlContent');\n    var title = this.get('titleContent');\n    var items = this.get('items');\n    var htmlString = htmlContent(title, items);\n    var ele = DomUtil.createDom(htmlString);\n    return ele;\n  };\n\n  _proto.setPosition = function setPosition(x, y, target) {\n    var container = this.get('container');\n    var outterNode = this.get('canvas').get('el');\n    var viewWidth = DomUtil.getWidth(outterNode);\n    var viewHeight = DomUtil.getHeight(outterNode);\n    var containerWidth = container.clientWidth;\n    var containerHeight = container.clientHeight;\n    var endx = x;\n    var endy = y;\n    var position;\n    var prePosition = this.get('prePosition') || {\n      x: 0,\n      y: 0\n    };\n\n    if (this.get('enterable')) {\n      y = y - container.clientHeight / 2;\n      position = [x, y];\n\n      if (prePosition && x - prePosition.x > 0) {\n        // 留 1px 防止鼠标点击事件无法在画布上触发\n        x -= container.clientWidth + 1;\n      } else {\n        x += 1;\n      }\n    } else if (this.get('position')) {\n      var _containerWidth = container.clientWidth;\n      var _containerHeight = container.clientHeight;\n      position = this._calcTooltipPosition(x, y, this.get('position'), _containerWidth, _containerHeight, target);\n      x = position[0];\n      y = position[1];\n    } else {\n      position = this._constraintPositionInBoundary(x, y, containerWidth, containerHeight, viewWidth, viewHeight);\n      x = position[0];\n      y = position[1];\n    }\n\n    if (this.get('inPlot')) {\n      // tooltip 必须限制在绘图区域内\n      var plotRange = this.get('plotRange');\n      position = this._constraintPositionInPlot(x, y, containerWidth, containerHeight, plotRange, this.get('enterable'));\n      x = position[0];\n      y = position[1];\n    }\n\n    var markerItems = this.get('markerItems');\n\n    if (!Util.isEmpty(markerItems)) {\n      endx = markerItems[0].x;\n      endy = markerItems[0].y;\n    }\n\n    this.set('prePosition', position); // 记录上次的位置\n\n    var follow = this.get('follow');\n    container.style.left = follow ? x + 'px' : 0;\n    container.style.top = follow ? y + 'px' : 0;\n    var crosshairGroup = this.get('crosshairGroup');\n\n    if (crosshairGroup) {\n      var items = this.get('items');\n      crosshairGroup.setPosition(endx, endy, items);\n    }\n\n    _Tooltip.prototype.setPosition.call(this, x, y);\n  };\n\n  return HtmlTooltip;\n}(Tooltip);\n\nmodule.exports = HtmlTooltip;"]}]}