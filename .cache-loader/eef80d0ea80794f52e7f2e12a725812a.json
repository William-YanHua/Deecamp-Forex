{"remainingRequest":"/run/media/williamyh/新加卷/project/Deecamp-project/system/Web/node_modules/ts-loader/index.js??ref--4-1!/run/media/williamyh/新加卷/project/Deecamp-project/system/Web/node_modules/@antv/g2plot/esm/interaction/scrollbar.js","dependencies":[{"path":"/run/media/williamyh/新加卷/project/Deecamp-project/system/Web/node_modules/@antv/g2plot/esm/interaction/scrollbar.js","mtime":499162500000},{"path":"/run/media/williamyh/新加卷/project/Deecamp-project/system/Web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/run/media/williamyh/新加卷/project/Deecamp-project/system/Web/node_modules/ts-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import { __assign, __extends } from \"tslib\";\nimport { Scrollbar } from '../dependents';\nimport BBox from '../util/bbox';\nimport { clamp, get, isEqual, throttle } from '@antv/util';\nimport BaseInteraction from './base';\nimport { getDataByScaleRange } from './helper/data-range';\nimport { VIEW_LIFE_CIRCLE } from '@antv/g2/lib/constant';\nimport { VIEW_LAYER_LIFE_CYCLE } from '../base/constants';\nvar DEFAULT_PADDING = 4;\nvar DEFAULT_SIZE = 8;\nvar DEFAULT_CATEGORY_SIZE = 32;\nvar MIN_THUMB_LENGTH = 20;\nvar SCROLL_BAR_Z_INDEX = 999;\nvar getValidScrollbarConfig = function (cfg) {\n    if (cfg === void 0) {\n        cfg = {};\n    }\n    var _cfg = __assign({ type: 'horizontal', categorySize: DEFAULT_CATEGORY_SIZE, width: DEFAULT_SIZE, height: DEFAULT_SIZE, padding: [0, 0, 0, 0] }, cfg);\n    if (!cfg.padding) {\n        _cfg.padding =\n            _cfg.type === 'horizontal' ? [DEFAULT_PADDING, 0, DEFAULT_PADDING, 0] : [0, DEFAULT_PADDING, 0, DEFAULT_PADDING];\n    }\n    return _cfg;\n};\nvar ScrollbarInteraction = (function (_super) {\n    __extends(ScrollbarInteraction, _super);\n    function ScrollbarInteraction() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.onChangeFn = throttle(_this.onChange.bind(_this), 20, {\n            leading: true,\n        });\n        return _this;\n    }\n    ScrollbarInteraction.getInteractionRange = function (layerRange, interaction) {\n        var config = getValidScrollbarConfig(interaction);\n        var _a = config.padding, paddingTop = _a[0], paddingRight = _a[1], paddingBottom = _a[2], paddingLeft = _a[3];\n        if (config.type === 'horizontal') {\n            return new BBox(layerRange.minX, layerRange.maxY - config.height - paddingTop - paddingBottom, layerRange.width, config.height + paddingTop + paddingBottom);\n        }\n        else {\n            return new BBox(layerRange.maxX - config.width - paddingLeft - paddingRight, layerRange.minY, config.width + paddingLeft + paddingRight, layerRange.height);\n        }\n    };\n    ScrollbarInteraction.prototype.render = function () {\n        var _this = this;\n        var layer = this.getViewLayer();\n        var view = this.view;\n        this.ratio = 0;\n        this.thumbOffset = 0;\n        var callback = function () {\n            var padding = _this.view.padding;\n            if (padding === 'auto' || isEqual(padding, [0, 0, 0, 1])) {\n                return;\n            }\n            if (!_this.trackLen) {\n                _this.measureScrollBar();\n                _this.changeViewData(_this.getScrollRange(), true);\n            }\n            else {\n                _this.renderScrollbar();\n            }\n        };\n        var changeDataCallback = function () {\n            _this.trackLen = 0;\n        };\n        view.on(VIEW_LIFE_CIRCLE.AFTER_PAINT, callback);\n        this.addDisposable(function () { return view.off(VIEW_LIFE_CIRCLE.AFTER_PAINT, callback); });\n        view.on(VIEW_LIFE_CIRCLE.AFTER_RENDER, callback);\n        this.addDisposable(function () { return view.off(VIEW_LIFE_CIRCLE.AFTER_RENDER, callback); });\n        layer.on(VIEW_LAYER_LIFE_CYCLE.BEFORE_CHANGE_DATA, changeDataCallback);\n        this.addDisposable(function () { return layer.off(VIEW_LAYER_LIFE_CYCLE.BEFORE_CHANGE_DATA, changeDataCallback); });\n    };\n    ScrollbarInteraction.prototype.start = function () {\n        return;\n    };\n    ScrollbarInteraction.prototype.clear = function () {\n        if (this.scrollbar) {\n            this.scrollbar.destroy();\n            this.scrollbar = null;\n        }\n        if (this.container) {\n            this.container.remove(true);\n            this.container = null;\n        }\n        this.trackLen = null;\n        this.thumbLen = null;\n    };\n    ScrollbarInteraction.prototype.renderScrollbar = function () {\n        var config = getValidScrollbarConfig(this.getInteractionConfig());\n        var range = this.getRange();\n        var isHorizontal = config.type !== 'vertical';\n        var panelRange = this.view.coordinateBBox;\n        var _a = config.padding, paddingTop = _a[0], paddingLeft = _a[3];\n        var position = isHorizontal\n            ? { x: panelRange.minX + paddingLeft, y: range.minY + paddingTop }\n            : { x: range.minX + paddingLeft, y: panelRange.minY + paddingTop };\n        if (!this.scrollbar) {\n            this.container = this.canvas.addGroup();\n            this.scrollbar = new Scrollbar({\n                container: this.container,\n                x: position.x,\n                y: position.y,\n                isHorizontal: isHorizontal,\n                trackLen: this.trackLen,\n                thumbLen: this.thumbLen,\n                thumbOffset: this.ratio * this.trackLen,\n            });\n            this.scrollbar.init();\n            this.scrollbar.render();\n            this.scrollbar.get('group').set('zIndex', SCROLL_BAR_Z_INDEX);\n            this.scrollbar.on('scrollchange', this.onChangeFn);\n        }\n        else {\n            this.scrollbar.update({\n                trackLen: this.trackLen,\n                thumbLen: this.thumbLen,\n                thumbOffset: this.thumbOffset,\n                x: position.x,\n                y: position.y,\n            });\n            this.scrollbar.render();\n        }\n    };\n    ScrollbarInteraction.prototype.measureScrollBar = function () {\n        var config = getValidScrollbarConfig(this.getInteractionConfig());\n        var _a = config.padding, paddingTop = _a[0], paddingRight = _a[1], paddingBottom = _a[2], paddingLeft = _a[3];\n        var isHorizontal = config.type !== 'vertical';\n        var panelRange = this.view.coordinateBBox;\n        var xScale = this.view.getXScale();\n        var yScales = this.view.getYScales().filter(function (scale) { return scale; });\n        this.cnt = xScale.values.length;\n        this.xScaleCfg = { field: xScale.field, values: xScale.values || [] };\n        this.yScalesCfg = yScales;\n        this.step = Math.floor((isHorizontal ? panelRange.width : panelRange.height) / config.categorySize);\n        this.trackLen = isHorizontal\n            ? panelRange.width - paddingLeft - paddingRight\n            : panelRange.height - paddingTop - paddingBottom;\n        this.thumbLen = Math.max(this.trackLen * clamp(this.step / xScale.values.length, 0, 1), MIN_THUMB_LENGTH);\n    };\n    ScrollbarInteraction.prototype.getScrollRange = function () {\n        var startIdx = Math.floor((this.cnt - this.step) * clamp(this.ratio, 0, 1));\n        var endIdx = Math.min(startIdx + this.step, this.cnt);\n        return [startIdx, endIdx];\n    };\n    ScrollbarInteraction.prototype.changeViewData = function (_a, render) {\n        var _this = this;\n        var startIdx = _a[0], endIdx = _a[1];\n        var config = getValidScrollbarConfig(this.getInteractionConfig());\n        var viewLayer = this.getViewLayer();\n        var meta = viewLayer.options.meta;\n        var origData = viewLayer.getData();\n        var newData = getDataByScaleRange(this.xScaleCfg.field, this.xScaleCfg.values, origData, [startIdx, endIdx], config.type === 'vertical');\n        this.yScalesCfg.forEach(function (cfg) {\n            var metaCfg = get(meta, cfg.field) || {};\n            _this.view.scale(cfg.field, __assign(__assign({ formatter: cfg.formatter }, metaCfg), { type: cfg.type, min: cfg.min, max: cfg.max }));\n        });\n        if (render) {\n            this.view.data(newData);\n            this.view.render();\n        }\n        else {\n            this.view.changeData(newData);\n        }\n    };\n    ScrollbarInteraction.prototype.onChange = function (_a) {\n        var ratio = _a.ratio, thumbOffset = _a.thumbOffset;\n        this.ratio = ratio;\n        this.thumbOffset = thumbOffset;\n        var origAnimate = this.view.getOptions().animate;\n        this.view.animate(false);\n        this.changeViewData(this.getScrollRange(), true);\n        this.view.animate(origAnimate);\n        this.renderScrollbar();\n    };\n    return ScrollbarInteraction;\n}(BaseInteraction));\nexport default ScrollbarInteraction;\n",{"version":3,"file":"/run/media/williamyh/新加卷/project/Deecamp-project/system/Web/node_modules/@antv/g2plot/esm/interaction/scrollbar.js","sourceRoot":"","sources":["/run/media/williamyh/新加卷/project/Deecamp-project/system/Web/node_modules/@antv/g2plot/esm/interaction/scrollbar.js"],"names":[],"mappings":"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","sourcesContent":["import { __assign, __extends } from \"tslib\";\nimport { Scrollbar } from '../dependents';\nimport BBox from '../util/bbox';\nimport { clamp, get, isEqual, throttle } from '@antv/util';\nimport BaseInteraction from './base';\nimport { getDataByScaleRange } from './helper/data-range';\nimport { VIEW_LIFE_CIRCLE } from '@antv/g2/lib/constant';\nimport { VIEW_LAYER_LIFE_CYCLE } from '../base/constants';\nvar DEFAULT_PADDING = 4;\nvar DEFAULT_SIZE = 8;\nvar DEFAULT_CATEGORY_SIZE = 32;\nvar MIN_THUMB_LENGTH = 20;\nvar SCROLL_BAR_Z_INDEX = 999;\nvar getValidScrollbarConfig = function (cfg) {\n    if (cfg === void 0) { cfg = {}; }\n    var _cfg = __assign({ type: 'horizontal', categorySize: DEFAULT_CATEGORY_SIZE, width: DEFAULT_SIZE, height: DEFAULT_SIZE, padding: [0, 0, 0, 0] }, cfg);\n    // default padding\n    if (!cfg.padding) {\n        _cfg.padding =\n            _cfg.type === 'horizontal' ? [DEFAULT_PADDING, 0, DEFAULT_PADDING, 0] : [0, DEFAULT_PADDING, 0, DEFAULT_PADDING];\n    }\n    return _cfg;\n};\nvar ScrollbarInteraction = /** @class */ (function (_super) {\n    __extends(ScrollbarInteraction, _super);\n    function ScrollbarInteraction() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.onChangeFn = throttle(_this.onChange.bind(_this), 20, {\n            leading: true,\n        });\n        return _this;\n    }\n    ScrollbarInteraction.getInteractionRange = function (layerRange, interaction) {\n        var config = getValidScrollbarConfig(interaction);\n        var _a = config.padding, paddingTop = _a[0], paddingRight = _a[1], paddingBottom = _a[2], paddingLeft = _a[3];\n        if (config.type === 'horizontal') {\n            return new BBox(layerRange.minX, layerRange.maxY - config.height - paddingTop - paddingBottom, layerRange.width, config.height + paddingTop + paddingBottom);\n        }\n        else {\n            return new BBox(layerRange.maxX - config.width - paddingLeft - paddingRight, layerRange.minY, config.width + paddingLeft + paddingRight, layerRange.height);\n        }\n    };\n    ScrollbarInteraction.prototype.render = function () {\n        var _this = this;\n        var layer = this.getViewLayer();\n        var view = this.view;\n        this.ratio = 0;\n        this.thumbOffset = 0;\n        var callback = function () {\n            var padding = _this.view.padding;\n            // if we're not in `auto padding` process\n            if (padding === 'auto' || isEqual(padding, [0, 0, 0, 1])) {\n                return;\n            }\n            if (!_this.trackLen) {\n                _this.measureScrollBar();\n                _this.changeViewData(_this.getScrollRange(), true);\n            }\n            else {\n                _this.renderScrollbar();\n            }\n        };\n        var changeDataCallback = function () {\n            // reset\n            _this.trackLen = 0;\n        };\n        view.on(VIEW_LIFE_CIRCLE.AFTER_PAINT, callback);\n        this.addDisposable(function () { return view.off(VIEW_LIFE_CIRCLE.AFTER_PAINT, callback); });\n        view.on(VIEW_LIFE_CIRCLE.AFTER_RENDER, callback);\n        this.addDisposable(function () { return view.off(VIEW_LIFE_CIRCLE.AFTER_RENDER, callback); });\n        layer.on(VIEW_LAYER_LIFE_CYCLE.BEFORE_CHANGE_DATA, changeDataCallback);\n        this.addDisposable(function () { return layer.off(VIEW_LAYER_LIFE_CYCLE.BEFORE_CHANGE_DATA, changeDataCallback); });\n    };\n    ScrollbarInteraction.prototype.start = function () {\n        return;\n    };\n    ScrollbarInteraction.prototype.clear = function () {\n        if (this.scrollbar) {\n            this.scrollbar.destroy();\n            this.scrollbar = null;\n        }\n        if (this.container) {\n            this.container.remove(true);\n            this.container = null;\n        }\n        this.trackLen = null;\n        this.thumbLen = null;\n    };\n    ScrollbarInteraction.prototype.renderScrollbar = function () {\n        var config = getValidScrollbarConfig(this.getInteractionConfig());\n        var range = this.getRange();\n        var isHorizontal = config.type !== 'vertical';\n        var panelRange = this.view.coordinateBBox;\n        var _a = config.padding, paddingTop = _a[0], paddingLeft = _a[3];\n        var position = isHorizontal\n            ? { x: panelRange.minX + paddingLeft, y: range.minY + paddingTop }\n            : { x: range.minX + paddingLeft, y: panelRange.minY + paddingTop };\n        if (!this.scrollbar) {\n            this.container = this.canvas.addGroup();\n            this.scrollbar = new Scrollbar({\n                container: this.container,\n                x: position.x,\n                y: position.y,\n                isHorizontal: isHorizontal,\n                trackLen: this.trackLen,\n                thumbLen: this.thumbLen,\n                thumbOffset: this.ratio * this.trackLen,\n            });\n            this.scrollbar.init();\n            this.scrollbar.render();\n            this.scrollbar.get('group').set('zIndex', SCROLL_BAR_Z_INDEX);\n            this.scrollbar.on('scrollchange', this.onChangeFn);\n        }\n        else {\n            this.scrollbar.update({\n                trackLen: this.trackLen,\n                thumbLen: this.thumbLen,\n                thumbOffset: this.thumbOffset,\n                x: position.x,\n                y: position.y,\n            });\n            this.scrollbar.render();\n        }\n    };\n    ScrollbarInteraction.prototype.measureScrollBar = function () {\n        var config = getValidScrollbarConfig(this.getInteractionConfig());\n        var _a = config.padding, paddingTop = _a[0], paddingRight = _a[1], paddingBottom = _a[2], paddingLeft = _a[3];\n        var isHorizontal = config.type !== 'vertical';\n        var panelRange = this.view.coordinateBBox;\n        var xScale = this.view.getXScale();\n        var yScales = this.view.getYScales().filter(function (scale) { return scale; });\n        this.cnt = xScale.values.length;\n        this.xScaleCfg = { field: xScale.field, values: xScale.values || [] };\n        this.yScalesCfg = yScales;\n        this.step = Math.floor((isHorizontal ? panelRange.width : panelRange.height) / config.categorySize);\n        this.trackLen = isHorizontal\n            ? panelRange.width - paddingLeft - paddingRight\n            : panelRange.height - paddingTop - paddingBottom;\n        this.thumbLen = Math.max(this.trackLen * clamp(this.step / xScale.values.length, 0, 1), MIN_THUMB_LENGTH);\n    };\n    ScrollbarInteraction.prototype.getScrollRange = function () {\n        var startIdx = Math.floor((this.cnt - this.step) * clamp(this.ratio, 0, 1));\n        var endIdx = Math.min(startIdx + this.step, this.cnt);\n        return [startIdx, endIdx];\n    };\n    ScrollbarInteraction.prototype.changeViewData = function (_a, render) {\n        var _this = this;\n        var startIdx = _a[0], endIdx = _a[1];\n        var config = getValidScrollbarConfig(this.getInteractionConfig());\n        var viewLayer = this.getViewLayer();\n        var meta = viewLayer.options.meta;\n        var origData = viewLayer.getData();\n        var newData = getDataByScaleRange(this.xScaleCfg.field, this.xScaleCfg.values, origData, [startIdx, endIdx], config.type === 'vertical');\n        // ScrollBar在滚动过程中保持\b\bY轴上scale配置: min/max/ticks\n        this.yScalesCfg.forEach(function (cfg) {\n            var metaCfg = get(meta, cfg.field) || {};\n            _this.view.scale(cfg.field, __assign(__assign({ formatter: cfg.formatter }, metaCfg), { type: cfg.type, min: cfg.min, max: cfg.max }));\n        });\n        if (render) {\n            this.view.data(newData);\n            this.view.render();\n        }\n        else {\n            this.view.changeData(newData);\n        }\n    };\n    ScrollbarInteraction.prototype.onChange = function (_a) {\n        var ratio = _a.ratio, thumbOffset = _a.thumbOffset;\n        this.ratio = ratio;\n        this.thumbOffset = thumbOffset;\n        var origAnimate = this.view.getOptions().animate;\n        this.view.animate(false);\n        this.changeViewData(this.getScrollRange(), true);\n        this.view.animate(origAnimate);\n        // update scrollbar\n        this.renderScrollbar();\n    };\n    return ScrollbarInteraction;\n}(BaseInteraction));\nexport default ScrollbarInteraction;\n//# sourceMappingURL=scrollbar.js.map"]}]}