{"remainingRequest":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\ts-loader\\index.js??ref--4-1!D:\\project\\Deecamp-project\\system\\Web\\node_modules\\@antv\\g2plot\\esm\\plots\\treemap\\interaction\\animation.js","dependencies":[{"path":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\@antv\\g2plot\\esm\\plots\\treemap\\interaction\\animation.js","mtime":499162500000},{"path":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1595520254649},{"path":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\ts-loader\\index.js","mtime":1537906253000}],"contextDependencies":[],"result":["import { each, clone, deepMix } from '@antv/util';\r\nimport { groupTransform, transform } from '../../../util/g-util';\r\nvar ulMatrix = [1, 0, 0, 0, 1, 0, 0, 0, 1];\r\nvar duration = 400;\r\nvar easing = 'easeQuadInOut';\r\nexport function drillingDown(target, view, callback) {\r\n    var rect = getRect(target);\r\n    var range = getRange(view);\r\n    var xRatio = range.width / rect.width;\r\n    var yRatio = range.height / rect.height;\r\n    var offsetX = (range.minX - rect.minX) * xRatio;\r\n    var offsetY = (range.minY - rect.minY) * yRatio;\r\n    var transformMatrix = transform([\r\n        ['s', xRatio, yRatio],\r\n        ['t', offsetX, offsetY],\r\n    ]);\r\n    var geometry = view.geometries[0];\r\n    hideLabel(geometry);\r\n    var tem_container = view.backgroundGroup.addGroup();\r\n    tem_container.set('zIndex', -100);\r\n    tem_container.setClip({\r\n        type: 'rect',\r\n        attrs: {\r\n            x: range.minX,\r\n            y: range.minY,\r\n            width: range.width,\r\n            height: range.height,\r\n        },\r\n    });\r\n    var tem_shapes = getTemShapes(geometry, tem_container);\r\n    geometry.container.set('visible', false);\r\n    view.canvas.draw();\r\n    callback();\r\n    window.setTimeout(function () {\r\n        each(tem_shapes, function (shape, index) {\r\n            if (index === 0) {\r\n                shape.animate({ matrix: transformMatrix }, duration, easing, function () {\r\n                    tem_container.remove();\r\n                    view.canvas.draw();\r\n                });\r\n            }\r\n            else {\r\n                shape.animate(transform, duration);\r\n            }\r\n        });\r\n        geometry = view.geometries[0];\r\n        hideLabel(geometry);\r\n        var shapes = geometry.getShapes();\r\n        each(shapes, function (shape) {\r\n            shape.attr('opacity', 0);\r\n            shape.animate({\r\n                opacity: 1,\r\n            }, duration, easing);\r\n        });\r\n        var container = geometry.container;\r\n        container.stopAnimate();\r\n        container.set('visible', true);\r\n        container.attr('matrix', clone(ulMatrix));\r\n        groupTransform(container, [\r\n            ['s', rect.width / range.width, rect.height / range.height],\r\n            ['t', rect.minX, rect.minY],\r\n        ]);\r\n        var matrix = clone(ulMatrix);\r\n        geometry.container.animate({\r\n            matrix: matrix,\r\n        }, duration, easing, function () {\r\n            showLabel(geometry);\r\n        });\r\n        view.canvas.draw();\r\n    }, 16);\r\n}\r\nfunction getTemShapes(geometry, container) {\r\n    var shapes = geometry.getShapes();\r\n    var tem_shapes = [];\r\n    each(shapes, function (shape) {\r\n        var s = container.addShape('path', {\r\n            attrs: deepMix({}, shape.attrs, { capture: false }),\r\n        });\r\n        tem_shapes.push(s);\r\n    });\r\n    return tem_shapes;\r\n}\r\nexport function rollingUp(name, view, callback) {\r\n    var geometry = view.geometries[0];\r\n    hideLabel(geometry);\r\n    var container = geometry.container;\r\n    container.attr('matrix', clone(ulMatrix));\r\n    var tem_container = view.backgroundGroup.addGroup();\r\n    tem_container.set('zIndex', -100);\r\n    var tem_shapes = getTemShapes(geometry, tem_container);\r\n    container.set('visible', false);\r\n    view.canvas.draw();\r\n    callback();\r\n    geometry = view.geometries[0];\r\n    hideLabel(geometry);\r\n    container = geometry.container;\r\n    var shape = findShapeByName(geometry.getShapes(), name);\r\n    var rect = getRect(shape);\r\n    var range = getRange(view);\r\n    var containerParent = container.get('parent');\r\n    if (!containerParent.get('clipShape')) {\r\n        container.setClip({\r\n            type: 'rect',\r\n            attrs: {\r\n                x: range.minX,\r\n                y: range.minY,\r\n                width: range.width,\r\n                height: range.height,\r\n            },\r\n        });\r\n    }\r\n    shrinkTemp(tem_container, tem_shapes, rect, range);\r\n    var xRatio = range.width / rect.width;\r\n    var yRatio = range.height / rect.height;\r\n    var offsetX = (range.minX - rect.minX) * xRatio;\r\n    var offsetY = (range.minY - rect.minY) * yRatio;\r\n    var transformMatrix = transform([\r\n        ['s', xRatio, yRatio],\r\n        ['t', offsetX, offsetY],\r\n    ]);\r\n    container.setMatrix(transformMatrix);\r\n    container.set('visible', true);\r\n    container.animate({\r\n        matrix: ulMatrix,\r\n    }, duration, easing, function () {\r\n        showLabel(geometry);\r\n    });\r\n}\r\nfunction findShapeByName(shapes, n) {\r\n    var shape;\r\n    each(shapes, function (s) {\r\n        var name = s.get('origin').data.name;\r\n        if (name === n) {\r\n            shape = s;\r\n        }\r\n    });\r\n    return shape;\r\n}\r\nfunction getRange(view) {\r\n    var viewRange = view.coordinateBBox;\r\n    var range = {\r\n        minX: viewRange.minX,\r\n        minY: viewRange.minY,\r\n        centerX: (viewRange.maxX - viewRange.minX) / 2,\r\n        centerY: (viewRange.maxY - viewRange.minY) / 2,\r\n        width: viewRange.width,\r\n        height: viewRange.height,\r\n    };\r\n    return range;\r\n}\r\nfunction getRect(shape) {\r\n    var path = shape.attr('path');\r\n    var x0 = path[0][1];\r\n    var y1 = path[0][2];\r\n    var x1 = path[1][1];\r\n    var y0 = path[2][2];\r\n    var rect = {\r\n        minX: x0,\r\n        minY: y0,\r\n        centerX: (x1 - x0) / 2,\r\n        centerY: (y1 - y0) / 2,\r\n        width: Math.abs(x1 - x0),\r\n        height: Math.abs(y1 - y0),\r\n    };\r\n    return rect;\r\n}\r\nfunction shrinkTemp(container, shapes, rect, range) {\r\n    var xRatio = rect.width / range.width;\r\n    var yRatio = rect.height / range.height;\r\n    var transformMatrix = transform([\r\n        ['s', xRatio, yRatio],\r\n        ['t', rect.minX, rect.minY],\r\n    ]);\r\n    container.animate({ matrix: transformMatrix }, duration, easing, function () {\r\n        container.remove();\r\n    });\r\n    each(shapes, function (shape) {\r\n        shape.animate({\r\n            opacity: 0,\r\n        }, duration, easing);\r\n    });\r\n}\r\nfunction hideLabel(geometry) {\r\n    var labelContainer = geometry.labelsContainer;\r\n    labelContainer.set('visible', false);\r\n}\r\nfunction showLabel(geometry) {\r\n    var labelContainer = geometry.labelsContainer;\r\n    labelContainer.set('visible', true);\r\n}\r\n",{"version":3,"file":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\@antv\\g2plot\\esm\\plots\\treemap\\interaction\\animation.js","sourceRoot":"","sources":["D:\\project\\Deecamp-project\\system\\Web\\node_modules\\@antv\\g2plot\\esm\\plots\\treemap\\interaction\\animation.js"],"names":[],"mappings":"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","sourcesContent":["import { each, clone, deepMix } from '@antv/util';\nimport { groupTransform, transform } from '../../../util/g-util';\nvar ulMatrix = [1, 0, 0, 0, 1, 0, 0, 0, 1];\nvar duration = 400;\nvar easing = 'easeQuadInOut';\nexport function drillingDown(target, view, callback) {\n    var rect = getRect(target);\n    var range = getRange(view);\n    var xRatio = range.width / rect.width;\n    var yRatio = range.height / rect.height;\n    var offsetX = (range.minX - rect.minX) * xRatio;\n    var offsetY = (range.minY - rect.minY) * yRatio;\n    var transformMatrix = transform([\n        ['s', xRatio, yRatio],\n        ['t', offsetX, offsetY],\n    ]);\n    var geometry = view.geometries[0];\n    hideLabel(geometry);\n    var tem_container = view.backgroundGroup.addGroup();\n    tem_container.set('zIndex', -100);\n    tem_container.setClip({\n        type: 'rect',\n        attrs: {\n            x: range.minX,\n            y: range.minY,\n            width: range.width,\n            height: range.height,\n        },\n    });\n    var tem_shapes = getTemShapes(geometry, tem_container);\n    geometry.container.set('visible', false);\n    view.canvas.draw();\n    callback();\n    window.setTimeout(function () {\n        each(tem_shapes, function (shape, index) {\n            if (index === 0) {\n                shape.animate({ matrix: transformMatrix }, duration, easing, function () {\n                    tem_container.remove();\n                    view.canvas.draw();\n                });\n            }\n            else {\n                shape.animate(transform, duration);\n            }\n        });\n        geometry = view.geometries[0];\n        hideLabel(geometry);\n        var shapes = geometry.getShapes();\n        each(shapes, function (shape) {\n            shape.attr('opacity', 0);\n            shape.animate({\n                opacity: 1,\n            }, duration, easing);\n        });\n        var container = geometry.container;\n        container.stopAnimate();\n        container.set('visible', true);\n        container.attr('matrix', clone(ulMatrix));\n        groupTransform(container, [\n            ['s', rect.width / range.width, rect.height / range.height],\n            ['t', rect.minX, rect.minY],\n        ]);\n        var matrix = clone(ulMatrix);\n        geometry.container.animate({\n            matrix: matrix,\n        }, duration, easing, function () {\n            showLabel(geometry);\n        });\n        view.canvas.draw();\n    }, 16);\n}\nfunction getTemShapes(geometry, container) {\n    var shapes = geometry.getShapes();\n    var tem_shapes = [];\n    each(shapes, function (shape) {\n        var s = container.addShape('path', {\n            attrs: deepMix({}, shape.attrs, { capture: false }),\n        });\n        tem_shapes.push(s);\n    });\n    return tem_shapes;\n}\nexport function rollingUp(name, view, callback) {\n    var geometry = view.geometries[0];\n    hideLabel(geometry);\n    var container = geometry.container;\n    container.attr('matrix', clone(ulMatrix));\n    var tem_container = view.backgroundGroup.addGroup();\n    tem_container.set('zIndex', -100);\n    var tem_shapes = getTemShapes(geometry, tem_container);\n    container.set('visible', false);\n    view.canvas.draw();\n    callback();\n    geometry = view.geometries[0];\n    hideLabel(geometry);\n    container = geometry.container;\n    var shape = findShapeByName(geometry.getShapes(), name); //根据name获得上一级shape\n    var rect = getRect(shape);\n    var range = getRange(view);\n    var containerParent = container.get('parent');\n    if (!containerParent.get('clipShape')) {\n        container.setClip({\n            type: 'rect',\n            attrs: {\n                x: range.minX,\n                y: range.minY,\n                width: range.width,\n                height: range.height,\n            },\n        });\n    }\n    shrinkTemp(tem_container, tem_shapes, rect, range);\n    var xRatio = range.width / rect.width;\n    var yRatio = range.height / rect.height;\n    var offsetX = (range.minX - rect.minX) * xRatio;\n    var offsetY = (range.minY - rect.minY) * yRatio;\n    var transformMatrix = transform([\n        ['s', xRatio, yRatio],\n        ['t', offsetX, offsetY],\n    ]);\n    container.setMatrix(transformMatrix);\n    container.set('visible', true);\n    container.animate({\n        matrix: ulMatrix,\n    }, duration, easing, function () {\n        showLabel(geometry);\n    });\n}\nfunction findShapeByName(shapes, n) {\n    var shape;\n    each(shapes, function (s) {\n        var name = s.get('origin').data.name;\n        if (name === n) {\n            shape = s;\n        }\n    });\n    return shape;\n}\nfunction getRange(view) {\n    var viewRange = view.coordinateBBox;\n    var range = {\n        minX: viewRange.minX,\n        minY: viewRange.minY,\n        centerX: (viewRange.maxX - viewRange.minX) / 2,\n        centerY: (viewRange.maxY - viewRange.minY) / 2,\n        width: viewRange.width,\n        height: viewRange.height,\n    };\n    return range;\n}\nfunction getRect(shape) {\n    var path = shape.attr('path');\n    var x0 = path[0][1];\n    var y1 = path[0][2];\n    var x1 = path[1][1];\n    var y0 = path[2][2];\n    var rect = {\n        minX: x0,\n        minY: y0,\n        centerX: (x1 - x0) / 2,\n        centerY: (y1 - y0) / 2,\n        width: Math.abs(x1 - x0),\n        height: Math.abs(y1 - y0),\n    };\n    return rect;\n}\nfunction shrinkTemp(container, shapes, rect, range) {\n    var xRatio = rect.width / range.width;\n    var yRatio = rect.height / range.height;\n    var transformMatrix = transform([\n        ['s', xRatio, yRatio],\n        ['t', rect.minX, rect.minY],\n    ]);\n    container.animate({ matrix: transformMatrix }, duration, easing, function () {\n        container.remove();\n    });\n    each(shapes, function (shape) {\n        shape.animate({\n            opacity: 0,\n        }, duration, easing);\n    });\n}\nfunction hideLabel(geometry) {\n    var labelContainer = geometry.labelsContainer;\n    labelContainer.set('visible', false);\n}\nfunction showLabel(geometry) {\n    var labelContainer = geometry.labelsContainer;\n    labelContainer.set('visible', true);\n}\n//# sourceMappingURL=animation.js.map"]}]}