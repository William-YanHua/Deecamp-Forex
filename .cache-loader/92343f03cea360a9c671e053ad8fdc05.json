{"remainingRequest":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\ts-loader\\index.js??ref--4-1!D:\\project\\Deecamp-project\\system\\Web\\node_modules\\@antv\\g2-plugin-slider\\src\\index.js","dependencies":[{"path":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\@antv\\g2-plugin-slider\\src\\index.js","mtime":499162500000},{"path":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1595520254649},{"path":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\ts-loader\\index.js","mtime":1537906253000}],"contextDependencies":[],"result":["var Range = require('./component/range');\r\nvar G2 = window && window.G2;\r\nvar Chart = G2.Chart, Util = G2.Util, G = G2.G, Global = G2.Global;\r\nvar Canvas = G.Canvas;\r\nvar DomUtil = Util.DomUtil;\r\nvar isNumber = function (val) { return typeof val === 'number'; };\r\nvar Slider = (function () {\r\n    function Slider(cfg) {\r\n        this._initProps();\r\n        Util.deepMix(this, cfg);\r\n        var container = this.container;\r\n        if (!container) {\r\n            throw new Error('Please specify the container for the Slider!');\r\n        }\r\n        if (Util.isString(container)) {\r\n            this.domContainer = document.getElementById(container);\r\n        }\r\n        else {\r\n            this.domContainer = container;\r\n        }\r\n        this.handleStyle = Util.mix({\r\n            width: this.height,\r\n            height: this.height\r\n        }, this.handleStyle);\r\n        if (this.width === 'auto') {\r\n            window.addEventListener('resize', Util.wrapBehavior(this, '_initForceFitEvent'));\r\n        }\r\n    }\r\n    Slider.prototype._initProps = function () {\r\n        this.height = 26;\r\n        this.width = 'auto';\r\n        this.padding = Global.plotCfg.padding;\r\n        this.container = null;\r\n        this.xAxis = null;\r\n        this.yAxis = null;\r\n        this.fillerStyle = {\r\n            fill: '#BDCCED',\r\n            fillOpacity: 0.3\r\n        };\r\n        this.backgroundStyle = {\r\n            stroke: '#CCD6EC',\r\n            fill: '#CCD6EC',\r\n            fillOpacity: 0.3,\r\n            lineWidth: 1\r\n        };\r\n        this.range = [0, 100];\r\n        this.layout = 'horizontal';\r\n        this.textStyle = {\r\n            fill: '#545454'\r\n        };\r\n        this.handleStyle = {\r\n            img: 'https://gw.alipayobjects.com/zos/rmsportal/QXtfhORGlDuRvLXFzpsQ.png',\r\n            width: 5\r\n        };\r\n        this.backgroundChart = {\r\n            type: ['area'],\r\n            color: '#CCD6EC'\r\n        };\r\n    };\r\n    Slider.prototype._initForceFitEvent = function () {\r\n        var timer = setTimeout(Util.wrapBehavior(this, 'forceFit'), 200);\r\n        clearTimeout(this.resizeTimer);\r\n        this.resizeTimer = timer;\r\n    };\r\n    Slider.prototype.forceFit = function () {\r\n        if (!this || this.destroyed) {\r\n            return;\r\n        }\r\n        var width = DomUtil.getWidth(this.domContainer);\r\n        var height = this.height;\r\n        if (width !== this.domWidth) {\r\n            var canvas = this.canvas;\r\n            canvas.changeSize(width, height);\r\n            this.bgChart && this.bgChart.changeWidth(width);\r\n            canvas.clear();\r\n            this._initWidth();\r\n            this._initSlider();\r\n            this._bindEvent();\r\n            canvas.draw();\r\n        }\r\n    };\r\n    Slider.prototype._initWidth = function () {\r\n        var width;\r\n        if (this.width === 'auto') {\r\n            width = DomUtil.getWidth(this.domContainer);\r\n        }\r\n        else {\r\n            width = this.width;\r\n        }\r\n        this.domWidth = width;\r\n        var padding = Util.toAllPadding(this.padding);\r\n        if (this.layout === 'horizontal') {\r\n            this.plotWidth = width - padding[1] - padding[3];\r\n            this.plotPadding = padding[3];\r\n            this.plotHeight = this.height;\r\n        }\r\n        else if (this.layout === 'vertical') {\r\n            this.plotWidth = this.width;\r\n            this.plotHeight = this.height - padding[0] - padding[2];\r\n            this.plotPadding = padding[0];\r\n        }\r\n    };\r\n    Slider.prototype.render = function () {\r\n        this._initWidth();\r\n        this._initCanvas();\r\n        this._initBackground();\r\n        this._initSlider();\r\n        this._bindEvent();\r\n        this.canvas.draw();\r\n    };\r\n    Slider.prototype.changeData = function (data) {\r\n        this.data = data;\r\n        this.repaint();\r\n    };\r\n    Slider.prototype.destroy = function () {\r\n        clearTimeout(this.resizeTimer);\r\n        var rangeElement = this.rangeElement;\r\n        rangeElement.off('sliderchange');\r\n        this.bgChart && this.bgChart.destroy();\r\n        this.canvas.destroy();\r\n        var container = this.domContainer;\r\n        while (container.hasChildNodes()) {\r\n            container.removeChild(container.firstChild);\r\n        }\r\n        window.removeEventListener('resize', Util.getWrapBehavior(this, '_initForceFitEvent'));\r\n        this.destroyed = true;\r\n    };\r\n    Slider.prototype.clear = function () {\r\n        this.canvas.clear();\r\n        this.bgChart && this.bgChart.destroy();\r\n        this.bgChart = null;\r\n        this.scale = null;\r\n        this.canvas.draw();\r\n    };\r\n    Slider.prototype.repaint = function () {\r\n        this.clear();\r\n        this.render();\r\n    };\r\n    Slider.prototype._initCanvas = function () {\r\n        var width = this.domWidth;\r\n        var height = this.height;\r\n        var canvas = new Canvas({\r\n            width: width,\r\n            height: height,\r\n            containerDOM: this.domContainer,\r\n            capture: false\r\n        });\r\n        var node = canvas.get('el');\r\n        node.style.position = 'absolute';\r\n        node.style.top = 0;\r\n        node.style.left = 0;\r\n        node.style.zIndex = 3;\r\n        this.canvas = canvas;\r\n    };\r\n    Slider.prototype._initBackground = function () {\r\n        var _a;\r\n        var data = this.data;\r\n        var xAxis = this.xAxis;\r\n        var yAxis = this.yAxis;\r\n        var scales = Util.deepMix((_a = {},\r\n            _a[\"\" + xAxis] = {\r\n                range: [0, 1]\r\n            },\r\n            _a), this.scales);\r\n        if (!data) {\r\n            throw new Error('Please specify the data!');\r\n        }\r\n        if (!xAxis) {\r\n            throw new Error('Please specify the xAxis!');\r\n        }\r\n        if (!yAxis) {\r\n            throw new Error('Please specify the yAxis!');\r\n        }\r\n        var backgroundChart = this.backgroundChart;\r\n        var type = backgroundChart.type;\r\n        var color = backgroundChart.color;\r\n        if (!Util.isArray(type)) {\r\n            type = [type];\r\n        }\r\n        var padding = Util.toAllPadding(this.padding);\r\n        var bgChart = new Chart({\r\n            container: this.container,\r\n            width: this.domWidth,\r\n            height: this.height,\r\n            padding: [0, padding[1], 0, padding[3]],\r\n            animate: false\r\n        });\r\n        bgChart.source(data);\r\n        bgChart.scale(scales);\r\n        bgChart.axis(false);\r\n        bgChart.tooltip(false);\r\n        bgChart.legend(false);\r\n        Util.each(type, function (eachType) {\r\n            bgChart[eachType]()\r\n                .position(xAxis + '*' + yAxis)\r\n                .color(color)\r\n                .opacity(1);\r\n        });\r\n        bgChart.render();\r\n        this.bgChart = bgChart;\r\n        this.scale = this.layout === 'horizontal' ? bgChart.getXScale() : bgChart.getYScales()[0];\r\n        if (this.layout === 'vertical') {\r\n            bgChart.destroy();\r\n        }\r\n    };\r\n    Slider.prototype._initRange = function () {\r\n        var startRadio = this.startRadio;\r\n        var endRadio = this.endRadio;\r\n        var start = this.start;\r\n        var end = this.end;\r\n        var scale = this.scale;\r\n        var min = 0;\r\n        var max = 1;\r\n        if (isNumber(startRadio)) {\r\n            min = startRadio;\r\n        }\r\n        else if (start) {\r\n            min = scale.scale(scale.translate(start));\r\n        }\r\n        if (isNumber(endRadio)) {\r\n            max = endRadio;\r\n        }\r\n        else if (end) {\r\n            max = scale.scale(scale.translate(end));\r\n        }\r\n        var _a = this, minSpan = _a.minSpan, maxSpan = _a.maxSpan;\r\n        var totalSpan = 0;\r\n        if (scale.type === 'time' || scale.type === 'timeCat') {\r\n            var values = scale.values;\r\n            var firstValue = values[0];\r\n            var lastValue = values[values.length - 1];\r\n            totalSpan = lastValue - firstValue;\r\n        }\r\n        else if (scale.isLinear) {\r\n            totalSpan = scale.max - scale.min;\r\n        }\r\n        if (totalSpan && minSpan) {\r\n            this.minRange = (minSpan / totalSpan) * 100;\r\n        }\r\n        if (totalSpan && maxSpan) {\r\n            this.maxRange = (maxSpan / totalSpan) * 100;\r\n        }\r\n        var range = [min * 100, max * 100];\r\n        this.range = range;\r\n        return range;\r\n    };\r\n    Slider.prototype._getHandleValue = function (type) {\r\n        var value;\r\n        var range = this.range;\r\n        var min = range[0] / 100;\r\n        var max = range[1] / 100;\r\n        var scale = this.scale;\r\n        if (type === 'min') {\r\n            value = this.start ? this.start : scale.invert(min);\r\n        }\r\n        else {\r\n            value = this.end ? this.end : scale.invert(max);\r\n        }\r\n        return value;\r\n    };\r\n    Slider.prototype._initSlider = function () {\r\n        var canvas = this.canvas;\r\n        var range = this._initRange();\r\n        var scale = this.scale;\r\n        var rangeElement = canvas.addGroup(Range, {\r\n            middleAttr: this.fillerStyle,\r\n            range: range,\r\n            minRange: this.minRange,\r\n            maxRange: this.maxRange,\r\n            layout: this.layout,\r\n            width: this.plotWidth,\r\n            height: this.plotHeight,\r\n            backgroundStyle: this.backgroundStyle,\r\n            textStyle: this.textStyle,\r\n            handleStyle: this.handleStyle,\r\n            minText: scale.getText(this._getHandleValue('min')),\r\n            maxText: scale.getText(this._getHandleValue('max'))\r\n        });\r\n        if (this.layout === 'horizontal') {\r\n            rangeElement.translate(this.plotPadding, 0);\r\n        }\r\n        else if (this.layout === 'vertical') {\r\n            rangeElement.translate(0, this.plotPadding);\r\n        }\r\n        this.rangeElement = rangeElement;\r\n    };\r\n    Slider.prototype._bindEvent = function () {\r\n        var self = this;\r\n        var rangeElement = self.rangeElement;\r\n        rangeElement.on('sliderchange', function (ev) {\r\n            var range = ev.range;\r\n            var minRatio = range[0] / 100;\r\n            var maxRatio = range[1] / 100;\r\n            self._updateElement(minRatio, maxRatio);\r\n        });\r\n    };\r\n    Slider.prototype._updateElement = function (minRatio, maxRatio) {\r\n        var scale = this.scale;\r\n        var rangeElement = this.rangeElement;\r\n        var minTextElement = rangeElement.get('minTextElement');\r\n        var maxTextElement = rangeElement.get('maxTextElement');\r\n        var min = scale.invert(minRatio);\r\n        var max = scale.invert(maxRatio);\r\n        var minText = scale.getText(min);\r\n        var maxText = scale.getText(max);\r\n        minTextElement.attr('text', minText);\r\n        maxTextElement.attr('text', maxText);\r\n        this.start = minText;\r\n        this.end = maxText;\r\n        if (this.onChange) {\r\n            this.onChange({\r\n                startText: minText,\r\n                endText: maxText,\r\n                startValue: min,\r\n                endValue: max,\r\n                startRadio: minRatio,\r\n                endRadio: maxRatio\r\n            });\r\n        }\r\n    };\r\n    return Slider;\r\n}());\r\nmodule.exports = Slider;\r\n",{"version":3,"file":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\@antv\\g2-plugin-slider\\src\\index.js","sourceRoot":"","sources":["D:\\project\\Deecamp-project\\system\\Web\\node_modules\\@antv\\g2-plugin-slider\\src\\index.js"],"names":[],"mappings":"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","sourcesContent":["/**\n * @fileOverview G2's plugin for datazoom.\n * @author sima.zhang\n */\nconst Range = require('./component/range');\n\nconst G2 = window && window.G2;\nconst { Chart, Util, G, Global } = G2;\nconst { Canvas } = G;\nconst { DomUtil } = Util;\n\nconst isNumber = val => typeof val === 'number';\n\nclass Slider {\n  _initProps() {\n    this.height = 26;\n    this.width = 'auto'; // 默认自适应\n    this.padding = Global.plotCfg.padding;\n    this.container = null;\n    this.xAxis = null;\n    this.yAxis = null;\n    // 选中区域的样式\n    this.fillerStyle = {\n      fill: '#BDCCED',\n      fillOpacity: 0.3\n    };\n    // 滑动条背景样式\n    this.backgroundStyle = {\n      stroke: '#CCD6EC',\n      fill: '#CCD6EC',\n      fillOpacity: 0.3,\n      lineWidth: 1\n    };\n    this.range = [ 0, 100 ];\n    this.layout = 'horizontal';\n    // 文本颜色\n    this.textStyle = {\n      fill: '#545454'\n    };\n    // 滑块的样式\n    this.handleStyle = {\n      img: 'https://gw.alipayobjects.com/zos/rmsportal/QXtfhORGlDuRvLXFzpsQ.png',\n      width: 5\n    };\n    // 背景图表的配置，如果为 false 则表示不渲染\n    this.backgroundChart = {\n      type: [ 'area' ], // 图表的类型，可以是字符串也可是是数组\n      color: '#CCD6EC'\n    };\n  }\n\n  constructor(cfg) {\n    this._initProps();\n    Util.deepMix(this, cfg);\n    const container = this.container;\n    if (!container) {\n      throw new Error('Please specify the container for the Slider!');\n    }\n    if (Util.isString(container)) {\n      this.domContainer = document.getElementById(container);\n    } else {\n      this.domContainer = container;\n    }\n\n    this.handleStyle = Util.mix({\n      width: this.height,\n      height: this.height\n    }, this.handleStyle);\n    if (this.width === 'auto') { // 宽度自适应\n      window.addEventListener('resize', Util.wrapBehavior(this, '_initForceFitEvent'));\n    }\n  }\n\n  _initForceFitEvent() {\n    const timer = setTimeout(Util.wrapBehavior(this, 'forceFit'), 200);\n    clearTimeout(this.resizeTimer);\n    this.resizeTimer = timer;\n  }\n\n  forceFit() {\n    if (!this || this.destroyed) {\n      return;\n    }\n    const width = DomUtil.getWidth(this.domContainer);\n    const height = this.height;\n    if (width !== this.domWidth) {\n      const canvas = this.canvas;\n      canvas.changeSize(width, height); // 改变画布尺寸\n      this.bgChart && this.bgChart.changeWidth(width);\n      canvas.clear();\n      this._initWidth();\n      this._initSlider(); // 初始化滑动条\n      this._bindEvent();\n      canvas.draw();\n    }\n  }\n\n  _initWidth() {\n    let width;\n    if (this.width === 'auto') {\n      width = DomUtil.getWidth(this.domContainer);\n    } else {\n      width = this.width;\n    }\n    this.domWidth = width;\n    const padding = Util.toAllPadding(this.padding);\n\n    if (this.layout === 'horizontal') {\n      this.plotWidth = width - padding[1] - padding[3];\n      this.plotPadding = padding[3];\n      this.plotHeight = this.height;\n    } else if (this.layout === 'vertical') {\n      this.plotWidth = this.width;\n      this.plotHeight = this.height - padding[0] - padding[2];\n      this.plotPadding = padding[0];\n    }\n  }\n\n  render() {\n    this._initWidth();\n    this._initCanvas(); // 初始化 canvas\n    this._initBackground(); // 初始化背景图表\n    this._initSlider(); // 初始化滑动条\n    this._bindEvent();\n    this.canvas.draw();\n  }\n\n  changeData(data) {\n    this.data = data;\n    this.repaint();\n  }\n\n  destroy() {\n    clearTimeout(this.resizeTimer);\n    const rangeElement = this.rangeElement;\n    rangeElement.off('sliderchange');\n    this.bgChart && this.bgChart.destroy();\n    this.canvas.destroy();\n    const container = this.domContainer;\n    while (container.hasChildNodes()) {\n      container.removeChild(container.firstChild);\n    }\n    window.removeEventListener('resize', Util.getWrapBehavior(this, '_initForceFitEvent'));\n    this.destroyed = true;\n  }\n\n  clear() {\n    this.canvas.clear();\n    this.bgChart && this.bgChart.destroy();\n    this.bgChart = null;\n    this.scale = null;\n    this.canvas.draw();\n  }\n\n  repaint() {\n    this.clear();\n    this.render();\n  }\n\n  _initCanvas() {\n    const width = this.domWidth;\n    const height = this.height;\n    const canvas = new Canvas({\n      width,\n      height,\n      containerDOM: this.domContainer,\n      capture: false\n    });\n    const node = canvas.get('el');\n    node.style.position = 'absolute';\n    node.style.top = 0;\n    node.style.left = 0;\n    node.style.zIndex = 3;\n    this.canvas = canvas;\n  }\n\n  _initBackground() {\n    const data = this.data;\n    const xAxis = this.xAxis;\n    const yAxis = this.yAxis;\n    const scales = Util.deepMix({\n      [`${xAxis}`]: {\n        range: [ 0, 1 ]\n      }\n    }, this.scales); // 用户列定义\n    if (!data) { // 没有数据，则不创建\n      throw new Error('Please specify the data!');\n    }\n    if (!xAxis) {\n      throw new Error('Please specify the xAxis!');\n    }\n    if (!yAxis) {\n      throw new Error('Please specify the yAxis!');\n    }\n\n    const backgroundChart = this.backgroundChart;\n    let type = backgroundChart.type;\n    const color = backgroundChart.color;\n    if (!Util.isArray(type)) {\n      type = [ type ];\n    }\n\n    const padding = Util.toAllPadding(this.padding);\n    const bgChart = new Chart({\n      container: this.container,\n      width: this.domWidth,\n      height: this.height,\n      padding: [ 0, padding[1], 0, padding[3] ],\n      animate: false\n    });\n    bgChart.source(data);\n    bgChart.scale(scales);\n    bgChart.axis(false);\n    bgChart.tooltip(false);\n    bgChart.legend(false);\n    Util.each(type, eachType => {\n      bgChart[eachType]()\n        .position(xAxis + '*' + yAxis)\n        .color(color)\n        .opacity(1);\n    });\n    bgChart.render();\n    this.bgChart = bgChart;\n    this.scale = this.layout === 'horizontal' ? bgChart.getXScale() : bgChart.getYScales()[0];\n    if (this.layout === 'vertical') {\n      bgChart.destroy();\n    }\n  }\n\n  _initRange() {\n    const startRadio = this.startRadio;\n    const endRadio = this.endRadio;\n    const start = this.start;\n    const end = this.end;\n    const scale = this.scale;\n    let min = 0;\n    let max = 1;\n\n    // startRadio 优先级高于 start\n    if (isNumber(startRadio)) {\n      min = startRadio;\n    } else if (start) {\n      min = scale.scale(scale.translate(start));\n    }\n\n    // endRadio 优先级高于 end\n    if (isNumber(endRadio)) {\n      max = endRadio;\n    } else if (end) {\n      max = scale.scale(scale.translate(end));\n    }\n\n    const { minSpan, maxSpan } = this;\n    let totalSpan = 0;\n    if (scale.type === 'time' || scale.type === 'timeCat') { // 时间类型已排序\n      const values = scale.values;\n      const firstValue = values[0];\n      const lastValue = values[values.length - 1];\n      totalSpan = lastValue - firstValue;\n    } else if (scale.isLinear) {\n      totalSpan = scale.max - scale.min;\n    }\n\n    if (totalSpan && minSpan) {\n      this.minRange = (minSpan / totalSpan) * 100;\n    }\n\n    if (totalSpan && maxSpan) {\n      this.maxRange = (maxSpan / totalSpan) * 100;\n    }\n\n    const range = [ min * 100, max * 100 ];\n    this.range = range;\n    return range;\n  }\n\n  _getHandleValue(type) {\n    let value;\n    const range = this.range;\n    const min = range[0] / 100;\n    const max = range[1] / 100;\n    const scale = this.scale;\n    if (type === 'min') {\n      value = this.start ? this.start : scale.invert(min);\n    } else {\n      value = this.end ? this.end : scale.invert(max);\n    }\n    return value;\n  }\n\n  _initSlider() {\n    const canvas = this.canvas;\n    const range = this._initRange();\n    const scale = this.scale;\n    const rangeElement = canvas.addGroup(Range, {\n      middleAttr: this.fillerStyle,\n      range,\n      minRange: this.minRange,\n      maxRange: this.maxRange,\n      layout: this.layout,\n      width: this.plotWidth,\n      height: this.plotHeight,\n      backgroundStyle: this.backgroundStyle,\n      textStyle: this.textStyle,\n      handleStyle: this.handleStyle,\n      minText: scale.getText(this._getHandleValue('min')),\n      maxText: scale.getText(this._getHandleValue('max'))\n    });\n    if (this.layout === 'horizontal') {\n      rangeElement.translate(this.plotPadding, 0);\n    } else if (this.layout === 'vertical') {\n      rangeElement.translate(0, this.plotPadding);\n    }\n    this.rangeElement = rangeElement;\n  }\n\n  _bindEvent() {\n    const self = this;\n    const rangeElement = self.rangeElement;\n    rangeElement.on('sliderchange', function(ev) {\n      const range = ev.range;\n      const minRatio = range[0] / 100;\n      const maxRatio = range[1] / 100;\n      self._updateElement(minRatio, maxRatio);\n    });\n  }\n\n  _updateElement(minRatio, maxRatio) {\n    const scale = this.scale;\n    const rangeElement = this.rangeElement;\n    const minTextElement = rangeElement.get('minTextElement');\n    const maxTextElement = rangeElement.get('maxTextElement');\n    const min = scale.invert(minRatio);\n    const max = scale.invert(maxRatio);\n    const minText = scale.getText(min);\n    const maxText = scale.getText(max);\n    minTextElement.attr('text', minText);\n    maxTextElement.attr('text', maxText);\n\n    this.start = minText;\n    this.end = maxText;\n\n    if (this.onChange) {\n      this.onChange({\n        startText: minText,\n        endText: maxText,\n        startValue: min,\n        endValue: max,\n        startRadio: minRatio,\n        endRadio: maxRatio\n      });\n    }\n  }\n}\n\nmodule.exports = Slider;\n"]}]}