{"remainingRequest":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\ts-loader\\index.js??ref--4-1!D:\\project\\Deecamp-project\\system\\Web\\node_modules\\@antv\\g\\lib\\core\\group.js","dependencies":[{"path":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\@antv\\g\\lib\\core\\group.js","mtime":499162500000},{"path":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1595520254649},{"path":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\ts-loader\\index.js","mtime":1537906253000}],"contextDependencies":[],"result":["var Util = require('../util/index');\r\nvar Element = require('./element');\r\nvar Shape = require('../shapes/index');\r\nvar SHAPE_MAP = {};\r\nvar INDEX = '_INDEX';\r\nfunction getComparer(compare) {\r\n    return function (left, right) {\r\n        var result = compare(left, right);\r\n        return result === 0 ? left[INDEX] - right[INDEX] : result;\r\n    };\r\n}\r\nfunction find(children, x, y) {\r\n    var rst;\r\n    for (var i = children.length - 1; i >= 0; i--) {\r\n        var child = children[i];\r\n        if (child._cfg.visible && child._cfg.capture) {\r\n            if (child.isGroup) {\r\n                rst = child.getShape(x, y);\r\n            }\r\n            else if (child.isHit(x, y)) {\r\n                rst = child;\r\n            }\r\n        }\r\n        if (rst) {\r\n            break;\r\n        }\r\n    }\r\n    return rst;\r\n}\r\nvar Group = function Group(cfg) {\r\n    Group.superclass.constructor.call(this, cfg);\r\n    this.set('children', []);\r\n    this.set('tobeRemoved', []);\r\n    this._beforeRenderUI();\r\n    this._renderUI();\r\n    this._bindUI();\r\n};\r\nfunction initClassCfgs(c) {\r\n    if (c._cfg || c === Group) {\r\n        return;\r\n    }\r\n    var superCon = c.superclass.constructor;\r\n    if (superCon && !superCon._cfg) {\r\n        initClassCfgs(superCon);\r\n    }\r\n    c._cfg = {};\r\n    Util.merge(c._cfg, superCon._cfg);\r\n    Util.merge(c._cfg, c.CFG);\r\n}\r\nUtil.extend(Group, Element);\r\nUtil.augment(Group, {\r\n    isGroup: true,\r\n    type: 'group',\r\n    canFill: true,\r\n    canStroke: true,\r\n    getDefaultCfg: function getDefaultCfg() {\r\n        initClassCfgs(this.constructor);\r\n        return Util.merge({}, this.constructor._cfg);\r\n    },\r\n    _beforeRenderUI: function _beforeRenderUI() { },\r\n    _renderUI: function _renderUI() { },\r\n    _bindUI: function _bindUI() { },\r\n    addShape: function addShape(type, cfg) {\r\n        var canvas = this.get('canvas');\r\n        cfg = cfg || {};\r\n        var shapeType = SHAPE_MAP[type];\r\n        if (!shapeType) {\r\n            shapeType = Util.upperFirst(type);\r\n            SHAPE_MAP[type] = shapeType;\r\n        }\r\n        if (cfg.attrs && canvas) {\r\n            var attrs = cfg.attrs;\r\n            if (type === 'text') {\r\n                var topFontFamily = canvas.get('fontFamily');\r\n                if (topFontFamily) {\r\n                    attrs.fontFamily = attrs.fontFamily ? attrs.fontFamily : topFontFamily;\r\n                }\r\n            }\r\n        }\r\n        cfg.canvas = canvas;\r\n        cfg.type = type;\r\n        var rst = new Shape[shapeType](cfg);\r\n        this.add(rst);\r\n        return rst;\r\n    },\r\n    addGroup: function addGroup(param, cfg) {\r\n        var canvas = this.get('canvas');\r\n        var rst;\r\n        cfg = Util.merge({}, cfg);\r\n        if (Util.isFunction(param)) {\r\n            if (cfg) {\r\n                cfg.canvas = canvas;\r\n                cfg.parent = this;\r\n                rst = new param(cfg);\r\n            }\r\n            else {\r\n                rst = new param({\r\n                    canvas: canvas,\r\n                    parent: this\r\n                });\r\n            }\r\n            this.add(rst);\r\n        }\r\n        else if (Util.isObject(param)) {\r\n            param.canvas = canvas;\r\n            rst = new Group(param);\r\n            this.add(rst);\r\n        }\r\n        else if (param === undefined) {\r\n            rst = new Group();\r\n            this.add(rst);\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n        return rst;\r\n    },\r\n    renderBack: function renderBack(padding, attrs) {\r\n        var backShape = this.get('backShape');\r\n        var innerBox = this.getBBox();\r\n        Util.merge(attrs, {\r\n            x: innerBox.minX - padding[3],\r\n            y: innerBox.minY - padding[0],\r\n            width: innerBox.width + padding[1] + padding[3],\r\n            height: innerBox.height + padding[0] + padding[2]\r\n        });\r\n        if (backShape) {\r\n            backShape.attr(attrs);\r\n        }\r\n        else {\r\n            backShape = this.addShape('rect', {\r\n                zIndex: -1,\r\n                attrs: attrs\r\n            });\r\n        }\r\n        this.set('backShape', backShape);\r\n        this.sort();\r\n        return backShape;\r\n    },\r\n    removeChild: function removeChild(item, destroy) {\r\n        if (arguments.length >= 2) {\r\n            if (this.contain(item)) {\r\n                item.remove(destroy);\r\n            }\r\n        }\r\n        else {\r\n            if (arguments.length === 1) {\r\n                if (Util.isBoolean(item)) {\r\n                    destroy = item;\r\n                }\r\n                else {\r\n                    if (this.contain(item)) {\r\n                        item.remove(true);\r\n                    }\r\n                    return this;\r\n                }\r\n            }\r\n            if (arguments.length === 0) {\r\n                destroy = true;\r\n            }\r\n            Group.superclass.remove.call(this, destroy);\r\n        }\r\n        return this;\r\n    },\r\n    add: function add(items) {\r\n        var self = this;\r\n        var children = self.get('children');\r\n        if (Util.isArray(items)) {\r\n            Util.each(items, function (item) {\r\n                var parent = item.get('parent');\r\n                if (parent) {\r\n                    parent.removeChild(item, false);\r\n                }\r\n                self._setCfgProperty(item);\r\n            });\r\n            self._cfg.children = children.concat(items);\r\n        }\r\n        else {\r\n            var item = items;\r\n            var parent = item.get('parent');\r\n            if (parent) {\r\n                parent.removeChild(item, false);\r\n            }\r\n            self._setCfgProperty(item);\r\n            children.push(item);\r\n        }\r\n        return self;\r\n    },\r\n    _setCfgProperty: function _setCfgProperty(item) {\r\n        var cfg = this._cfg;\r\n        item.set('parent', this);\r\n        item.set('canvas', cfg.canvas);\r\n        if (cfg.timeline) {\r\n            item.set('timeline', cfg.timeline);\r\n        }\r\n    },\r\n    contain: function contain(item) {\r\n        var children = this.get('children');\r\n        return children.indexOf(item) > -1;\r\n    },\r\n    getChildByIndex: function getChildByIndex(index) {\r\n        var children = this.get('children');\r\n        return children[index];\r\n    },\r\n    getFirst: function getFirst() {\r\n        return this.getChildByIndex(0);\r\n    },\r\n    getLast: function getLast() {\r\n        var lastIndex = this.get('children').length - 1;\r\n        return this.getChildByIndex(lastIndex);\r\n    },\r\n    getBBox: function getBBox() {\r\n        var self = this;\r\n        var minX = Infinity;\r\n        var maxX = -Infinity;\r\n        var minY = Infinity;\r\n        var maxY = -Infinity;\r\n        var children = self.get('children');\r\n        if (children.length > 0) {\r\n            Util.each(children, function (child) {\r\n                if (child.get('visible')) {\r\n                    if (child.isGroup && child.get('children').length === 0) {\r\n                        return;\r\n                    }\r\n                    var _box = child.getBBox();\r\n                    if (!_box) {\r\n                        return true;\r\n                    }\r\n                    var leftTop = [_box.minX, _box.minY, 1];\r\n                    var leftBottom = [_box.minX, _box.maxY, 1];\r\n                    var rightTop = [_box.maxX, _box.minY, 1];\r\n                    var rightBottom = [_box.maxX, _box.maxY, 1];\r\n                    child.apply(leftTop);\r\n                    child.apply(leftBottom);\r\n                    child.apply(rightTop);\r\n                    child.apply(rightBottom);\r\n                    var boxMinX = Math.min(leftTop[0], leftBottom[0], rightTop[0], rightBottom[0]);\r\n                    var boxMaxX = Math.max(leftTop[0], leftBottom[0], rightTop[0], rightBottom[0]);\r\n                    var boxMinY = Math.min(leftTop[1], leftBottom[1], rightTop[1], rightBottom[1]);\r\n                    var boxMaxY = Math.max(leftTop[1], leftBottom[1], rightTop[1], rightBottom[1]);\r\n                    if (boxMinX < minX) {\r\n                        minX = boxMinX;\r\n                    }\r\n                    if (boxMaxX > maxX) {\r\n                        maxX = boxMaxX;\r\n                    }\r\n                    if (boxMinY < minY) {\r\n                        minY = boxMinY;\r\n                    }\r\n                    if (boxMaxY > maxY) {\r\n                        maxY = boxMaxY;\r\n                    }\r\n                }\r\n            });\r\n        }\r\n        else {\r\n            minX = 0;\r\n            maxX = 0;\r\n            minY = 0;\r\n            maxY = 0;\r\n        }\r\n        var box = {\r\n            minX: minX,\r\n            minY: minY,\r\n            maxX: maxX,\r\n            maxY: maxY\r\n        };\r\n        box.x = box.minX;\r\n        box.y = box.minY;\r\n        box.width = box.maxX - box.minX;\r\n        box.height = box.maxY - box.minY;\r\n        return box;\r\n    },\r\n    getCount: function getCount() {\r\n        return this.get('children').length;\r\n    },\r\n    sort: function sort() {\r\n        var children = this.get('children');\r\n        Util.each(children, function (child, index) {\r\n            child[INDEX] = index;\r\n            return child;\r\n        });\r\n        children.sort(getComparer(function (obj1, obj2) {\r\n            return obj1.get('zIndex') - obj2.get('zIndex');\r\n        }));\r\n        return this;\r\n    },\r\n    findById: function findById(id) {\r\n        return this.find(function (item) {\r\n            return item.get('id') === id;\r\n        });\r\n    },\r\n    find: function find(fn) {\r\n        if (Util.isString(fn)) {\r\n            return this.findById(fn);\r\n        }\r\n        var children = this.get('children');\r\n        var rst = null;\r\n        Util.each(children, function (item) {\r\n            if (fn(item)) {\r\n                rst = item;\r\n            }\r\n            else if (item.find) {\r\n                rst = item.find(fn);\r\n            }\r\n            if (rst) {\r\n                return false;\r\n            }\r\n        });\r\n        return rst;\r\n    },\r\n    findAll: function findAll(fn) {\r\n        var children = this.get('children');\r\n        var rst = [];\r\n        var childRst = [];\r\n        Util.each(children, function (item) {\r\n            if (fn(item)) {\r\n                rst.push(item);\r\n            }\r\n            if (item.findAllBy) {\r\n                childRst = item.findAllBy(fn);\r\n                rst = rst.concat(childRst);\r\n            }\r\n        });\r\n        return rst;\r\n    },\r\n    findBy: function findBy(fn) {\r\n        var children = this.get('children');\r\n        var rst = null;\r\n        Util.each(children, function (item) {\r\n            if (fn(item)) {\r\n                rst = item;\r\n            }\r\n            else if (item.findBy) {\r\n                rst = item.findBy(fn);\r\n            }\r\n            if (rst) {\r\n                return false;\r\n            }\r\n        });\r\n        return rst;\r\n    },\r\n    findAllBy: function findAllBy(fn) {\r\n        var children = this.get('children');\r\n        var rst = [];\r\n        var childRst = [];\r\n        Util.each(children, function (item) {\r\n            if (fn(item)) {\r\n                rst.push(item);\r\n            }\r\n            if (item.findAllBy) {\r\n                childRst = item.findAllBy(fn);\r\n                rst = rst.concat(childRst);\r\n            }\r\n        });\r\n        return rst;\r\n    },\r\n    getShape: function getShape(x, y) {\r\n        var self = this;\r\n        var clip = self._attrs.clip;\r\n        var children = self._cfg.children;\r\n        var rst;\r\n        if (clip) {\r\n            var v = [x, y, 1];\r\n            clip.invert(v, self.get('canvas'));\r\n            if (clip.isPointInPath(v[0], v[1])) {\r\n                rst = find(children, x, y);\r\n            }\r\n        }\r\n        else {\r\n            rst = find(children, x, y);\r\n        }\r\n        return rst;\r\n    },\r\n    clearTotalMatrix: function clearTotalMatrix() {\r\n        var m = this.get('totalMatrix');\r\n        if (m) {\r\n            this.setSilent('totalMatrix', null);\r\n            var children = this._cfg.children;\r\n            for (var i = 0; i < children.length; i++) {\r\n                var child = children[i];\r\n                child.clearTotalMatrix();\r\n            }\r\n        }\r\n    },\r\n    clear: function clear(delayRemove) {\r\n        var children = this._cfg.children;\r\n        for (var i = children.length - 1; i >= 0; i--) {\r\n            children[i].remove(true, delayRemove);\r\n        }\r\n        this._cfg.children = [];\r\n        return this;\r\n    },\r\n    destroy: function destroy() {\r\n        if (this.get('destroyed')) {\r\n            return;\r\n        }\r\n        this.clear();\r\n        Group.superclass.destroy.call(this);\r\n    },\r\n    clone: function clone() {\r\n        var self = this;\r\n        var children = self._cfg.children;\r\n        var clone = new Group();\r\n        Util.each(children, function (child) {\r\n            clone.add(child.clone());\r\n        });\r\n        return clone;\r\n    }\r\n});\r\nmodule.exports = Group;\r\n",{"version":3,"file":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\@antv\\g\\lib\\core\\group.js","sourceRoot":"","sources":["D:\\project\\Deecamp-project\\system\\Web\\node_modules\\@antv\\g\\lib\\core\\group.js"],"names":[],"mappings":"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","sourcesContent":["var Util = require('../util/index');\n\nvar Element = require('./element');\n\nvar Shape = require('../shapes/index');\n\nvar SHAPE_MAP = {}; // 缓存图形类型\n\nvar INDEX = '_INDEX';\n\nfunction getComparer(compare) {\n  return function (left, right) {\n    var result = compare(left, right);\n    return result === 0 ? left[INDEX] - right[INDEX] : result;\n  };\n}\n\nfunction find(children, x, y) {\n  var rst;\n\n  for (var i = children.length - 1; i >= 0; i--) {\n    var child = children[i];\n\n    if (child._cfg.visible && child._cfg.capture) {\n      if (child.isGroup) {\n        rst = child.getShape(x, y);\n      } else if (child.isHit(x, y)) {\n        rst = child;\n      }\n    }\n\n    if (rst) {\n      break;\n    }\n  }\n\n  return rst;\n}\n\nvar Group = function Group(cfg) {\n  Group.superclass.constructor.call(this, cfg);\n  this.set('children', []);\n  this.set('tobeRemoved', []);\n\n  this._beforeRenderUI();\n\n  this._renderUI();\n\n  this._bindUI();\n};\n\nfunction initClassCfgs(c) {\n  if (c._cfg || c === Group) {\n    return;\n  }\n\n  var superCon = c.superclass.constructor;\n\n  if (superCon && !superCon._cfg) {\n    initClassCfgs(superCon);\n  }\n\n  c._cfg = {};\n  Util.merge(c._cfg, superCon._cfg);\n  Util.merge(c._cfg, c.CFG);\n}\n\nUtil.extend(Group, Element);\nUtil.augment(Group, {\n  isGroup: true,\n  type: 'group',\n  canFill: true,\n  canStroke: true,\n  getDefaultCfg: function getDefaultCfg() {\n    initClassCfgs(this.constructor);\n    return Util.merge({}, this.constructor._cfg);\n  },\n  _beforeRenderUI: function _beforeRenderUI() {},\n  _renderUI: function _renderUI() {},\n  _bindUI: function _bindUI() {},\n  addShape: function addShape(type, cfg) {\n    var canvas = this.get('canvas');\n    cfg = cfg || {};\n    var shapeType = SHAPE_MAP[type];\n\n    if (!shapeType) {\n      shapeType = Util.upperFirst(type);\n      SHAPE_MAP[type] = shapeType;\n    }\n\n    if (cfg.attrs && canvas) {\n      var attrs = cfg.attrs;\n\n      if (type === 'text') {\n        // 临时解决\n        var topFontFamily = canvas.get('fontFamily');\n\n        if (topFontFamily) {\n          attrs.fontFamily = attrs.fontFamily ? attrs.fontFamily : topFontFamily;\n        }\n      }\n    }\n\n    cfg.canvas = canvas;\n    cfg.type = type;\n    var rst = new Shape[shapeType](cfg);\n    this.add(rst);\n    return rst;\n  },\n\n  /** 添加图组\n   * @param  {Function|Object|undefined} param 图组类\n   * @param  {Object} cfg 配置项\n   * @return {Object} rst 图组\n   */\n  addGroup: function addGroup(param, cfg) {\n    var canvas = this.get('canvas');\n    var rst;\n    cfg = Util.merge({}, cfg);\n\n    if (Util.isFunction(param)) {\n      if (cfg) {\n        cfg.canvas = canvas;\n        cfg.parent = this;\n        rst = new param(cfg);\n      } else {\n        rst = new param({\n          canvas: canvas,\n          parent: this\n        });\n      }\n\n      this.add(rst);\n    } else if (Util.isObject(param)) {\n      param.canvas = canvas;\n      rst = new Group(param);\n      this.add(rst);\n    } else if (param === undefined) {\n      rst = new Group();\n      this.add(rst);\n    } else {\n      return false;\n    }\n\n    return rst;\n  },\n\n  /** 绘制背景\n   * @param  {Array} padding 内边距\n   * @param  {Attrs} attrs 图形属性\n   * @param  {Shape} backShape 背景图形\n   * @return {Object} 背景层对象\n   */\n  renderBack: function renderBack(padding, attrs) {\n    var backShape = this.get('backShape');\n    var innerBox = this.getBBox(); // const parent = this.get('parent'); // getParent\n\n    Util.merge(attrs, {\n      x: innerBox.minX - padding[3],\n      y: innerBox.minY - padding[0],\n      width: innerBox.width + padding[1] + padding[3],\n      height: innerBox.height + padding[0] + padding[2]\n    });\n\n    if (backShape) {\n      backShape.attr(attrs);\n    } else {\n      backShape = this.addShape('rect', {\n        zIndex: -1,\n        attrs: attrs\n      });\n    }\n\n    this.set('backShape', backShape);\n    this.sort();\n    return backShape;\n  },\n  removeChild: function removeChild(item, destroy) {\n    if (arguments.length >= 2) {\n      if (this.contain(item)) {\n        item.remove(destroy);\n      }\n    } else {\n      if (arguments.length === 1) {\n        if (Util.isBoolean(item)) {\n          destroy = item;\n        } else {\n          if (this.contain(item)) {\n            item.remove(true);\n          }\n\n          return this;\n        }\n      }\n\n      if (arguments.length === 0) {\n        destroy = true;\n      }\n\n      Group.superclass.remove.call(this, destroy);\n    }\n\n    return this;\n  },\n\n  /**\n   * 向组中添加shape或者group\n   * @param {Object} items 图形或者分组\n   * @return {Object} group 本尊\n   */\n  add: function add(items) {\n    var self = this;\n    var children = self.get('children');\n\n    if (Util.isArray(items)) {\n      Util.each(items, function (item) {\n        var parent = item.get('parent');\n\n        if (parent) {\n          parent.removeChild(item, false);\n        }\n\n        self._setCfgProperty(item);\n      });\n      self._cfg.children = children.concat(items);\n    } else {\n      var item = items;\n      var parent = item.get('parent');\n\n      if (parent) {\n        parent.removeChild(item, false);\n      }\n\n      self._setCfgProperty(item);\n\n      children.push(item);\n    }\n\n    return self;\n  },\n  _setCfgProperty: function _setCfgProperty(item) {\n    var cfg = this._cfg;\n    item.set('parent', this);\n    item.set('canvas', cfg.canvas);\n\n    if (cfg.timeline) {\n      item.set('timeline', cfg.timeline);\n    }\n  },\n  contain: function contain(item) {\n    var children = this.get('children');\n    return children.indexOf(item) > -1;\n  },\n  getChildByIndex: function getChildByIndex(index) {\n    var children = this.get('children');\n    return children[index];\n  },\n  getFirst: function getFirst() {\n    return this.getChildByIndex(0);\n  },\n  getLast: function getLast() {\n    var lastIndex = this.get('children').length - 1;\n    return this.getChildByIndex(lastIndex);\n  },\n  getBBox: function getBBox() {\n    var self = this;\n    var minX = Infinity;\n    var maxX = -Infinity;\n    var minY = Infinity;\n    var maxY = -Infinity;\n    var children = self.get('children');\n\n    if (children.length > 0) {\n      Util.each(children, function (child) {\n        if (child.get('visible')) {\n          if (child.isGroup && child.get('children').length === 0) {\n            return;\n          }\n\n          var _box = child.getBBox();\n\n          if (!_box) {\n            return true;\n          }\n\n          var leftTop = [_box.minX, _box.minY, 1];\n          var leftBottom = [_box.minX, _box.maxY, 1];\n          var rightTop = [_box.maxX, _box.minY, 1];\n          var rightBottom = [_box.maxX, _box.maxY, 1];\n          child.apply(leftTop);\n          child.apply(leftBottom);\n          child.apply(rightTop);\n          child.apply(rightBottom);\n          var boxMinX = Math.min(leftTop[0], leftBottom[0], rightTop[0], rightBottom[0]);\n          var boxMaxX = Math.max(leftTop[0], leftBottom[0], rightTop[0], rightBottom[0]);\n          var boxMinY = Math.min(leftTop[1], leftBottom[1], rightTop[1], rightBottom[1]);\n          var boxMaxY = Math.max(leftTop[1], leftBottom[1], rightTop[1], rightBottom[1]);\n\n          if (boxMinX < minX) {\n            minX = boxMinX;\n          }\n\n          if (boxMaxX > maxX) {\n            maxX = boxMaxX;\n          }\n\n          if (boxMinY < minY) {\n            minY = boxMinY;\n          }\n\n          if (boxMaxY > maxY) {\n            maxY = boxMaxY;\n          }\n        }\n      });\n    } else {\n      minX = 0;\n      maxX = 0;\n      minY = 0;\n      maxY = 0;\n    }\n\n    var box = {\n      minX: minX,\n      minY: minY,\n      maxX: maxX,\n      maxY: maxY\n    };\n    box.x = box.minX;\n    box.y = box.minY;\n    box.width = box.maxX - box.minX;\n    box.height = box.maxY - box.minY;\n    return box;\n  },\n  getCount: function getCount() {\n    return this.get('children').length;\n  },\n  sort: function sort() {\n    var children = this.get('children'); // 稳定排序\n\n    Util.each(children, function (child, index) {\n      child[INDEX] = index;\n      return child;\n    });\n    children.sort(getComparer(function (obj1, obj2) {\n      return obj1.get('zIndex') - obj2.get('zIndex');\n    }));\n    return this;\n  },\n  findById: function findById(id) {\n    return this.find(function (item) {\n      return item.get('id') === id;\n    });\n  },\n\n  /**\n   * 根据查找函数查找分组或者图形\n   * @param  {Function} fn 匹配函数\n   * @return {Canvas.Base} 分组或者图形\n   */\n  find: function find(fn) {\n    if (Util.isString(fn)) {\n      return this.findById(fn);\n    }\n\n    var children = this.get('children');\n    var rst = null;\n    Util.each(children, function (item) {\n      if (fn(item)) {\n        rst = item;\n      } else if (item.find) {\n        rst = item.find(fn);\n      }\n\n      if (rst) {\n        return false;\n      }\n    });\n    return rst;\n  },\n\n  /**\n   * @param  {Function} fn filter mathod\n   * @return {Array} all the matching shapes and groups\n   */\n  findAll: function findAll(fn) {\n    var children = this.get('children');\n    var rst = [];\n    var childRst = [];\n    Util.each(children, function (item) {\n      if (fn(item)) {\n        rst.push(item);\n      }\n\n      if (item.findAllBy) {\n        childRst = item.findAllBy(fn);\n        rst = rst.concat(childRst);\n      }\n    });\n    return rst;\n  },\n\n  /**\n   * @Deprecated\n   * @param  {Function} fn filter method\n   * @return {Object} found shape or group\n   */\n  findBy: function findBy(fn) {\n    var children = this.get('children');\n    var rst = null;\n    Util.each(children, function (item) {\n      if (fn(item)) {\n        rst = item;\n      } else if (item.findBy) {\n        rst = item.findBy(fn);\n      }\n\n      if (rst) {\n        return false;\n      }\n    });\n    return rst;\n  },\n\n  /**\n   * @Deprecated\n   * @param  {Function} fn filter mathod\n   * @return {Array} all the matching shapes and groups\n   */\n  findAllBy: function findAllBy(fn) {\n    var children = this.get('children');\n    var rst = [];\n    var childRst = [];\n    Util.each(children, function (item) {\n      if (fn(item)) {\n        rst.push(item);\n      }\n\n      if (item.findAllBy) {\n        childRst = item.findAllBy(fn);\n        rst = rst.concat(childRst);\n      }\n    });\n    return rst;\n  },\n  getShape: function getShape(x, y) {\n    var self = this;\n    var clip = self._attrs.clip;\n    var children = self._cfg.children;\n    var rst;\n\n    if (clip) {\n      var v = [x, y, 1];\n      clip.invert(v, self.get('canvas')); // 已经在外面转换\n\n      if (clip.isPointInPath(v[0], v[1])) {\n        rst = find(children, x, y);\n      }\n    } else {\n      rst = find(children, x, y);\n    }\n\n    return rst;\n  },\n  clearTotalMatrix: function clearTotalMatrix() {\n    var m = this.get('totalMatrix');\n\n    if (m) {\n      this.setSilent('totalMatrix', null);\n      var children = this._cfg.children;\n\n      for (var i = 0; i < children.length; i++) {\n        var child = children[i];\n        child.clearTotalMatrix();\n      }\n    }\n  },\n  clear: function clear(delayRemove) {\n    var children = this._cfg.children;\n\n    for (var i = children.length - 1; i >= 0; i--) {\n      children[i].remove(true, delayRemove);\n    }\n\n    this._cfg.children = [];\n    return this;\n  },\n  destroy: function destroy() {\n    if (this.get('destroyed')) {\n      return;\n    }\n\n    this.clear();\n    Group.superclass.destroy.call(this);\n  },\n  clone: function clone() {\n    var self = this;\n    var children = self._cfg.children;\n    var clone = new Group();\n    Util.each(children, function (child) {\n      clone.add(child.clone());\n    });\n    return clone;\n  }\n});\nmodule.exports = Group;"]}]}