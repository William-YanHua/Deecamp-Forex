{"remainingRequest":"/run/media/williamyh/新加卷/project/Deecamp-project/system/Web/node_modules/ts-loader/index.js??ref--4-1!/run/media/williamyh/新加卷/project/Deecamp-project/system/Web/node_modules/bizcharts/node_modules/@antv/g2/lib/interaction/drag.js","dependencies":[{"path":"/run/media/williamyh/新加卷/project/Deecamp-project/system/Web/node_modules/bizcharts/node_modules/@antv/g2/lib/interaction/drag.js","mtime":499162500000},{"path":"/run/media/williamyh/新加卷/project/Deecamp-project/system/Web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/run/media/williamyh/新加卷/project/Deecamp-project/system/Web/node_modules/ts-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":["function _assertThisInitialized(self) { if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n} return self; }\nfunction _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }\nvar Util = require('../util');\nvar Interaction = require('./base');\nvar filterData = require('./helper/filter-data');\nvar getColDef = require('./helper/get-col-def');\nvar getLimitRange = require('./helper/get-limit-range');\nvar DAY_TIMESTAMPS = 86400000;\nvar DRAGGING_TYPES = ['X', 'Y', 'XY'];\nvar DEFAULT_TYPE = 'X';\nvar Drag = function (_Interaction) {\n    _inheritsLoose(Drag, _Interaction);\n    var _proto = Drag.prototype;\n    _proto.getDefaultCfg = function getDefaultCfg() {\n        var cfg = _Interaction.prototype.getDefaultCfg.call(this);\n        return Util.mix({}, cfg, {\n            type: DEFAULT_TYPE,\n            stepRatio: 0.05,\n            limitRange: {},\n            stepByField: {},\n            threshold: 20,\n            originScaleDefsByField: {},\n            previousPoint: null,\n            isDragging: false\n        });\n    };\n    _proto._disableTooltip = function _disableTooltip() {\n        var me = this;\n        var chart = me.chart;\n        var tooltipController = chart.get('tooltipController');\n        if (tooltipController) {\n            me._showTooltip = true;\n            chart.tooltip(false);\n        }\n    };\n    _proto._enableTooltip = function _enableTooltip(ev) {\n        var me = this;\n        var chart = me.chart;\n        if (me._showTooltip) {\n            chart.tooltip(true);\n            chart.showTooltip(ev);\n        }\n    };\n    function Drag(cfg, chart) {\n        var _this;\n        _this = _Interaction.call(this, cfg, chart) || this;\n        var me = _assertThisInitialized(_this);\n        me.type = me.type.toUpperCase();\n        me.chart = chart;\n        me.coord = chart.get('coord');\n        var data = me.data = chart.get('data');\n        filterData(chart);\n        var scales = chart.getYScales();\n        var xScale = chart.getXScale();\n        scales.push(xScale);\n        var scaleController = chart.get('scaleController');\n        scales.forEach(function (scale) {\n            var field = scale.field;\n            me.limitRange[field] = getLimitRange(data, scale);\n            var def = scaleController.defs[field] || {};\n            me.originScaleDefsByField[field] = Util.mix(def, {\n                nice: !!def.nice\n            });\n            if (scale.isLinear) {\n                me.stepByField[field] = (scale.max - scale.min) * me.stepRatio;\n            }\n        });\n        if (!DRAGGING_TYPES.includes(me.type)) {\n            me.type = DEFAULT_TYPE;\n        }\n        me._disableTooltip();\n        return _this;\n    }\n    _proto._applyTranslate = function _applyTranslate(scale, offset, total) {\n        if (offset === void 0) {\n            offset = 0;\n        }\n        var me = this;\n        if (scale.isLinear) {\n            me._translateLinearScale(scale, offset, total);\n        }\n        else {\n            me._translateCatScale(scale, offset, total);\n        }\n    };\n    _proto._translateCatScale = function _translateCatScale(scale, offset, total) {\n        var me = this;\n        var chart = me.chart;\n        var type = scale.type, field = scale.field, values = scale.values, ticks = scale.ticks;\n        var colDef = getColDef(chart, field);\n        var originValues = me.limitRange[field];\n        var ratio = offset / total;\n        var valueLength = values.length;\n        var deltaCount = Math.max(1, Math.abs(parseInt(ratio * valueLength)));\n        var firstIndex = originValues.indexOf(values[0]);\n        var lastIndex = originValues.indexOf(values[valueLength - 1]);\n        if (offset > 0 && firstIndex >= 0) {\n            for (var i = 0; i < deltaCount && firstIndex > 0; i++) {\n                firstIndex -= 1;\n                lastIndex -= 1;\n            }\n            var newValues = originValues.slice(firstIndex, lastIndex + 1);\n            var newTicks = null;\n            if (type === 'timeCat') {\n                var tickGap = ticks.length > 2 ? ticks[1] - ticks[0] : DAY_TIMESTAMPS;\n                for (var _i = ticks[0] - tickGap; _i >= newValues[0]; _i -= tickGap) {\n                    ticks.unshift(_i);\n                }\n                newTicks = ticks;\n            }\n            chart.scale(field, Util.mix({}, colDef, {\n                values: newValues,\n                ticks: newTicks\n            }));\n        }\n        else if (offset < 0 && lastIndex <= originValues.length - 1) {\n            for (var _i2 = 0; _i2 < deltaCount && lastIndex < originValues.length - 1; _i2++) {\n                firstIndex += 1;\n                lastIndex += 1;\n            }\n            var _newValues = originValues.slice(firstIndex, lastIndex + 1);\n            var _newTicks = null;\n            if (type === 'timeCat') {\n                var _tickGap = ticks.length > 2 ? ticks[1] - ticks[0] : DAY_TIMESTAMPS;\n                for (var _i3 = ticks[ticks.length - 1] + _tickGap; _i3 <= _newValues[_newValues.length - 1]; _i3 += _tickGap) {\n                    ticks.push(_i3);\n                }\n                _newTicks = ticks;\n            }\n            chart.scale(field, Util.mix({}, colDef, {\n                values: _newValues,\n                ticks: _newTicks\n            }));\n        }\n    };\n    _proto._translateLinearScale = function _translateLinearScale(scale, offset, total) {\n        var me = this;\n        var chart = me.chart, limitRange = me.limitRange;\n        var min = scale.min, max = scale.max, field = scale.field;\n        if (min === limitRange[field].min && max === limitRange[field].max)\n            return;\n        var ratio = offset / total;\n        var range = max - min;\n        var colDef = getColDef(chart, field);\n        chart.scale(field, Util.mix({}, colDef, {\n            nice: false,\n            min: min + ratio * range,\n            max: max + ratio * range\n        }));\n    };\n    _proto.start = function start(ev) {\n        var me = this;\n        var canvas = me.canvas;\n        var canvasDOM = canvas.get('canvasDOM');\n        canvasDOM.style.cursor = 'pointer';\n        me.isDragging = true;\n        me.previousPoint = {\n            x: ev.x,\n            y: ev.y\n        };\n        me._disableTooltip();\n    };\n    _proto.process = function process(ev) {\n        var me = this;\n        if (me.isDragging) {\n            var chart = me.chart, type = me.type, canvas = me.canvas, coord = me.coord, threshold = me.threshold;\n            var canvasDOM = canvas.get('canvasDOM');\n            canvasDOM.style.cursor = 'move';\n            var previousPoint = me.previousPoint;\n            var currentPoint = ev;\n            var deltaX = currentPoint.x - previousPoint.x;\n            var deltaY = currentPoint.y - previousPoint.y;\n            var modified = false;\n            if (Math.abs(deltaX) > threshold && type.indexOf('X') > -1) {\n                modified = true;\n                var xScale = chart.getXScale();\n                me._applyTranslate(xScale, xScale.isLinear ? -deltaX : deltaX, coord.width);\n            }\n            if (Math.abs(deltaY) > threshold && type.indexOf('Y') > -1) {\n                modified = true;\n                var yScales = chart.getYScales();\n                yScales.forEach(function (yScale) {\n                    me._applyTranslate(yScale, currentPoint.y - previousPoint.y, coord.height);\n                });\n            }\n            if (modified) {\n                me.previousPoint = currentPoint;\n                chart.repaint();\n            }\n        }\n    };\n    _proto.end = function end(ev) {\n        var me = this;\n        me.isDragging = false;\n        var canvas = me.canvas;\n        var canvasDOM = canvas.get('canvasDOM');\n        canvasDOM.style.cursor = 'default';\n        me._enableTooltip(ev);\n    };\n    _proto.reset = function reset() {\n        var me = this;\n        var view = me.view, originScaleDefsByField = me.originScaleDefsByField;\n        var scales = view.getYScales();\n        var xScale = view.getXScale();\n        scales.push(xScale);\n        scales.forEach(function (scale) {\n            if (scale.isLinear) {\n                var field = scale.field;\n                view.scale(field, originScaleDefsByField[field]);\n            }\n        });\n        view.repaint();\n        me._disableTooltip();\n    };\n    return Drag;\n}(Interaction);\nmodule.exports = Drag;\n",{"version":3,"file":"/run/media/williamyh/新加卷/project/Deecamp-project/system/Web/node_modules/bizcharts/node_modules/@antv/g2/lib/interaction/drag.js","sourceRoot":"","sources":["/run/media/williamyh/新加卷/project/Deecamp-project/system/Web/node_modules/bizcharts/node_modules/@antv/g2/lib/interaction/drag.js"],"names":[],"mappings":"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","sourcesContent":["function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }\n\nvar Util = require('../util');\n\nvar Interaction = require('./base');\n\nvar filterData = require('./helper/filter-data');\n\nvar getColDef = require('./helper/get-col-def');\n\nvar getLimitRange = require('./helper/get-limit-range');\n\nvar DAY_TIMESTAMPS = 86400000; // const G2 = require('../core.js');\n\nvar DRAGGING_TYPES = ['X', 'Y', 'XY'];\nvar DEFAULT_TYPE = 'X';\n\nvar Drag = /*#__PURE__*/function (_Interaction) {\n  _inheritsLoose(Drag, _Interaction);\n\n  var _proto = Drag.prototype;\n\n  _proto.getDefaultCfg = function getDefaultCfg() {\n    var cfg = _Interaction.prototype.getDefaultCfg.call(this);\n\n    return Util.mix({}, cfg, {\n      type: DEFAULT_TYPE,\n      stepRatio: 0.05,\n      limitRange: {},\n      stepByField: {},\n      threshold: 20,\n      originScaleDefsByField: {},\n      previousPoint: null,\n      isDragging: false\n    });\n  };\n\n  _proto._disableTooltip = function _disableTooltip() {\n    var me = this;\n    var chart = me.chart;\n    var tooltipController = chart.get('tooltipController');\n\n    if (tooltipController) {\n      me._showTooltip = true;\n      chart.tooltip(false);\n    }\n  };\n\n  _proto._enableTooltip = function _enableTooltip(ev) {\n    var me = this;\n    var chart = me.chart;\n\n    if (me._showTooltip) {\n      chart.tooltip(true);\n      chart.showTooltip(ev);\n    }\n  };\n\n  function Drag(cfg, chart) {\n    var _this;\n\n    _this = _Interaction.call(this, cfg, chart) || this;\n\n    var me = _assertThisInitialized(_this);\n\n    me.type = me.type.toUpperCase();\n    me.chart = chart;\n    me.coord = chart.get('coord');\n    var data = me.data = chart.get('data'); // pre process\n\n    filterData(chart);\n    var scales = chart.getYScales();\n    var xScale = chart.getXScale();\n    scales.push(xScale);\n    var scaleController = chart.get('scaleController');\n    scales.forEach(function (scale) {\n      var field = scale.field;\n      me.limitRange[field] = getLimitRange(data, scale);\n      var def = scaleController.defs[field] || {};\n      me.originScaleDefsByField[field] = Util.mix(def, {\n        nice: !!def.nice\n      });\n\n      if (scale.isLinear) {\n        me.stepByField[field] = (scale.max - scale.min) * me.stepRatio;\n      }\n    });\n\n    if (!DRAGGING_TYPES.includes(me.type)) {\n      me.type = DEFAULT_TYPE;\n    }\n\n    me._disableTooltip();\n\n    return _this;\n  } // onDragstart() { }\n  // onDrag() { }\n  // onDragend() { }\n\n\n  _proto._applyTranslate = function _applyTranslate(scale, offset, total) {\n    if (offset === void 0) {\n      offset = 0;\n    }\n\n    var me = this;\n\n    if (scale.isLinear) {\n      me._translateLinearScale(scale, offset, total);\n    } else {\n      me._translateCatScale(scale, offset, total);\n    }\n  };\n\n  _proto._translateCatScale = function _translateCatScale(scale, offset, total) {\n    var me = this;\n    var chart = me.chart;\n    var type = scale.type,\n        field = scale.field,\n        values = scale.values,\n        ticks = scale.ticks;\n    var colDef = getColDef(chart, field);\n    var originValues = me.limitRange[field];\n    var ratio = offset / total;\n    var valueLength = values.length;\n    var deltaCount = Math.max(1, Math.abs(parseInt(ratio * valueLength)));\n    var firstIndex = originValues.indexOf(values[0]);\n    var lastIndex = originValues.indexOf(values[valueLength - 1]);\n\n    if (offset > 0 && firstIndex >= 0) {\n      // right\n      for (var i = 0; i < deltaCount && firstIndex > 0; i++) {\n        firstIndex -= 1;\n        lastIndex -= 1;\n      }\n\n      var newValues = originValues.slice(firstIndex, lastIndex + 1);\n      var newTicks = null;\n\n      if (type === 'timeCat') {\n        var tickGap = ticks.length > 2 ? ticks[1] - ticks[0] : DAY_TIMESTAMPS;\n\n        for (var _i = ticks[0] - tickGap; _i >= newValues[0]; _i -= tickGap) {\n          ticks.unshift(_i);\n        }\n\n        newTicks = ticks;\n      }\n\n      chart.scale(field, Util.mix({}, colDef, {\n        values: newValues,\n        ticks: newTicks\n      }));\n    } else if (offset < 0 && lastIndex <= originValues.length - 1) {\n      // left\n      for (var _i2 = 0; _i2 < deltaCount && lastIndex < originValues.length - 1; _i2++) {\n        firstIndex += 1;\n        lastIndex += 1;\n      }\n\n      var _newValues = originValues.slice(firstIndex, lastIndex + 1);\n\n      var _newTicks = null;\n\n      if (type === 'timeCat') {\n        var _tickGap = ticks.length > 2 ? ticks[1] - ticks[0] : DAY_TIMESTAMPS;\n\n        for (var _i3 = ticks[ticks.length - 1] + _tickGap; _i3 <= _newValues[_newValues.length - 1]; _i3 += _tickGap) {\n          ticks.push(_i3);\n        }\n\n        _newTicks = ticks;\n      }\n\n      chart.scale(field, Util.mix({}, colDef, {\n        values: _newValues,\n        ticks: _newTicks\n      }));\n    }\n  };\n\n  _proto._translateLinearScale = function _translateLinearScale(scale, offset, total) {\n    var me = this;\n    var chart = me.chart,\n        limitRange = me.limitRange; // linear / cat\n\n    var min = scale.min,\n        max = scale.max,\n        field = scale.field;\n    if (min === limitRange[field].min && max === limitRange[field].max) return;\n    var ratio = offset / total;\n    var range = max - min;\n    var colDef = getColDef(chart, field);\n    chart.scale(field, Util.mix({}, colDef, {\n      nice: false,\n      min: min + ratio * range,\n      max: max + ratio * range\n    }));\n  };\n\n  _proto.start = function start(ev) {\n    var me = this;\n    var canvas = me.canvas;\n    var canvasDOM = canvas.get('canvasDOM');\n    canvasDOM.style.cursor = 'pointer'; // const coord = chart.get('coord');\n\n    me.isDragging = true;\n    me.previousPoint = {\n      x: ev.x,\n      y: ev.y\n    };\n\n    me._disableTooltip();\n  };\n\n  _proto.process = function process(ev) {\n    var me = this;\n\n    if (me.isDragging) {\n      var chart = me.chart,\n          type = me.type,\n          canvas = me.canvas,\n          coord = me.coord,\n          threshold = me.threshold;\n      var canvasDOM = canvas.get('canvasDOM');\n      canvasDOM.style.cursor = 'move'; // const coord = chart.get('coord');\n\n      var previousPoint = me.previousPoint;\n      var currentPoint = ev;\n      var deltaX = currentPoint.x - previousPoint.x;\n      var deltaY = currentPoint.y - previousPoint.y;\n      var modified = false;\n\n      if (Math.abs(deltaX) > threshold && type.indexOf('X') > -1) {\n        modified = true;\n        var xScale = chart.getXScale();\n\n        me._applyTranslate(xScale, xScale.isLinear ? -deltaX : deltaX, coord.width);\n      }\n\n      if (Math.abs(deltaY) > threshold && type.indexOf('Y') > -1) {\n        modified = true;\n        var yScales = chart.getYScales();\n        yScales.forEach(function (yScale) {\n          me._applyTranslate(yScale, currentPoint.y - previousPoint.y, coord.height);\n        });\n      }\n\n      if (modified) {\n        me.previousPoint = currentPoint;\n        chart.repaint();\n      }\n    }\n  };\n\n  _proto.end = function end(ev) {\n    var me = this;\n    me.isDragging = false;\n    var canvas = me.canvas;\n    var canvasDOM = canvas.get('canvasDOM');\n    canvasDOM.style.cursor = 'default';\n\n    me._enableTooltip(ev);\n  };\n\n  _proto.reset = function reset() {\n    var me = this;\n    var view = me.view,\n        originScaleDefsByField = me.originScaleDefsByField;\n    var scales = view.getYScales();\n    var xScale = view.getXScale();\n    scales.push(xScale);\n    scales.forEach(function (scale) {\n      if (scale.isLinear) {\n        var field = scale.field;\n        view.scale(field, originScaleDefsByField[field]);\n      }\n    });\n    view.repaint();\n\n    me._disableTooltip();\n  };\n\n  return Drag;\n}(Interaction);\n\nmodule.exports = Drag;"]}]}