{"remainingRequest":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\ts-loader\\index.js??ref--4-1!D:\\project\\Deecamp-project\\system\\Web\\node_modules\\@antv\\g2plot\\node_modules\\@antv\\g2\\esm\\interaction\\action\\element\\range-state.js","dependencies":[{"path":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\@antv\\g2plot\\node_modules\\@antv\\g2\\esm\\interaction\\action\\element\\range-state.js","mtime":499162500000},{"path":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1595520254649},{"path":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\ts-loader\\index.js","mtime":1537906253000}],"contextDependencies":[],"result":["import { __extends } from \"tslib\";\r\nimport { each } from '@antv/util';\r\nimport { getElements, getIntersectElements, getMaskedElements, getSiblingMaskElements, getSilbings, isInRecords, isMask, } from '../util';\r\nimport StateBase from './state-base';\r\nvar ElementRangeState = (function (_super) {\r\n    __extends(ElementRangeState, _super);\r\n    function ElementRangeState() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.startPoint = null;\r\n        _this.endPoint = null;\r\n        _this.isStarted = false;\r\n        _this.effectSiblings = false;\r\n        _this.effectByRecord = false;\r\n        return _this;\r\n    }\r\n    ElementRangeState.prototype.getCurrentPoint = function () {\r\n        var event = this.context.event;\r\n        return {\r\n            x: event.x,\r\n            y: event.y,\r\n        };\r\n    };\r\n    ElementRangeState.prototype.start = function () {\r\n        this.clear();\r\n        this.startPoint = this.getCurrentPoint();\r\n        this.isStarted = true;\r\n    };\r\n    ElementRangeState.prototype.getIntersectElements = function () {\r\n        var elements = null;\r\n        if (isMask(this.context)) {\r\n            elements = getMaskedElements(this.context, 10);\r\n        }\r\n        else {\r\n            var startPoint = this.startPoint;\r\n            var endPoint = this.isStarted ? this.getCurrentPoint() : this.endPoint;\r\n            if (!startPoint || !endPoint) {\r\n                return;\r\n            }\r\n            var box = {\r\n                minX: Math.min(startPoint.x, endPoint.x),\r\n                minY: Math.min(startPoint.y, endPoint.y),\r\n                maxX: Math.max(startPoint.x, endPoint.x),\r\n                maxY: Math.max(startPoint.y, endPoint.y),\r\n            };\r\n            var view = this.context.view;\r\n            elements = getIntersectElements(view, box);\r\n        }\r\n        return elements;\r\n    };\r\n    ElementRangeState.prototype.setStateEnable = function (enable) {\r\n        if (this.effectSiblings && !this.effectByRecord) {\r\n            this.setSiblingsState(enable);\r\n        }\r\n        else {\r\n            var allElements = getElements(this.context.view);\r\n            var elements = this.getIntersectElements();\r\n            if (elements && elements.length) {\r\n                if (this.effectByRecord) {\r\n                    this.setSiblingsStateByRecord(elements, enable);\r\n                }\r\n                else {\r\n                    this.setElementsState(elements, enable, allElements);\r\n                }\r\n            }\r\n            else {\r\n                this.clear();\r\n            }\r\n        }\r\n    };\r\n    ElementRangeState.prototype.setSiblingsStateByRecord = function (elements, enable) {\r\n        var _this = this;\r\n        var view = this.context.view;\r\n        var siblings = getSilbings(view);\r\n        var records = elements.map(function (el) {\r\n            return el.getModel().data;\r\n        });\r\n        var xFiled = view.getXScale().field;\r\n        var yField = view.getYScales()[0].field;\r\n        each(siblings, function (sibling) {\r\n            var allElements = getElements(sibling);\r\n            var effectElements = allElements.filter(function (el) {\r\n                var record = el.getModel().data;\r\n                return isInRecords(records, record, xFiled, yField);\r\n            });\r\n            _this.setElementsState(effectElements, enable, allElements);\r\n        });\r\n    };\r\n    ElementRangeState.prototype.setSiblingsState = function (enable) {\r\n        var _this = this;\r\n        var view = this.context.view;\r\n        var siblings = getSilbings(view);\r\n        if (isMask(this.context)) {\r\n            each(siblings, function (sibling) {\r\n                var allElements = getElements(sibling);\r\n                var effectElements = getSiblingMaskElements(_this.context, sibling, 10);\r\n                if (effectElements && effectElements.length) {\r\n                    _this.setElementsState(effectElements, enable, allElements);\r\n                }\r\n                else {\r\n                    _this.clearViewState(sibling);\r\n                }\r\n            });\r\n        }\r\n    };\r\n    ElementRangeState.prototype.setElementsState = function (elements, enable, allElements) {\r\n        var _this = this;\r\n        each(allElements, function (el) {\r\n            if (!elements.includes(el)) {\r\n                _this.setElementState(el, false);\r\n            }\r\n            else {\r\n                _this.setElementState(el, enable);\r\n            }\r\n        });\r\n    };\r\n    ElementRangeState.prototype.end = function () {\r\n        this.isStarted = false;\r\n        this.endPoint = this.getCurrentPoint();\r\n    };\r\n    ElementRangeState.prototype.clear = function () {\r\n        var _this = this;\r\n        var view = this.context.view;\r\n        if (this.effectSiblings) {\r\n            var siblings = getSilbings(view);\r\n            each(siblings, function (sibling) {\r\n                _this.clearViewState(sibling);\r\n            });\r\n        }\r\n        else {\r\n            this.clearViewState(view);\r\n        }\r\n    };\r\n    return ElementRangeState;\r\n}(StateBase));\r\nexport default ElementRangeState;\r\n",{"version":3,"file":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\@antv\\g2plot\\node_modules\\@antv\\g2\\esm\\interaction\\action\\element\\range-state.js","sourceRoot":"","sources":["D:\\project\\Deecamp-project\\system\\Web\\node_modules\\@antv\\g2plot\\node_modules\\@antv\\g2\\esm\\interaction\\action\\element\\range-state.js"],"names":[],"mappings":"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","sourcesContent":["import { __extends } from \"tslib\";\nimport { each } from '@antv/util';\nimport { getElements, getIntersectElements, getMaskedElements, getSiblingMaskElements, getSilbings, isInRecords, isMask, } from '../util';\nimport StateBase from './state-base';\n/**\n * @ignore\n * 区域设置状态的基础 Action\n */\nvar ElementRangeState = /** @class */ (function (_super) {\n    __extends(ElementRangeState, _super);\n    function ElementRangeState() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.startPoint = null;\n        _this.endPoint = null;\n        _this.isStarted = false;\n        /**\n         * 是否作用于当前 view 的 siblings，默认是 false 仅作用于自己\n         */\n        _this.effectSiblings = false;\n        /**\n         * 是否受 element 的数据影响，还是受包围盒的影响\n         */\n        _this.effectByRecord = false;\n        return _this;\n    }\n    // 获取当前的位置\n    ElementRangeState.prototype.getCurrentPoint = function () {\n        var event = this.context.event;\n        return {\n            x: event.x,\n            y: event.y,\n        };\n    };\n    /**\n     * 开始，记录开始选中的位置\n     */\n    ElementRangeState.prototype.start = function () {\n        this.clear(); // 开始的时候清理之前的状态\n        this.startPoint = this.getCurrentPoint();\n        this.isStarted = true;\n    };\n    ElementRangeState.prototype.getIntersectElements = function () {\n        var elements = null;\n        if (isMask(this.context)) {\n            elements = getMaskedElements(this.context, 10);\n        }\n        else {\n            var startPoint = this.startPoint;\n            var endPoint = this.isStarted ? this.getCurrentPoint() : this.endPoint;\n            // 如果没有开始，则不允许范围设置状态，保护性质\n            if (!startPoint || !endPoint) {\n                return;\n            }\n            // 计算框选区域\n            var box = {\n                minX: Math.min(startPoint.x, endPoint.x),\n                minY: Math.min(startPoint.y, endPoint.y),\n                maxX: Math.max(startPoint.x, endPoint.x),\n                maxY: Math.max(startPoint.y, endPoint.y),\n            };\n            // this.clear(); // 不全部清理，会导致闪烁\n            var view = this.context.view;\n            elements = getIntersectElements(view, box);\n        }\n        return elements;\n    };\n    /**\n     * 选中\n     */\n    ElementRangeState.prototype.setStateEnable = function (enable) {\n        if (this.effectSiblings && !this.effectByRecord) {\n            this.setSiblingsState(enable);\n        }\n        else {\n            var allElements = getElements(this.context.view);\n            var elements = this.getIntersectElements();\n            if (elements && elements.length) {\n                if (this.effectByRecord) {\n                    this.setSiblingsStateByRecord(elements, enable);\n                }\n                else {\n                    this.setElementsState(elements, enable, allElements);\n                }\n            }\n            else {\n                this.clear();\n            }\n        }\n    };\n    // 根据选中的 element 的数据进行设置状态\n    ElementRangeState.prototype.setSiblingsStateByRecord = function (elements, enable) {\n        var _this = this;\n        var view = this.context.view;\n        var siblings = getSilbings(view);\n        var records = elements.map(function (el) {\n            return el.getModel().data;\n        });\n        var xFiled = view.getXScale().field;\n        var yField = view.getYScales()[0].field;\n        each(siblings, function (sibling) {\n            var allElements = getElements(sibling);\n            var effectElements = allElements.filter(function (el) {\n                var record = el.getModel().data;\n                return isInRecords(records, record, xFiled, yField);\n            });\n            _this.setElementsState(effectElements, enable, allElements);\n        });\n    };\n    // 设置兄弟 view 的状态\n    ElementRangeState.prototype.setSiblingsState = function (enable) {\n        var _this = this;\n        var view = this.context.view;\n        var siblings = getSilbings(view);\n        if (isMask(this.context)) {\n            // 受 mask 影响\n            each(siblings, function (sibling) {\n                var allElements = getElements(sibling);\n                var effectElements = getSiblingMaskElements(_this.context, sibling, 10);\n                if (effectElements && effectElements.length) {\n                    _this.setElementsState(effectElements, enable, allElements);\n                }\n                else {\n                    _this.clearViewState(sibling);\n                }\n            });\n        }\n    };\n    ElementRangeState.prototype.setElementsState = function (elements, enable, allElements) {\n        var _this = this;\n        each(allElements, function (el) {\n            if (!elements.includes(el)) {\n                _this.setElementState(el, false);\n            }\n            else {\n                _this.setElementState(el, enable);\n            }\n        });\n    };\n    /**\n     * 结束\n     */\n    ElementRangeState.prototype.end = function () {\n        this.isStarted = false;\n        this.endPoint = this.getCurrentPoint();\n    };\n    // 复写 clear\n    ElementRangeState.prototype.clear = function () {\n        var _this = this;\n        var view = this.context.view;\n        // 判断是否影响 siblings\n        if (this.effectSiblings) {\n            var siblings = getSilbings(view);\n            each(siblings, function (sibling) {\n                _this.clearViewState(sibling);\n            });\n        }\n        else {\n            this.clearViewState(view);\n        }\n    };\n    return ElementRangeState;\n}(StateBase));\nexport default ElementRangeState;\n//# sourceMappingURL=range-state.js.map"]}]}