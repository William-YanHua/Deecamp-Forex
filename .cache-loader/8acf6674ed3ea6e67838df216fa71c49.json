{"remainingRequest":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\ts-loader\\index.js??ref--4-1!D:\\project\\Deecamp-project\\system\\Web\\node_modules\\@antv\\g2plot\\esm\\components\\label\\point-auto.js","dependencies":[{"path":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\@antv\\g2plot\\esm\\components\\label\\point-auto.js","mtime":499162500000},{"path":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1595520254649},{"path":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\ts-loader\\index.js","mtime":1537906253000}],"contextDependencies":[],"result":["import { __extends } from \"tslib\";\r\nimport { groupBy, each, keys } from '@antv/util';\r\nimport { registerLabelComponent } from './base';\r\nimport PointLabel from './point';\r\nimport { FIELD_ORIGIN, ORIGIN } from '../../dependents';\r\nimport { checkOriginEqual, moveInPanel, checkShapeOverlap } from '../../util/view';\r\nimport BBox from '../../util/bbox';\r\nvar PointAutoLabel = (function (_super) {\r\n    __extends(PointAutoLabel, _super);\r\n    function PointAutoLabel() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    PointAutoLabel.prototype.layoutLabels = function (geometry, labels) {\r\n        var _this = this;\r\n        var _a;\r\n        var dones = [];\r\n        var panel = BBox.fromBBoxObject(this.getCoordinateBBox());\r\n        var _b = geometry.getXYFields(), xField = _b[0], yField = _b[1];\r\n        var groupedMap = groupBy(labels, function (label) { return label.get(ORIGIN)[FIELD_ORIGIN][xField]; });\r\n        var offset = (_a = labels[0]) === null || _a === void 0 ? void 0 : _a.get('offset');\r\n        each(keys(groupedMap).reverse(), function (xValue) {\r\n            var group = _this.sortLabels(geometry, groupedMap[xValue]);\r\n            while (group.length) {\r\n                var label = group.shift();\r\n                if (checkOriginEqual(label, dones, function (datumLeft, datumRight) {\r\n                    return datumLeft._origin[xField] === datumRight._origin[xField] &&\r\n                        datumLeft._origin[yField] === datumRight._origin[yField];\r\n                })) {\r\n                    label.set('visible', false);\r\n                    continue;\r\n                }\r\n                moveInPanel(label, panel);\r\n                var upFail = checkShapeOverlap(label, dones);\r\n                var downFail = void 0;\r\n                if (upFail) {\r\n                    label.attr('y', label.attr('y') + 2 * offset);\r\n                    moveInPanel(label, panel);\r\n                    downFail = checkShapeOverlap(label, dones);\r\n                }\r\n                if (downFail) {\r\n                    label.set('visible', false);\r\n                    continue;\r\n                }\r\n                dones.push(label);\r\n            }\r\n        });\r\n    };\r\n    PointAutoLabel.prototype.sortLabels = function (geometry, labels) {\r\n        var yField = geometry.getXYFields()[1];\r\n        var sorted = [];\r\n        labels.sort(function (a, b) {\r\n            return b.get(ORIGIN)[FIELD_ORIGIN][yField] - a.get(ORIGIN)[FIELD_ORIGIN][yField];\r\n        });\r\n        if (labels.length > 0) {\r\n            sorted.push(labels.shift());\r\n        }\r\n        if (labels.length > 0) {\r\n            sorted.push(labels.pop());\r\n        }\r\n        sorted.push.apply(sorted, labels);\r\n        return sorted;\r\n    };\r\n    return PointAutoLabel;\r\n}(PointLabel));\r\nexport default PointAutoLabel;\r\nregisterLabelComponent('point-auto', PointAutoLabel);\r\n",{"version":3,"file":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\@antv\\g2plot\\esm\\components\\label\\point-auto.js","sourceRoot":"","sources":["D:\\project\\Deecamp-project\\system\\Web\\node_modules\\@antv\\g2plot\\esm\\components\\label\\point-auto.js"],"names":[],"mappings":"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","sourcesContent":["import { __extends } from \"tslib\";\nimport { groupBy, each, keys } from '@antv/util';\nimport { registerLabelComponent } from './base';\nimport PointLabel from './point';\nimport { FIELD_ORIGIN, ORIGIN } from '../../dependents';\nimport { checkOriginEqual, moveInPanel, checkShapeOverlap } from '../../util/view';\nimport BBox from '../../util/bbox';\nvar PointAutoLabel = /** @class */ (function (_super) {\n    __extends(PointAutoLabel, _super);\n    function PointAutoLabel() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    PointAutoLabel.prototype.layoutLabels = function (geometry, labels) {\n        var _this = this;\n        var _a;\n        var dones = [];\n        var panel = BBox.fromBBoxObject(this.getCoordinateBBox());\n        var _b = geometry.getXYFields(), xField = _b[0], yField = _b[1];\n        var groupedMap = groupBy(labels, function (label) { return label.get(ORIGIN)[FIELD_ORIGIN][xField]; });\n        var offset = (_a = labels[0]) === null || _a === void 0 ? void 0 : _a.get('offset');\n        each(keys(groupedMap).reverse(), function (xValue) {\n            var group = _this.sortLabels(geometry, groupedMap[xValue]);\n            while (group.length) {\n                var label = group.shift();\n                if (checkOriginEqual(label, dones, function (datumLeft, datumRight) {\n                    return datumLeft._origin[xField] === datumRight._origin[xField] &&\n                        datumLeft._origin[yField] === datumRight._origin[yField];\n                })) {\n                    label.set('visible', false);\n                    continue;\n                }\n                moveInPanel(label, panel);\n                var upFail = checkShapeOverlap(label, dones);\n                var downFail = void 0;\n                if (upFail) {\n                    label.attr('y', label.attr('y') + 2 * offset);\n                    moveInPanel(label, panel);\n                    downFail = checkShapeOverlap(label, dones);\n                }\n                if (downFail) {\n                    label.set('visible', false);\n                    continue;\n                }\n                dones.push(label);\n            }\n        });\n    };\n    /** 对 Labels 排序，排序顺序决定自动布局优先级 */\n    PointAutoLabel.prototype.sortLabels = function (geometry, labels) {\n        var yField = geometry.getXYFields()[1];\n        var sorted = [];\n        // 顺序：第一个、最后一个、再其他\n        labels.sort(function (a, b) {\n            return b.get(ORIGIN)[FIELD_ORIGIN][yField] - a.get(ORIGIN)[FIELD_ORIGIN][yField];\n        });\n        if (labels.length > 0) {\n            sorted.push(labels.shift());\n        }\n        if (labels.length > 0) {\n            sorted.push(labels.pop());\n        }\n        sorted.push.apply(sorted, labels);\n        return sorted;\n    };\n    return PointAutoLabel;\n}(PointLabel));\nexport default PointAutoLabel;\nregisterLabelComponent('point-auto', PointAutoLabel);\n//# sourceMappingURL=point-auto.js.map"]}]}