{"remainingRequest":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\ts-loader\\index.js??ref--4-1!D:\\project\\Deecamp-project\\system\\Web\\node_modules\\@antv\\g2plot\\esm\\plots\\bar\\component\\label.js","dependencies":[{"path":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\@antv\\g2plot\\esm\\plots\\bar\\component\\label.js","mtime":499162500000},{"path":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1595520254649},{"path":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\ts-loader\\index.js","mtime":1537906253000}],"contextDependencies":[],"result":["import { __assign, __extends } from \"tslib\";\r\nimport { each, get, deepMix } from '@antv/util';\r\nimport { _ORIGIN } from '../../../dependents';\r\nimport BaseLabel, { registerLabelComponent } from '../../../components/label/base';\r\nimport { rgb2arr, mappingColor } from '../../../util/color';\r\nimport BBox from '../../../util/bbox';\r\nvar BarLabel = (function (_super) {\r\n    __extends(BarLabel, _super);\r\n    function BarLabel() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    BarLabel.prototype.getLabelItemAttrs = function (element, index) {\r\n        var _a;\r\n        var _b = this.options, style = _b.style, formatter = _b.formatter;\r\n        var mappingData = [].concat(element.getModel().mappingData);\r\n        var value = this.getValue(element);\r\n        return deepMix({}, style, __assign(__assign({}, this.getPosition(element)), { text: formatter\r\n                ? formatter(value, (_a = {},\r\n                    _a[_ORIGIN] = mappingData[0]._origin,\r\n                    _a.mappingDatum = mappingData[0],\r\n                    _a.mappingDatumIndex = 0,\r\n                    _a.element = element,\r\n                    _a.elementIndex = index,\r\n                    _a), index)\r\n                : value, fill: this.getTextFill(element), stroke: this.getTextStroke(element), textAlign: this.getTextAlign(element), textBaseline: this.getTextBaseline() }));\r\n    };\r\n    BarLabel.prototype.adjustLabel = function (label, element) {\r\n        var _a = this.options, adjustPosition = _a.adjustPosition, style = _a.style;\r\n        if (adjustPosition) {\r\n            var offset = this.getDefaultOffset();\r\n            var labelRange = label.getBBox();\r\n            var shapeRange = this.getElementShapeBBox(element);\r\n            if (shapeRange.width <= labelRange.width) {\r\n                var xPosition = shapeRange.maxX + this.options.offsetX + offset;\r\n                label.attr('x', xPosition);\r\n                label.attr('fill', style.fill);\r\n            }\r\n        }\r\n    };\r\n    BarLabel.prototype.getDefaultOptions = function () {\r\n        var theme = this.layer.theme;\r\n        var _a = theme.label, label = _a === void 0 ? {} : _a;\r\n        return __assign({ offsetX: 0, offsetY: 0, adjustPosition: true }, label);\r\n    };\r\n    BarLabel.prototype.getValue = function (element) {\r\n        return get(element.getData(), this.layer.options.xField);\r\n    };\r\n    BarLabel.prototype.getPosition = function (element) {\r\n        var offset = this.getDefaultOffset();\r\n        var value = this.getValue(element);\r\n        var bbox = this.getElementShapeBBox(element);\r\n        var minX = bbox.minX, maxX = bbox.maxX, minY = bbox.minY, height = bbox.height, width = bbox.width;\r\n        var _a = this.options, offsetX = _a.offsetX, offsetY = _a.offsetY, position = _a.position;\r\n        var y = minY + height / 2 + offsetY;\r\n        var dir = value < 0 ? -1 : 1;\r\n        var x;\r\n        if (position === 'left') {\r\n            var root = value > 0 ? minX : maxX;\r\n            x = root + offset * dir + offsetX;\r\n        }\r\n        else if (position === 'right') {\r\n            var root = value > 0 ? maxX : minX;\r\n            x = root + offset * dir + offsetX;\r\n        }\r\n        else {\r\n            x = minX + width / 2 + offsetX;\r\n        }\r\n        return { x: x, y: y };\r\n    };\r\n    BarLabel.prototype.getTextFill = function (element) {\r\n        var shape = element.shape;\r\n        if (this.options.adjustColor && this.options.position !== 'right') {\r\n            var shapeColor = shape.attr('fill');\r\n            var shapeOpacity = shape.attr('opacity') ? shape.attr('opacity') : 1;\r\n            var rgb = rgb2arr(shapeColor);\r\n            var gray = Math.round(rgb[0] * 0.299 + rgb[1] * 0.587 + rgb[2] * 0.114) / shapeOpacity;\r\n            var colorBand = [\r\n                { from: 0, to: 85, color: 'white' },\r\n                { from: 85, to: 170, color: '#F6F6F6' },\r\n                { from: 170, to: 255, color: 'black' },\r\n            ];\r\n            var reflect = mappingColor(colorBand, gray);\r\n            return reflect;\r\n        }\r\n        var defaultColor = this.options.style.fill;\r\n        return defaultColor;\r\n    };\r\n    BarLabel.prototype.getTextStroke = function (element) {\r\n        var fill = this.getTextFill(element);\r\n        var _a = this.options, position = _a.position, adjustColor = _a.adjustColor;\r\n        return position !== 'right' && adjustColor && fill !== 'black' ? null : undefined;\r\n    };\r\n    BarLabel.prototype.getTextAlign = function (element) {\r\n        var value = this.getValue(element);\r\n        var position = this.options.position;\r\n        var alignOptions = {\r\n            right: 'left',\r\n            left: 'left',\r\n            middle: 'center',\r\n        };\r\n        var alignOptionsReverse = {\r\n            right: 'right',\r\n            left: 'right',\r\n            middle: 'center',\r\n        };\r\n        if (value < 0) {\r\n            return alignOptionsReverse[position];\r\n        }\r\n        return alignOptions[position];\r\n    };\r\n    BarLabel.prototype.getTextBaseline = function () {\r\n        return 'middle';\r\n    };\r\n    BarLabel.prototype.getElementShapeBBox = function (element) {\r\n        var _this = this;\r\n        var shape = element.shape;\r\n        var points = [];\r\n        each(shape.get('origin').points, function (p) {\r\n            points.push(_this.coord.convertPoint(p));\r\n        });\r\n        var xValues = points.map(function (point) { return point.x; });\r\n        var xValuesMin = Math.min.apply(Math, xValues);\r\n        var xValueMax = Math.max.apply(Math, xValues);\r\n        var yValues = points.map(function (point) { return point.y; });\r\n        var yValuesMin = Math.min.apply(Math, yValues);\r\n        var yValuesMax = Math.max.apply(Math, yValues);\r\n        var bbox = new BBox(xValuesMin, yValuesMin, xValueMax - xValuesMin, yValuesMax - yValuesMin);\r\n        return bbox;\r\n    };\r\n    BarLabel.prototype.getLabelOffset = function () {\r\n        return {\r\n            x: 0,\r\n            y: 0,\r\n        };\r\n    };\r\n    return BarLabel;\r\n}(BaseLabel));\r\nexport default BarLabel;\r\nregisterLabelComponent('bar', BarLabel);\r\n",{"version":3,"file":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\@antv\\g2plot\\esm\\plots\\bar\\component\\label.js","sourceRoot":"","sources":["D:\\project\\Deecamp-project\\system\\Web\\node_modules\\@antv\\g2plot\\esm\\plots\\bar\\component\\label.js"],"names":[],"mappings":"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","sourcesContent":["import { __assign, __extends } from \"tslib\";\nimport { each, get, deepMix } from '@antv/util';\nimport { _ORIGIN } from '../../../dependents';\nimport BaseLabel, { registerLabelComponent } from '../../../components/label/base';\nimport { rgb2arr, mappingColor } from '../../../util/color';\nimport BBox from '../../../util/bbox';\nvar BarLabel = /** @class */ (function (_super) {\n    __extends(BarLabel, _super);\n    function BarLabel() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    BarLabel.prototype.getLabelItemAttrs = function (element, index) {\n        var _a;\n        var _b = this.options, style = _b.style, formatter = _b.formatter;\n        var mappingData = [].concat(element.getModel().mappingData);\n        var value = this.getValue(element);\n        return deepMix({}, style, __assign(__assign({}, this.getPosition(element)), { text: formatter\n                ? formatter(value, (_a = {},\n                    _a[_ORIGIN] = mappingData[0]._origin,\n                    _a.mappingDatum = mappingData[0],\n                    _a.mappingDatumIndex = 0,\n                    _a.element = element,\n                    _a.elementIndex = index,\n                    _a), index)\n                : value, fill: this.getTextFill(element), stroke: this.getTextStroke(element), textAlign: this.getTextAlign(element), textBaseline: this.getTextBaseline() }));\n    };\n    BarLabel.prototype.adjustLabel = function (label, element) {\n        var _a = this.options, adjustPosition = _a.adjustPosition, style = _a.style;\n        if (adjustPosition) {\n            var offset = this.getDefaultOffset();\n            var labelRange = label.getBBox();\n            var shapeRange = this.getElementShapeBBox(element);\n            if (shapeRange.width <= labelRange.width) {\n                var xPosition = shapeRange.maxX + this.options.offsetX + offset;\n                label.attr('x', xPosition);\n                label.attr('fill', style.fill);\n            }\n        }\n    };\n    BarLabel.prototype.getDefaultOptions = function () {\n        var theme = this.layer.theme;\n        var _a = theme.label, label = _a === void 0 ? {} : _a;\n        return __assign({ offsetX: 0, offsetY: 0, adjustPosition: true }, label);\n    };\n    BarLabel.prototype.getValue = function (element) {\n        return get(element.getData(), this.layer.options.xField);\n    };\n    BarLabel.prototype.getPosition = function (element) {\n        var offset = this.getDefaultOffset();\n        var value = this.getValue(element);\n        var bbox = this.getElementShapeBBox(element);\n        var minX = bbox.minX, maxX = bbox.maxX, minY = bbox.minY, height = bbox.height, width = bbox.width;\n        var _a = this.options, offsetX = _a.offsetX, offsetY = _a.offsetY, position = _a.position;\n        var y = minY + height / 2 + offsetY;\n        var dir = value < 0 ? -1 : 1;\n        var x;\n        if (position === 'left') {\n            var root = value > 0 ? minX : maxX;\n            x = root + offset * dir + offsetX;\n        }\n        else if (position === 'right') {\n            var root = value > 0 ? maxX : minX;\n            x = root + offset * dir + offsetX;\n        }\n        else {\n            x = minX + width / 2 + offsetX;\n        }\n        return { x: x, y: y };\n    };\n    BarLabel.prototype.getTextFill = function (element) {\n        var shape = element.shape;\n        if (this.options.adjustColor && this.options.position !== 'right') {\n            var shapeColor = shape.attr('fill');\n            var shapeOpacity = shape.attr('opacity') ? shape.attr('opacity') : 1;\n            var rgb = rgb2arr(shapeColor);\n            var gray = Math.round(rgb[0] * 0.299 + rgb[1] * 0.587 + rgb[2] * 0.114) / shapeOpacity;\n            var colorBand = [\n                { from: 0, to: 85, color: 'white' },\n                { from: 85, to: 170, color: '#F6F6F6' },\n                { from: 170, to: 255, color: 'black' },\n            ];\n            var reflect = mappingColor(colorBand, gray);\n            return reflect;\n        }\n        var defaultColor = this.options.style.fill;\n        return defaultColor;\n    };\n    BarLabel.prototype.getTextStroke = function (element) {\n        var fill = this.getTextFill(element);\n        var _a = this.options, position = _a.position, adjustColor = _a.adjustColor;\n        return position !== 'right' && adjustColor && fill !== 'black' ? null : undefined;\n    };\n    BarLabel.prototype.getTextAlign = function (element) {\n        var value = this.getValue(element);\n        var position = this.options.position;\n        var alignOptions = {\n            right: 'left',\n            left: 'left',\n            middle: 'center',\n        };\n        var alignOptionsReverse = {\n            right: 'right',\n            left: 'right',\n            middle: 'center',\n        };\n        if (value < 0) {\n            return alignOptionsReverse[position];\n        }\n        return alignOptions[position];\n    };\n    BarLabel.prototype.getTextBaseline = function () {\n        return 'middle';\n    };\n    BarLabel.prototype.getElementShapeBBox = function (element) {\n        var _this = this;\n        var shape = element.shape;\n        var points = [];\n        each(shape.get('origin').points, function (p) {\n            points.push(_this.coord.convertPoint(p));\n        });\n        var xValues = points.map(function (point) { return point.x; });\n        var xValuesMin = Math.min.apply(Math, xValues);\n        var xValueMax = Math.max.apply(Math, xValues);\n        var yValues = points.map(function (point) { return point.y; });\n        var yValuesMin = Math.min.apply(Math, yValues);\n        var yValuesMax = Math.max.apply(Math, yValues);\n        var bbox = new BBox(xValuesMin, yValuesMin, xValueMax - xValuesMin, yValuesMax - yValuesMin);\n        return bbox;\n    };\n    BarLabel.prototype.getLabelOffset = function () {\n        // Column 的 offset 在 getPosition 中因 position 不同单独处理\n        return {\n            x: 0,\n            y: 0,\n        };\n    };\n    return BarLabel;\n}(BaseLabel));\nexport default BarLabel;\nregisterLabelComponent('bar', BarLabel);\n//# sourceMappingURL=label.js.map"]}]}