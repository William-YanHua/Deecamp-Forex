{"remainingRequest":"/run/media/williamyh/新加卷/project/Deecamp-project/system/Web/node_modules/ts-loader/index.js??ref--4-1!/run/media/williamyh/新加卷/project/Deecamp-project/system/Web/node_modules/@antv/g2plot/esm/plots/bullet/layer.js","dependencies":[{"path":"/run/media/williamyh/新加卷/project/Deecamp-project/system/Web/node_modules/@antv/g2plot/esm/plots/bullet/layer.js","mtime":499162500000},{"path":"/run/media/williamyh/新加卷/project/Deecamp-project/system/Web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/run/media/williamyh/新加卷/project/Deecamp-project/system/Web/node_modules/ts-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import { __assign, __extends } from \"tslib\";\nimport { deepMix, has } from '@antv/util';\nimport * as EventParser from './event';\nimport ViewLayer from '../../base/view-layer';\nimport { extractScale } from '../../util/scale';\nimport { getComponent } from '../../components/factory';\nimport { getGeom } from '../../geoms/factory';\nimport { registerPlotType } from '../../base/global';\nimport BulletRect from './component/bulletRect';\nimport BulletTarget from './component/bulletTarget';\nimport './theme';\nvar G2_GEOM_MAP = {\n    bullet: 'interval',\n};\nvar PLOT_GEOM_MAP = {\n    interval: 'bullet',\n};\nexport var STACK_FIELD = '$$stackField$$';\nexport var X_FIELD = '$$xField$$';\nexport var Y_FIELD = '$$yField$$';\nvar BulletLayer = (function (_super) {\n    __extends(BulletLayer, _super);\n    function BulletLayer() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.type = 'bullet';\n        return _this;\n    }\n    BulletLayer.getDefaultOptions = function () {\n        return deepMix({}, _super.getDefaultOptions.call(this), {\n            data: [],\n            stackField: STACK_FIELD,\n            xField: X_FIELD,\n            yField: Y_FIELD,\n            rangeColors: ['rgba(91, 143, 249, 0.45)'],\n            measureSize: 12,\n            rangeSize: 2,\n            markerSize: 2,\n            markerColors: [],\n            markerStyle: {\n                width: 2,\n                fill: '#5B8FF9',\n                lineWidth: 0,\n            },\n            axis: {\n                visible: false,\n                position: 'before',\n                tickCount: 6,\n                formatter: function (text, idx) { return \"\" + idx; },\n                style: {\n                    fill: 'rgba(0, 0, 0, 0.25)',\n                    textBaseline: 'middle',\n                    textAlign: 'center',\n                    fontSize: 12,\n                    lineHeight: 16,\n                },\n                tickLine: {\n                    visible: true,\n                    lineWidth: 1,\n                    stroke: '#FFF',\n                    lineDash: [4, 2],\n                },\n            },\n            xAxis: {\n                visible: true,\n                line: {\n                    visible: false,\n                },\n                tickLine: {\n                    visible: false,\n                },\n                label: {\n                    visible: true,\n                },\n            },\n            yAxis: {\n                visible: false,\n                nice: false,\n            },\n            tooltip: {\n                visible: false,\n                trigger: 'item',\n                crosshairs: false,\n            },\n            label: {\n                visible: true,\n                offset: 4,\n                style: {\n                    fill: 'rgba(0, 0, 0, 0.45)',\n                    stroke: '#fff',\n                    lineWidth: 1,\n                },\n            },\n        });\n    };\n    BulletLayer.prototype.afterRender = function () {\n        _super.prototype.afterRender.call(this);\n        this.view.removeInteraction('legend-filter');\n    };\n    BulletLayer.prototype.scale = function () {\n        var options = this.options;\n        var scales = {};\n        scales[options.yField] = {};\n        if (has(options, 'yAxis')) {\n            extractScale(scales[options.yField], options.yAxis);\n        }\n        scales[options.xField] = {\n            type: 'cat',\n        };\n        if (has(options, 'xAxis')) {\n            extractScale(scales[options.xField], options.xAxis);\n        }\n        this.setConfig('scales', scales);\n        _super.prototype.scale.call(this);\n    };\n    BulletLayer.prototype.getOptions = function (props) {\n        var options = _super.prototype.getOptions.call(this, props);\n        this.adjustOptions(options);\n        return options;\n    };\n    BulletLayer.prototype.afterInit = function () {\n        _super.prototype.afterInit.call(this);\n        var options = this.options;\n        var ranges = options.data.map(function (d) { return d.ranges; });\n        var targets = options.data.map(function (d) { return d.targets; });\n        this.bulletRect = new BulletRect(this.view, {\n            ranges: ranges,\n            rangeMax: options.rangeMax,\n            yField: options.yField,\n            rangeSize: options.rangeSize,\n            rangeColors: options.rangeColors || [],\n            axis: options.axis,\n        });\n        this.bulletTarget = new BulletTarget(this.view, {\n            targets: targets,\n            yField: options.yField,\n            markerSize: options.markerSize,\n            markerColors: options.markerColors || [],\n            markerStyle: options.markerStyle,\n        });\n    };\n    BulletLayer.prototype.geometryParser = function (dim, type) {\n        if (dim === 'g2') {\n            return G2_GEOM_MAP[type];\n        }\n        return PLOT_GEOM_MAP[type];\n    };\n    BulletLayer.prototype.coord = function () {\n        this.setConfig('coordinate', {\n            actions: [['transpose']],\n        });\n    };\n    BulletLayer.prototype.legend = function () {\n        var options = this.options;\n        var markerColor = options.markerStyle.fill;\n        var measureColors = options.measureColors || this.theme.colors;\n        var items = [\n            {\n                name: '实际进度',\n                value: '实际进度',\n                marker: {\n                    symbol: 'square',\n                    style: {\n                        fill: measureColors[0],\n                    },\n                },\n            },\n            {\n                name: '目标值',\n                value: '目标值',\n                marker: {\n                    symbol: 'line',\n                    style: {\n                        stroke: markerColor,\n                        lineWidth: 2,\n                    },\n                },\n            },\n        ];\n        var legendOptions = __assign({ custom: true, position: 'bottom', items: items }, options.legend);\n        this.setConfig('legends', legendOptions);\n    };\n    BulletLayer.prototype.addGeometry = function () {\n        var options = this.options;\n        var bullet = getGeom('interval', 'main', {\n            positionFields: [options.xField, options.yField],\n            plot: this,\n        });\n        bullet.adjust = [\n            {\n                type: 'stack',\n            },\n        ];\n        if (options.label) {\n            bullet.label = this.extractLabel();\n        }\n        this.bullet = bullet;\n        this.setConfig('geometry', bullet);\n    };\n    BulletLayer.prototype.parseEvents = function () {\n        _super.prototype.parseEvents.call(this, EventParser);\n    };\n    BulletLayer.prototype.extractLabel = function () {\n        var options = this.options;\n        var label = deepMix({}, options.label);\n        if (label.visible === false) {\n            return false;\n        }\n        var labelConfig = getComponent('label', __assign({ plot: this, labelType: 'barLabel', fields: [options.yField] }, label));\n        return labelConfig;\n    };\n    BulletLayer.prototype.adjustOptions = function (options) {\n        options.barSize = options.measureSize || 12;\n        this.adjustYAxisOptions(options);\n    };\n    BulletLayer.prototype.adjustYAxisOptions = function (options) {\n        var values = [];\n        options.data.forEach(function (d) { return values.push(d.measures.reduce(function (a, b) { return a + b; }, 0)); });\n        values.push(options.rangeMax);\n        options.yAxis.max = Math.max.apply([], values);\n    };\n    BulletLayer.prototype.processData = function (dataOptions) {\n        var options = this.options;\n        var data = [];\n        dataOptions.forEach(function (dataItem, dataIdx) {\n            var _a;\n            for (var valueIdx = 0; valueIdx < dataItem.measures.length; valueIdx += 1) {\n                var value = dataItem.measures[valueIdx];\n                var xField = dataItem.title || \"\" + dataIdx;\n                data.push((_a = {},\n                    _a[options.xField] = xField,\n                    _a[options.yField] = value,\n                    _a[options.stackField] = \"\" + valueIdx,\n                    _a));\n            }\n        });\n        return data;\n    };\n    return BulletLayer;\n}(ViewLayer));\nexport default BulletLayer;\nregisterPlotType('bullet', BulletLayer);\n",{"version":3,"file":"/run/media/williamyh/新加卷/project/Deecamp-project/system/Web/node_modules/@antv/g2plot/esm/plots/bullet/layer.js","sourceRoot":"","sources":["/run/media/williamyh/新加卷/project/Deecamp-project/system/Web/node_modules/@antv/g2plot/esm/plots/bullet/layer.js"],"names":[],"mappings":"AAAA,OAAO,EAAE,QAAQ,EAAE,SAAS,EAAE,MAAM,OAAO,CAAC;AAC5C,OAAO,EAAE,OAAO,EAAE,GAAG,EAAE,MAAM,YAAY,CAAC;AAC1C,OAAO,KAAK,WAAW,MAAM,SAAS,CAAC;AACvC,OAAO,SAAS,MAAM,uBAAuB,CAAC;AAC9C,OAAO,EAAE,YAAY,EAAE,MAAM,kBAAkB,CAAC;AAChD,OAAO,EAAE,YAAY,EAAE,MAAM,0BAA0B,CAAC;AACxD,OAAO,EAAE,OAAO,EAAE,MAAM,qBAAqB,CAAC;AAC9C,OAAO,EAAE,gBAAgB,EAAE,MAAM,mBAAmB,CAAC;AACrD,OAAO,UAAU,MAAM,wBAAwB,CAAC;AAChD,OAAO,YAAY,MAAM,0BAA0B,CAAC;AACpD,OAAO,SAAS,CAAC;AACjB,IAAI,WAAW,GAAG;IACd,MAAM,EAAE,UAAU;CACrB,CAAC;AACF,IAAI,aAAa,GAAG;IAChB,QAAQ,EAAE,QAAQ;CACrB,CAAC;AACF,MAAM,CAAC,IAAI,WAAW,GAAG,gBAAgB,CAAC;AAC1C,MAAM,CAAC,IAAI,OAAO,GAAG,YAAY,CAAC;AAClC,MAAM,CAAC,IAAI,OAAO,GAAG,YAAY,CAAC;AAClC,IAAI,WAAW,GAAiB,CAAC,UAAU,MAAM;IAC7C,SAAS,CAAC,WAAW,EAAE,MAAM,CAAC,CAAC;IAC/B,SAAS,WAAW;QAChB,IAAI,KAAK,GAAG,MAAM,KAAK,IAAI,IAAI,MAAM,CAAC,KAAK,CAAC,IAAI,EAAE,SAAS,CAAC,IAAI,IAAI,CAAC;QACrE,KAAK,CAAC,IAAI,GAAG,QAAQ,CAAC;QACtB,OAAO,KAAK,CAAC;IACjB,CAAC;IACD,WAAW,CAAC,iBAAiB,GAAG;QAC5B,OAAO,OAAO,CAAC,EAAE,EAAE,MAAM,CAAC,iBAAiB,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE;YACpD,IAAI,EAAE,EAAE;YACR,UAAU,EAAE,WAAW;YACvB,MAAM,EAAE,OAAO;YACf,MAAM,EAAE,OAAO;YACf,WAAW,EAAE,CAAC,0BAA0B,CAAC;YACzC,WAAW,EAAE,EAAE;YACf,SAAS,EAAE,CAAC;YACZ,UAAU,EAAE,CAAC;YACb,YAAY,EAAE,EAAE;YAChB,WAAW,EAAE;gBACT,KAAK,EAAE,CAAC;gBACR,IAAI,EAAE,SAAS;gBACf,SAAS,EAAE,CAAC;aACf;YACD,IAAI,EAAE;gBACF,OAAO,EAAE,KAAK;gBACd,QAAQ,EAAE,QAAQ;gBAClB,SAAS,EAAE,CAAC;gBACZ,SAAS,EAAE,UAAU,IAAI,EAAE,GAAG,IAAI,OAAO,EAAE,GAAG,GAAG,CAAC,CAAC,CAAC;gBACpD,KAAK,EAAE;oBACH,IAAI,EAAE,qBAAqB;oBAC3B,YAAY,EAAE,QAAQ;oBACtB,SAAS,EAAE,QAAQ;oBACnB,QAAQ,EAAE,EAAE;oBACZ,UAAU,EAAE,EAAE;iBACjB;gBACD,QAAQ,EAAE;oBACN,OAAO,EAAE,IAAI;oBACb,SAAS,EAAE,CAAC;oBACZ,MAAM,EAAE,MAAM;oBACd,QAAQ,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC;iBACnB;aACJ;YACD,KAAK,EAAE;gBACH,OAAO,EAAE,IAAI;gBACb,IAAI,EAAE;oBACF,OAAO,EAAE,KAAK;iBACjB;gBACD,QAAQ,EAAE;oBACN,OAAO,EAAE,KAAK;iBACjB;gBACD,KAAK,EAAE;oBACH,OAAO,EAAE,IAAI;iBAChB;aACJ;YACD,KAAK,EAAE;gBACH,OAAO,EAAE,KAAK;gBACd,IAAI,EAAE,KAAK;aACd;YACD,OAAO,EAAE;gBACL,OAAO,EAAE,KAAK;gBACd,OAAO,EAAE,MAAM;gBACf,UAAU,EAAE,KAAK;aACpB;YACD,KAAK,EAAE;gBACH,OAAO,EAAE,IAAI;gBACb,MAAM,EAAE,CAAC;gBACT,KAAK,EAAE;oBACH,IAAI,EAAE,qBAAqB;oBAC3B,MAAM,EAAE,MAAM;oBACd,SAAS,EAAE,CAAC;iBACf;aACJ;SACJ,CAAC,CAAC;IACP,CAAC,CAAC;IACF,WAAW,CAAC,SAAS,CAAC,WAAW,GAAG;QAChC,MAAM,CAAC,SAAS,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QACxC,IAAI,CAAC,IAAI,CAAC,iBAAiB,CAAC,eAAe,CAAC,CAAC;IACjD,CAAC,CAAC;IACF,WAAW,CAAC,SAAS,CAAC,KAAK,GAAG;QAC1B,IAAI,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC;QAC3B,IAAI,MAAM,GAAG,EAAE,CAAC;QAEhB,MAAM,CAAC,OAAO,CAAC,MAAM,CAAC,GAAG,EAAE,CAAC;QAC5B,IAAI,GAAG,CAAC,OAAO,EAAE,OAAO,CAAC,EAAE;YACvB,YAAY,CAAC,MAAM,CAAC,OAAO,CAAC,MAAM,CAAC,EAAE,OAAO,CAAC,KAAK,CAAC,CAAC;SACvD;QAED,MAAM,CAAC,OAAO,CAAC,MAAM,CAAC,GAAG;YACrB,IAAI,EAAE,KAAK;SACd,CAAC;QACF,IAAI,GAAG,CAAC,OAAO,EAAE,OAAO,CAAC,EAAE;YACvB,YAAY,CAAC,MAAM,CAAC,OAAO,CAAC,MAAM,CAAC,EAAE,OAAO,CAAC,KAAK,CAAC,CAAC;SACvD;QACD,IAAI,CAAC,SAAS,CAAC,QAAQ,EAAE,MAAM,CAAC,CAAC;QACjC,MAAM,CAAC,SAAS,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;IACtC,CAAC,CAAC;IACF,WAAW,CAAC,SAAS,CAAC,UAAU,GAAG,UAAU,KAAK;QAC9C,IAAI,OAAO,GAAG,MAAM,CAAC,SAAS,CAAC,UAAU,CAAC,IAAI,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC;QAC5D,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,CAAC;QAC5B,OAAO,OAAO,CAAC;IACnB,CAAC,CAAC;IACF,WAAW,CAAC,SAAS,CAAC,SAAS,GAAG;QAC9B,MAAM,CAAC,SAAS,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QACtC,IAAI,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC;QAC3B,IAAI,MAAM,GAAG,OAAO,CAAC,IAAI,CAAC,GAAG,CAAC,UAAU,CAAC,IAAI,OAAO,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC;QACjE,IAAI,OAAO,GAAG,OAAO,CAAC,IAAI,CAAC,GAAG,CAAC,UAAU,CAAC,IAAI,OAAO,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC;QACnE,IAAI,CAAC,UAAU,GAAG,IAAI,UAAU,CAAC,IAAI,CAAC,IAAI,EAAE;YACxC,MAAM,EAAE,MAAM;YACd,QAAQ,EAAE,OAAO,CAAC,QAAQ;YAC1B,MAAM,EAAE,OAAO,CAAC,MAAM;YACtB,SAAS,EAAE,OAAO,CAAC,SAAS;YAC5B,WAAW,EAAE,OAAO,CAAC,WAAW,IAAI,EAAE;YACtC,IAAI,EAAE,OAAO,CAAC,IAAI;SACrB,CAAC,CAAC;QACH,IAAI,CAAC,YAAY,GAAG,IAAI,YAAY,CAAC,IAAI,CAAC,IAAI,EAAE;YAC5C,OAAO,EAAE,OAAO;YAChB,MAAM,EAAE,OAAO,CAAC,MAAM;YACtB,UAAU,EAAE,OAAO,CAAC,UAAU;YAC9B,YAAY,EAAE,OAAO,CAAC,YAAY,IAAI,EAAE;YACxC,WAAW,EAAE,OAAO,CAAC,WAAW;SACnC,CAAC,CAAC;IACP,CAAC,CAAC;IACF,WAAW,CAAC,SAAS,CAAC,cAAc,GAAG,UAAU,GAAG,EAAE,IAAI;QACtD,IAAI,GAAG,KAAK,IAAI,EAAE;YACd,OAAO,WAAW,CAAC,IAAI,CAAC,CAAC;SAC5B;QACD,OAAO,aAAa,CAAC,IAAI,CAAC,CAAC;IAC/B,CAAC,CAAC;IACF,WAAW,CAAC,SAAS,CAAC,KAAK,GAAG;QAC1B,IAAI,CAAC,SAAS,CAAC,YAAY,EAAE;YACzB,OAAO,EAAE,CAAC,CAAC,WAAW,CAAC,CAAC;SAC3B,CAAC,CAAC;IACP,CAAC,CAAC;IAEF,WAAW,CAAC,SAAS,CAAC,MAAM,GAAG;QAC3B,IAAI,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC;QAC3B,IAAI,WAAW,GAAG,OAAO,CAAC,WAAW,CAAC,IAAI,CAAC;QAC3C,IAAI,aAAa,GAAG,OAAO,CAAC,aAAa,IAAI,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC;QAC/D,IAAI,KAAK,GAAG;YACR;gBACI,IAAI,EAAE,MAAM;gBACZ,KAAK,EAAE,MAAM;gBACb,MAAM,EAAE;oBACJ,MAAM,EAAE,QAAQ;oBAChB,KAAK,EAAE;wBACH,IAAI,EAAE,aAAa,CAAC,CAAC,CAAC;qBACzB;iBACJ;aACJ;YACD;gBACI,IAAI,EAAE,KAAK;gBACX,KAAK,EAAE,KAAK;gBACZ,MAAM,EAAE;oBACJ,MAAM,EAAE,MAAM;oBACd,KAAK,EAAE;wBACH,MAAM,EAAE,WAAW;wBACnB,SAAS,EAAE,CAAC;qBACf;iBACJ;aACJ;SACJ,CAAC;QACF,IAAI,aAAa,GAAG,QAAQ,CAAC,EAAE,MAAM,EAAE,IAAI,EAAE,QAAQ,EAAE,QAAQ,EAAE,KAAK,EAAE,KAAK,EAAE,EAAE,OAAO,CAAC,MAAM,CAAC,CAAC;QAEjG,IAAI,CAAC,SAAS,CAAC,SAAS,EAAE,aAAa,CAAC,CAAC;IAC7C,CAAC,CAAC;IACF,WAAW,CAAC,SAAS,CAAC,WAAW,GAAG;QAChC,IAAI,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC;QAC3B,IAAI,MAAM,GAAG,OAAO,CAAC,UAAU,EAAE,MAAM,EAAE;YACrC,cAAc,EAAE,CAAC,OAAO,CAAC,MAAM,EAAE,OAAO,CAAC,MAAM,CAAC;YAChD,IAAI,EAAE,IAAI;SACb,CAAC,CAAC;QACH,MAAM,CAAC,MAAM,GAAG;YACZ;gBACI,IAAI,EAAE,OAAO;aAChB;SACJ,CAAC;QACF,IAAI,OAAO,CAAC,KAAK,EAAE;YACf,MAAM,CAAC,KAAK,GAAG,IAAI,CAAC,YAAY,EAAE,CAAC;SACtC;QACD,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;QACrB,IAAI,CAAC,SAAS,CAAC,UAAU,EAAE,MAAM,CAAC,CAAC;IACvC,CAAC,CAAC;IACF,WAAW,CAAC,SAAS,CAAC,WAAW,GAAG;QAChC,MAAM,CAAC,SAAS,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,EAAE,WAAW,CAAC,CAAC;IACzD,CAAC,CAAC;IACF,WAAW,CAAC,SAAS,CAAC,YAAY,GAAG;QACjC,IAAI,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC;QAC3B,IAAI,KAAK,GAAG,OAAO,CAAC,EAAE,EAAE,OAAO,CAAC,KAAK,CAAC,CAAC;QACvC,IAAI,KAAK,CAAC,OAAO,KAAK,KAAK,EAAE;YACzB,OAAO,KAAK,CAAC;SAChB;QACD,IAAI,WAAW,GAAG,YAAY,CAAC,OAAO,EAAE,QAAQ,CAAC,EAAE,IAAI,EAAE,IAAI,EAAE,SAAS,EAAE,UAAU,EAAE,MAAM,EAAE,CAAC,OAAO,CAAC,MAAM,CAAC,EAAE,EAAE,KAAK,CAAC,CAAC,CAAC;QAC1H,OAAO,WAAW,CAAC;IACvB,CAAC,CAAC;IACF,WAAW,CAAC,SAAS,CAAC,aAAa,GAAG,UAAU,OAAO;QACnD,OAAO,CAAC,OAAO,GAAG,OAAO,CAAC,WAAW,IAAI,EAAE,CAAC;QAC5C,IAAI,CAAC,kBAAkB,CAAC,OAAO,CAAC,CAAC;IACrC,CAAC,CAAC;IACF,WAAW,CAAC,SAAS,CAAC,kBAAkB,GAAG,UAAU,OAAO;QACxD,IAAI,MAAM,GAAG,EAAE,CAAC;QAChB,OAAO,CAAC,IAAI,CAAC,OAAO,CAAC,UAAU,CAAC,IAAI,OAAO,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC,QAAQ,CAAC,MAAM,CAAC,UAAU,CAAC,EAAE,CAAC,IAAI,OAAO,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QACpH,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC;QAC9B,OAAO,CAAC,KAAK,CAAC,GAAG,GAAG,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,EAAE,EAAE,MAAM,CAAC,CAAC;IACnD,CAAC,CAAC;IACF,WAAW,CAAC,SAAS,CAAC,WAAW,GAAG,UAAU,WAAW;QACrD,IAAI,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC;QAC3B,IAAI,IAAI,GAAG,EAAE,CAAC;QACd,WAAW,CAAC,OAAO,CAAC,UAAU,QAAQ,EAAE,OAAO;YAC3C,IAAI,EAAE,CAAC;YACP,KAAK,IAAI,QAAQ,GAAG,CAAC,EAAE,QAAQ,GAAG,QAAQ,CAAC,QAAQ,CAAC,MAAM,EAAE,QAAQ,IAAI,CAAC,EAAE;gBACvE,IAAI,KAAK,GAAG,QAAQ,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC;gBACxC,IAAI,MAAM,GAAG,QAAQ,CAAC,KAAK,IAAI,EAAE,GAAG,OAAO,CAAC;gBAC5C,IAAI,CAAC,IAAI,CAAC,CAAC,EAAE,GAAG,EAAE;oBACd,EAAE,CAAC,OAAO,CAAC,MAAM,CAAC,GAAG,MAAM;oBAC3B,EAAE,CAAC,OAAO,CAAC,MAAM,CAAC,GAAG,KAAK;oBAC1B,EAAE,CAAC,OAAO,CAAC,UAAU,CAAC,GAAG,EAAE,GAAG,QAAQ;oBACtC,EAAE,CAAC,CAAC,CAAC;aACZ;QACL,CAAC,CAAC,CAAC;QACH,OAAO,IAAI,CAAC;IAChB,CAAC,CAAC;IACF,OAAO,WAAW,CAAC;AACvB,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC;AACd,eAAe,WAAW,CAAC;AAC3B,gBAAgB,CAAC,QAAQ,EAAE,WAAW,CAAC,CAAC","sourcesContent":["import { __assign, __extends } from \"tslib\";\nimport { deepMix, has } from '@antv/util';\nimport * as EventParser from './event';\nimport ViewLayer from '../../base/view-layer';\nimport { extractScale } from '../../util/scale';\nimport { getComponent } from '../../components/factory';\nimport { getGeom } from '../../geoms/factory';\nimport { registerPlotType } from '../../base/global';\nimport BulletRect from './component/bulletRect';\nimport BulletTarget from './component/bulletTarget';\nimport './theme';\nvar G2_GEOM_MAP = {\n    bullet: 'interval',\n};\nvar PLOT_GEOM_MAP = {\n    interval: 'bullet',\n};\nexport var STACK_FIELD = '$$stackField$$';\nexport var X_FIELD = '$$xField$$';\nexport var Y_FIELD = '$$yField$$';\nvar BulletLayer = /** @class */ (function (_super) {\n    __extends(BulletLayer, _super);\n    function BulletLayer() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.type = 'bullet';\n        return _this;\n    }\n    BulletLayer.getDefaultOptions = function () {\n        return deepMix({}, _super.getDefaultOptions.call(this), {\n            data: [],\n            stackField: STACK_FIELD,\n            xField: X_FIELD,\n            yField: Y_FIELD,\n            rangeColors: ['rgba(91, 143, 249, 0.45)'],\n            measureSize: 12,\n            rangeSize: 2,\n            markerSize: 2,\n            markerColors: [],\n            markerStyle: {\n                width: 2,\n                fill: '#5B8FF9',\n                lineWidth: 0,\n            },\n            axis: {\n                visible: false,\n                position: 'before',\n                tickCount: 6,\n                formatter: function (text, idx) { return \"\" + idx; },\n                style: {\n                    fill: 'rgba(0, 0, 0, 0.25)',\n                    textBaseline: 'middle',\n                    textAlign: 'center',\n                    fontSize: 12,\n                    lineHeight: 16,\n                },\n                tickLine: {\n                    visible: true,\n                    lineWidth: 1,\n                    stroke: '#FFF',\n                    lineDash: [4, 2],\n                },\n            },\n            xAxis: {\n                visible: true,\n                line: {\n                    visible: false,\n                },\n                tickLine: {\n                    visible: false,\n                },\n                label: {\n                    visible: true,\n                },\n            },\n            yAxis: {\n                visible: false,\n                nice: false,\n            },\n            tooltip: {\n                visible: false,\n                trigger: 'item',\n                crosshairs: false,\n            },\n            label: {\n                visible: true,\n                offset: 4,\n                style: {\n                    fill: 'rgba(0, 0, 0, 0.45)',\n                    stroke: '#fff',\n                    lineWidth: 1,\n                },\n            },\n        });\n    };\n    BulletLayer.prototype.afterRender = function () {\n        _super.prototype.afterRender.call(this);\n        this.view.removeInteraction('legend-filter');\n    };\n    BulletLayer.prototype.scale = function () {\n        var options = this.options;\n        var scales = {};\n        /** 配置y-scale */\n        scales[options.yField] = {};\n        if (has(options, 'yAxis')) {\n            extractScale(scales[options.yField], options.yAxis);\n        }\n        /** 配置x-scale */\n        scales[options.xField] = {\n            type: 'cat',\n        };\n        if (has(options, 'xAxis')) {\n            extractScale(scales[options.xField], options.xAxis);\n        }\n        this.setConfig('scales', scales);\n        _super.prototype.scale.call(this);\n    };\n    BulletLayer.prototype.getOptions = function (props) {\n        var options = _super.prototype.getOptions.call(this, props);\n        this.adjustOptions(options);\n        return options;\n    };\n    BulletLayer.prototype.afterInit = function () {\n        _super.prototype.afterInit.call(this);\n        var options = this.options;\n        var ranges = options.data.map(function (d) { return d.ranges; });\n        var targets = options.data.map(function (d) { return d.targets; });\n        this.bulletRect = new BulletRect(this.view, {\n            ranges: ranges,\n            rangeMax: options.rangeMax,\n            yField: options.yField,\n            rangeSize: options.rangeSize,\n            rangeColors: options.rangeColors || [],\n            axis: options.axis,\n        });\n        this.bulletTarget = new BulletTarget(this.view, {\n            targets: targets,\n            yField: options.yField,\n            markerSize: options.markerSize,\n            markerColors: options.markerColors || [],\n            markerStyle: options.markerStyle,\n        });\n    };\n    BulletLayer.prototype.geometryParser = function (dim, type) {\n        if (dim === 'g2') {\n            return G2_GEOM_MAP[type];\n        }\n        return PLOT_GEOM_MAP[type];\n    };\n    BulletLayer.prototype.coord = function () {\n        this.setConfig('coordinate', {\n            actions: [['transpose']],\n        });\n    };\n    /** 自定义子弹图图例 */\n    BulletLayer.prototype.legend = function () {\n        var options = this.options;\n        var markerColor = options.markerStyle.fill;\n        var measureColors = options.measureColors || this.theme.colors;\n        var items = [\n            {\n                name: '实际进度',\n                value: '实际进度',\n                marker: {\n                    symbol: 'square',\n                    style: {\n                        fill: measureColors[0],\n                    },\n                },\n            },\n            {\n                name: '目标值',\n                value: '目标值',\n                marker: {\n                    symbol: 'line',\n                    style: {\n                        stroke: markerColor,\n                        lineWidth: 2,\n                    },\n                },\n            },\n        ];\n        var legendOptions = __assign({ custom: true, position: 'bottom', items: items }, options.legend);\n        // @ts-ignore\n        this.setConfig('legends', legendOptions);\n    };\n    BulletLayer.prototype.addGeometry = function () {\n        var options = this.options;\n        var bullet = getGeom('interval', 'main', {\n            positionFields: [options.xField, options.yField],\n            plot: this,\n        });\n        bullet.adjust = [\n            {\n                type: 'stack',\n            },\n        ];\n        if (options.label) {\n            bullet.label = this.extractLabel();\n        }\n        this.bullet = bullet;\n        this.setConfig('geometry', bullet);\n    };\n    BulletLayer.prototype.parseEvents = function () {\n        _super.prototype.parseEvents.call(this, EventParser);\n    };\n    BulletLayer.prototype.extractLabel = function () {\n        var options = this.options;\n        var label = deepMix({}, options.label);\n        if (label.visible === false) {\n            return false;\n        }\n        var labelConfig = getComponent('label', __assign({ plot: this, labelType: 'barLabel', fields: [options.yField] }, label));\n        return labelConfig;\n    };\n    BulletLayer.prototype.adjustOptions = function (options) {\n        options.barSize = options.measureSize || 12;\n        this.adjustYAxisOptions(options);\n    };\n    BulletLayer.prototype.adjustYAxisOptions = function (options) {\n        var values = [];\n        options.data.forEach(function (d) { return values.push(d.measures.reduce(function (a, b) { return a + b; }, 0)); });\n        values.push(options.rangeMax);\n        options.yAxis.max = Math.max.apply([], values);\n    };\n    BulletLayer.prototype.processData = function (dataOptions) {\n        var options = this.options;\n        var data = [];\n        dataOptions.forEach(function (dataItem, dataIdx) {\n            var _a;\n            for (var valueIdx = 0; valueIdx < dataItem.measures.length; valueIdx += 1) {\n                var value = dataItem.measures[valueIdx];\n                var xField = dataItem.title || \"\" + dataIdx;\n                data.push((_a = {},\n                    _a[options.xField] = xField,\n                    _a[options.yField] = value,\n                    _a[options.stackField] = \"\" + valueIdx,\n                    _a));\n            }\n        });\n        return data;\n    };\n    return BulletLayer;\n}(ViewLayer));\nexport default BulletLayer;\nregisterPlotType('bullet', BulletLayer);\n//# sourceMappingURL=layer.js.map"]}]}