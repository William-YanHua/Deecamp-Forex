{"remainingRequest":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\ts-loader\\index.js??ref--4-1!D:\\project\\Deecamp-project\\system\\Web\\node_modules\\@antv\\g2plot\\esm\\base\\layer.js","dependencies":[{"path":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\@antv\\g2plot\\esm\\base\\layer.js","mtime":499162500000},{"path":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1595520254649},{"path":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\ts-loader\\index.js","mtime":1537906253000}],"contextDependencies":[],"result":["import { __extends } from \"tslib\";\r\nimport EventEmitter from '@antv/event-emitter';\r\nimport { deepMix, each, findIndex, keys, contains, isFunction } from '@antv/util';\r\nimport { LAYER_EVENT_MAP } from '../util/event';\r\nimport BBox from '../util/bbox';\r\nvar Layer = (function (_super) {\r\n    __extends(Layer, _super);\r\n    function Layer(props) {\r\n        var _this = _super.call(this) || this;\r\n        _this.layers = [];\r\n        _this.destroyed = false;\r\n        _this.visibility = true;\r\n        _this.rendered = false;\r\n        _this.eventHandlers = [];\r\n        _this.options = _this.getOptions(props);\r\n        _this.processOptions(_this.options);\r\n        return _this;\r\n    }\r\n    Layer.prototype.processOptions = function (options) {\r\n        this.id = options.id;\r\n        this.x = options.x || 0;\r\n        this.y = options.y || 0;\r\n        this.width = options.width;\r\n        this.height = options.height;\r\n        this.canvas = options.canvas;\r\n        this.parent = options.parent;\r\n    };\r\n    Layer.prototype.updateConfig = function (cfg) {\r\n        this.options = deepMix({}, this.options, cfg);\r\n        this.processOptions(this.options);\r\n    };\r\n    Layer.prototype.beforeInit = function () {\r\n        return null;\r\n    };\r\n    Layer.prototype.init = function () {\r\n        this.layerBBox = this.getLayerBBox();\r\n        this.layerRegion = this.getLayerRegion();\r\n        this.eachLayer(function (layer) {\r\n            layer.init();\r\n        });\r\n    };\r\n    Layer.prototype.afterInit = function () {\r\n        return null;\r\n    };\r\n    Layer.prototype.render = function () {\r\n        if (!this.rendered) {\r\n            this.container = this.parent ? this.parent.container.addGroup() : this.canvas.addGroup();\r\n        }\r\n        this.rendered = true;\r\n        this.beforeInit();\r\n        this.init();\r\n        this.afterInit();\r\n        this.eachLayer(function (layer) {\r\n            layer.render();\r\n        });\r\n        this.canvas.draw();\r\n    };\r\n    Layer.prototype.clear = function () {\r\n        this.eachLayer(function (layer) {\r\n            layer.destroy();\r\n        });\r\n        this.layers = [];\r\n        this.container.clear();\r\n    };\r\n    Layer.prototype.destroy = function () {\r\n        var _this = this;\r\n        this.eachLayer(function (layer) {\r\n            layer.destroy();\r\n        });\r\n        each(this.eventHandlers, function (h) {\r\n            _this.off(h.eventName, h.handler);\r\n        });\r\n        this.container.remove(true);\r\n        this.destroyed = true;\r\n    };\r\n    Layer.prototype.show = function () {\r\n        this.container.attr('visible', true);\r\n        this.container.set('visible', true);\r\n        this.visibility = true;\r\n        this.canvas.draw();\r\n    };\r\n    Layer.prototype.hide = function () {\r\n        this.container.attr('visible', false);\r\n        this.container.set('visible', false);\r\n        this.visibility = false;\r\n        this.canvas.draw();\r\n    };\r\n    Layer.prototype.addLayer = function (layer) {\r\n        var idx = findIndex(this.layers, function (item) { return item === layer; });\r\n        if (idx < 0) {\r\n            if (layer.parent !== this) {\r\n                layer.parent = this;\r\n                layer.init();\r\n            }\r\n            this.layers.push(layer);\r\n        }\r\n    };\r\n    Layer.prototype.removeLayer = function (layer) {\r\n        var idx = findIndex(this.layers, function (item) { return item === layer; });\r\n        if (idx >= 0) {\r\n            this.layers.splice(idx, 1);\r\n        }\r\n    };\r\n    Layer.prototype.updateBBox = function (props, recursive) {\r\n        if (recursive === void 0) {\r\n            recursive = false;\r\n        }\r\n        var originRange = {\r\n            x: this.x,\r\n            y: this.y,\r\n            width: this.width,\r\n            height: this.height,\r\n        };\r\n        var newRange = deepMix({}, originRange, props);\r\n        this.x = newRange.x;\r\n        this.y = newRange.y;\r\n        this.width = newRange.width;\r\n        this.height = newRange.height;\r\n        this.layerBBox = this.getLayerBBox();\r\n        this.layerRegion = this.getLayerRegion();\r\n        this.render();\r\n        if (recursive) {\r\n            this.eachLayer(function (layer) {\r\n                layer.updateBBoxByParent();\r\n                layer.render();\r\n            });\r\n        }\r\n        this.canvas.draw();\r\n    };\r\n    Layer.prototype.updateBBoxByParent = function () {\r\n        var region = this.layerRegion;\r\n        this.x = this.parent.x + this.parent.width * region.start.x;\r\n        this.y = this.parent.y + this.parent.height * region.start.y;\r\n        this.width = this.parent.width * (region.end.x - region.start.x);\r\n        this.height = this.parent.height * (region.end.y - region.start.y);\r\n        this.layerBBox = this.getLayerBBox();\r\n    };\r\n    Layer.prototype.getGlobalPosition = function () {\r\n        var globalX = this.x;\r\n        var globalY = this.y;\r\n        var parent = this.parent;\r\n        while (parent) {\r\n            globalX += parent.x;\r\n            globalY += parent.y;\r\n            parent = parent.parent;\r\n        }\r\n        return { x: globalX, y: globalY };\r\n    };\r\n    Layer.prototype.getGlobalBBox = function () {\r\n        var globalPosition = this.getGlobalPosition();\r\n        return new BBox(globalPosition.x, globalPosition.y, this.width, this.height);\r\n    };\r\n    Layer.prototype.getOptions = function (props) {\r\n        var parentWidth = 0;\r\n        var parentHeight = 0;\r\n        if (props.parent) {\r\n            parentWidth = props.parent.width;\r\n            parentHeight = props.parent.height;\r\n        }\r\n        var defaultOptions = {\r\n            x: 0,\r\n            y: 0,\r\n            width: parentWidth,\r\n            height: parentHeight,\r\n        };\r\n        return deepMix({}, defaultOptions, props);\r\n    };\r\n    Layer.prototype.eachLayer = function (cb) {\r\n        each(this.layers, cb);\r\n    };\r\n    Layer.prototype.parseEvents = function (eventParser) {\r\n        var _this = this;\r\n        var eventsName = keys(LAYER_EVENT_MAP);\r\n        each(eventParser, function (e, k) {\r\n            if (contains(eventsName, k) && isFunction(e)) {\r\n                var eventName = LAYER_EVENT_MAP[k] || k;\r\n                var handler = e;\r\n                _this.on(eventName, handler);\r\n                _this.eventHandlers.push({ name: eventName, handler: handler });\r\n            }\r\n        });\r\n    };\r\n    Layer.prototype.getLayerBBox = function () {\r\n        return new BBox(this.x, this.y, this.width, this.height);\r\n    };\r\n    Layer.prototype.getLayerRegion = function () {\r\n        if (this.parent) {\r\n            var parentWidth = this.parent.width;\r\n            var parentHeight = this.parent.height;\r\n            var parentX = this.parent.x;\r\n            var parentY = this.parent.y;\r\n            var startX = (this.x - parentX) / parentWidth;\r\n            var startY = (this.y - parentY) / parentHeight;\r\n            var endX = (this.x + this.width - parentX) / parentWidth;\r\n            var endY = (this.y + this.height - parentY) / parentHeight;\r\n            return { start: { x: startX, y: startY }, end: { x: endX, y: endY } };\r\n        }\r\n        return { start: { x: 0, y: 0 }, end: { x: 1, y: 1 } };\r\n    };\r\n    return Layer;\r\n}(EventEmitter));\r\nexport default Layer;\r\n",{"version":3,"file":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\@antv\\g2plot\\esm\\base\\layer.js","sourceRoot":"","sources":["D:\\project\\Deecamp-project\\system\\Web\\node_modules\\@antv\\g2plot\\esm\\base\\layer.js"],"names":[],"mappings":"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","sourcesContent":["import { __extends } from \"tslib\";\nimport EventEmitter from '@antv/event-emitter';\nimport { deepMix, each, findIndex, keys, contains, isFunction } from '@antv/util';\nimport { LAYER_EVENT_MAP } from '../util/event';\nimport BBox from '../util/bbox';\nvar Layer = /** @class */ (function (_super) {\n    __extends(Layer, _super);\n    /**\n     * layer base for g2plot\n     */\n    function Layer(props) {\n        var _this = _super.call(this) || this;\n        _this.layers = [];\n        _this.destroyed = false;\n        _this.visibility = true;\n        _this.rendered = false;\n        _this.eventHandlers = [];\n        _this.options = _this.getOptions(props);\n        _this.processOptions(_this.options);\n        return _this;\n    }\n    Layer.prototype.processOptions = function (options) {\n        this.id = options.id;\n        this.x = options.x || 0;\n        this.y = options.y || 0;\n        this.width = options.width;\n        this.height = options.height;\n        this.canvas = options.canvas;\n        this.parent = options.parent;\n    };\n    Layer.prototype.updateConfig = function (cfg) {\n        this.options = deepMix({}, this.options, cfg);\n        this.processOptions(this.options);\n    };\n    Layer.prototype.beforeInit = function () {\n        return null;\n    };\n    /**\n     * init life cycle\n     */\n    Layer.prototype.init = function () {\n        this.layerBBox = this.getLayerBBox();\n        this.layerRegion = this.getLayerRegion();\n        this.eachLayer(function (layer) {\n            layer.init();\n        });\n    };\n    Layer.prototype.afterInit = function () {\n        return null;\n    };\n    /**\n     * render layer recursively\n     */\n    Layer.prototype.render = function () {\n        // fixme: 等plot不再继承layer，这个就可以挪到构造函数里去，不需要再加是否render过的判断了\n        if (!this.rendered) {\n            this.container = this.parent ? this.parent.container.addGroup() : this.canvas.addGroup();\n        }\n        this.rendered = true;\n        this.beforeInit();\n        this.init();\n        this.afterInit();\n        //(this.container, [['t', this.x, this.y]]);\n        this.eachLayer(function (layer) {\n            layer.render();\n        });\n        this.canvas.draw();\n    };\n    /**\n     * clear layer content\n     */\n    Layer.prototype.clear = function () {\n        this.eachLayer(function (layer) {\n            layer.destroy();\n        });\n        this.layers = [];\n        this.container.clear();\n    };\n    /**\n     * destroy layer recursively, remove the container of layer\n     */\n    Layer.prototype.destroy = function () {\n        var _this = this;\n        this.eachLayer(function (layer) {\n            layer.destroy();\n        });\n        each(this.eventHandlers, function (h) {\n            _this.off(h.eventName, h.handler);\n        });\n        this.container.remove(true);\n        this.destroyed = true;\n    };\n    /**\n     * display layer\n     */\n    Layer.prototype.show = function () {\n        this.container.attr('visible', true);\n        this.container.set('visible', true);\n        this.visibility = true;\n        this.canvas.draw();\n    };\n    /**\n     * hide layer\n     */\n    Layer.prototype.hide = function () {\n        this.container.attr('visible', false);\n        this.container.set('visible', false);\n        this.visibility = false;\n        this.canvas.draw();\n    };\n    /**\n     * add children layer\n     * @param layer\n     */\n    Layer.prototype.addLayer = function (layer) {\n        var idx = findIndex(this.layers, function (item) { return item === layer; });\n        if (idx < 0) {\n            if (layer.parent !== this) {\n                layer.parent = this;\n                layer.init();\n            }\n            this.layers.push(layer);\n        }\n    };\n    /**\n     * remove children layer\n     * @param layer\n     */\n    Layer.prototype.removeLayer = function (layer) {\n        var idx = findIndex(this.layers, function (item) { return item === layer; });\n        if (idx >= 0) {\n            this.layers.splice(idx, 1);\n        }\n    };\n    /**\n     * update layer's display range\n     * @param props\n     * @param recursive whether update children layers or not\n     */\n    Layer.prototype.updateBBox = function (props, recursive) {\n        if (recursive === void 0) { recursive = false; }\n        var originRange = {\n            x: this.x,\n            y: this.y,\n            width: this.width,\n            height: this.height,\n        };\n        var newRange = deepMix({}, originRange, props);\n        this.x = newRange.x;\n        this.y = newRange.y;\n        this.width = newRange.width;\n        this.height = newRange.height;\n        this.layerBBox = this.getLayerBBox();\n        this.layerRegion = this.getLayerRegion();\n        this.render();\n        if (recursive) {\n            this.eachLayer(function (layer) {\n                layer.updateBBoxByParent();\n                layer.render();\n            });\n        }\n        this.canvas.draw();\n    };\n    /**\n     * update display range according to parent layer's range\n     */\n    Layer.prototype.updateBBoxByParent = function () {\n        var region = this.layerRegion;\n        this.x = this.parent.x + this.parent.width * region.start.x;\n        this.y = this.parent.y + this.parent.height * region.start.y;\n        this.width = this.parent.width * (region.end.x - region.start.x);\n        this.height = this.parent.height * (region.end.y - region.start.y);\n        this.layerBBox = this.getLayerBBox();\n    };\n    /**\n     * get global position of layer\n     */\n    Layer.prototype.getGlobalPosition = function () {\n        var globalX = this.x;\n        var globalY = this.y;\n        var parent = this.parent;\n        while (parent) {\n            globalX += parent.x;\n            globalY += parent.y;\n            parent = parent.parent;\n        }\n        return { x: globalX, y: globalY };\n    };\n    Layer.prototype.getGlobalBBox = function () {\n        var globalPosition = this.getGlobalPosition();\n        return new BBox(globalPosition.x, globalPosition.y, this.width, this.height);\n    };\n    Layer.prototype.getOptions = function (props) {\n        var parentWidth = 0;\n        var parentHeight = 0;\n        if (props.parent) {\n            parentWidth = props.parent.width;\n            parentHeight = props.parent.height;\n        }\n        var defaultOptions = {\n            x: 0,\n            y: 0,\n            width: parentWidth,\n            height: parentHeight,\n        };\n        return deepMix({}, defaultOptions, props);\n    };\n    Layer.prototype.eachLayer = function (cb) {\n        each(this.layers, cb);\n    };\n    Layer.prototype.parseEvents = function (eventParser) {\n        var _this = this;\n        var eventsName = keys(LAYER_EVENT_MAP);\n        each(eventParser, function (e, k) {\n            if (contains(eventsName, k) && isFunction(e)) {\n                var eventName = LAYER_EVENT_MAP[k] || k;\n                var handler = e;\n                _this.on(eventName, handler);\n                _this.eventHandlers.push({ name: eventName, handler: handler });\n            }\n        });\n    };\n    Layer.prototype.getLayerBBox = function () {\n        return new BBox(this.x, this.y, this.width, this.height);\n    };\n    Layer.prototype.getLayerRegion = function () {\n        if (this.parent) {\n            var parentWidth = this.parent.width;\n            var parentHeight = this.parent.height;\n            var parentX = this.parent.x;\n            var parentY = this.parent.y;\n            var startX = (this.x - parentX) / parentWidth;\n            var startY = (this.y - parentY) / parentHeight;\n            var endX = (this.x + this.width - parentX) / parentWidth;\n            var endY = (this.y + this.height - parentY) / parentHeight;\n            return { start: { x: startX, y: startY }, end: { x: endX, y: endY } };\n        }\n        return { start: { x: 0, y: 0 }, end: { x: 1, y: 1 } };\n    };\n    return Layer;\n}(EventEmitter));\nexport default Layer;\n//# sourceMappingURL=layer.js.map"]}]}