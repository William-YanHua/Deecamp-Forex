{"remainingRequest":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\ts-loader\\index.js??ref--4-1!D:\\project\\Deecamp-project\\system\\Web\\node_modules\\@antv\\g2\\lib\\geom\\mixin\\select.js","dependencies":[{"path":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\@antv\\g2\\lib\\geom\\mixin\\select.js","mtime":499162500000},{"path":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1595520254649},{"path":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\ts-loader\\index.js","mtime":1537906253000}],"contextDependencies":[],"result":["var Util = require('../../util');\r\nvar FIELD_ORIGIN = '_origin';\r\nfunction isSameShape(shape1, shape2) {\r\n    if (Util.isNil(shape1) || Util.isNil(shape2)) {\r\n        return false;\r\n    }\r\n    var shape1Origin = shape1.get('origin');\r\n    var shape2Origin = shape2.get('origin');\r\n    return Util.isEqual(shape1Origin, shape2Origin);\r\n}\r\nfunction getOriginAttrs(selectedCfg, shape) {\r\n    var originAttrs = {};\r\n    Util.each(selectedCfg, function (v, k) {\r\n        if (k === 'transform') {\r\n            k = 'matrix';\r\n        }\r\n        var originValue = shape.attr(k);\r\n        if (Util.isArray(originValue)) {\r\n            originValue = Util.cloneDeep(originValue);\r\n        }\r\n        originAttrs[k] = originValue;\r\n    });\r\n    return originAttrs;\r\n}\r\nvar SelectMixin = {\r\n    _isAllowSelect: function _isAllowSelect() {\r\n        var isAllowSelect = this.get('allowSelect');\r\n        if (Util.isNil(isAllowSelect)) {\r\n            var type = this.get('type');\r\n            var coord = this.get('coord');\r\n            var coordType = coord && coord.type;\r\n            if (type === 'interval' && coordType === 'theta') {\r\n                return true;\r\n            }\r\n        }\r\n        else {\r\n            return isAllowSelect;\r\n        }\r\n        return false;\r\n    },\r\n    _onClick: function _onClick(ev) {\r\n        var self = this;\r\n        if (self._isAllowSelect()) {\r\n            self.clearActivedShapes();\r\n            var shape = ev.shape;\r\n            var shapeContainer = self.get('shapeContainer');\r\n            if (shape && !shape.get('animating') && shapeContainer.contain(shape)) {\r\n                self.setShapeSelected(shape);\r\n            }\r\n        }\r\n    },\r\n    _bindSelectedAction: function _bindSelectedAction() {\r\n        var self = this;\r\n        var view = self.get('view');\r\n        var type = self.get('type');\r\n        view.on(type + ':click', Util.wrapBehavior(self, '_onClick'));\r\n    },\r\n    _offSelectedAction: function _offSelectedAction() {\r\n        var self = this;\r\n        var view = self.get('view');\r\n        var type = self.get('type');\r\n        view.off(type + ':click', Util.getWrapBehavior(self, '_onClick'));\r\n    },\r\n    _setShapeStatus: function _setShapeStatus(shape, status) {\r\n        var self = this;\r\n        var view = self.get('view');\r\n        var selectedOptions = self.get('selectedOptions') || {};\r\n        var animate = selectedOptions.animate !== false;\r\n        var canvas = view.get('canvas');\r\n        shape.set('selected', status);\r\n        var shapeData = shape.get('origin');\r\n        if (status) {\r\n            var shapeName = shapeData.shape || self.getDefaultValue('shape');\r\n            if (Util.isArray(shapeName)) {\r\n                shapeName = shapeName[0];\r\n            }\r\n            var shapeFactory = self.get('shapeFactory');\r\n            var cfg = Util.mix({\r\n                geom: self,\r\n                point: shapeData\r\n            }, selectedOptions);\r\n            var selectedStyle = shapeFactory.getSelectedCfg(shapeName, cfg);\r\n            Util.mix(selectedStyle, cfg.style);\r\n            if (!shape.get('_originAttrs')) {\r\n                if (shape.get('animating')) {\r\n                    shape.stopAnimate();\r\n                }\r\n                shape.set('_originAttrs', getOriginAttrs(selectedStyle, shape));\r\n            }\r\n            if (animate) {\r\n                shape.animate(selectedStyle, 300);\r\n            }\r\n            else {\r\n                shape.attr(selectedStyle);\r\n                canvas.draw();\r\n            }\r\n        }\r\n        else {\r\n            var originAttrs = shape.get('_originAttrs');\r\n            shape.set('_originAttrs', null);\r\n            if (animate) {\r\n                shape.animate(originAttrs, 300);\r\n            }\r\n            else {\r\n                shape.attr(originAttrs);\r\n                canvas.draw();\r\n            }\r\n        }\r\n    },\r\n    setShapeSelected: function setShapeSelected(shape) {\r\n        var self = this;\r\n        var selectedShapes = self._getSelectedShapes();\r\n        var selectedOptions = self.get('selectedOptions') || {};\r\n        var cancelable = selectedOptions.cancelable !== false;\r\n        if (selectedOptions.mode === 'multiple') {\r\n            if (Util.indexOf(selectedShapes, shape) === -1) {\r\n                selectedShapes.push(shape);\r\n                self._setShapeStatus(shape, true);\r\n            }\r\n            else if (cancelable) {\r\n                Util.Array.remove(selectedShapes, shape);\r\n                self._setShapeStatus(shape, false);\r\n            }\r\n        }\r\n        else {\r\n            var selectedShape = selectedShapes[0];\r\n            if (cancelable) {\r\n                shape = isSameShape(selectedShape, shape) ? null : shape;\r\n            }\r\n            if (!isSameShape(selectedShape, shape)) {\r\n                if (selectedShape) {\r\n                    self._setShapeStatus(selectedShape, false);\r\n                }\r\n                if (shape) {\r\n                    self._setShapeStatus(shape, true);\r\n                }\r\n            }\r\n        }\r\n    },\r\n    clearSelected: function clearSelected() {\r\n        var self = this;\r\n        var shapeContainer = self.get('shapeContainer');\r\n        if (shapeContainer && !shapeContainer.get('destroyed')) {\r\n            var selectedShapes = self._getSelectedShapes();\r\n            Util.each(selectedShapes, function (shape) {\r\n                self._setShapeStatus(shape, false);\r\n                shape.set('_originAttrs', null);\r\n            });\r\n        }\r\n    },\r\n    setSelected: function setSelected(record) {\r\n        var self = this;\r\n        var shapes = self.getShapes();\r\n        Util.each(shapes, function (shape) {\r\n            var origin = shape.get('origin');\r\n            if (origin && origin[FIELD_ORIGIN] === record) {\r\n                self.setShapeSelected(shape);\r\n            }\r\n        });\r\n        return this;\r\n    },\r\n    _getSelectedShapes: function _getSelectedShapes() {\r\n        var self = this;\r\n        var shapes = self.getShapes();\r\n        var selectedShapes = [];\r\n        Util.each(shapes, function (shape) {\r\n            if (shape.get('selected')) {\r\n                selectedShapes.push(shape);\r\n            }\r\n        });\r\n        self.set('selectedShapes', selectedShapes);\r\n        return selectedShapes;\r\n    }\r\n};\r\nmodule.exports = SelectMixin;\r\n",{"version":3,"file":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\@antv\\g2\\lib\\geom\\mixin\\select.js","sourceRoot":"","sources":["D:\\project\\Deecamp-project\\system\\Web\\node_modules\\@antv\\g2\\lib\\geom\\mixin\\select.js"],"names":[],"mappings":"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","sourcesContent":["/**\n * @fileOverview the interaction when geom was selected\n * @author sima.zhang\n */\nvar Util = require('../../util');\n\nvar FIELD_ORIGIN = '_origin';\n\nfunction isSameShape(shape1, shape2) {\n  if (Util.isNil(shape1) || Util.isNil(shape2)) {\n    return false;\n  }\n\n  var shape1Origin = shape1.get('origin');\n  var shape2Origin = shape2.get('origin');\n  return Util.isEqual(shape1Origin, shape2Origin);\n}\n\nfunction getOriginAttrs(selectedCfg, shape) {\n  var originAttrs = {};\n  Util.each(selectedCfg, function (v, k) {\n    if (k === 'transform') {\n      k = 'matrix';\n    }\n\n    var originValue = shape.attr(k);\n\n    if (Util.isArray(originValue)) {\n      originValue = Util.cloneDeep(originValue); // 缓存原来的属性，由于 .attr('matrix') 是数组，所以此处需要深度复制\n    }\n\n    originAttrs[k] = originValue;\n  });\n  return originAttrs;\n}\n\nvar SelectMixin = {\n  _isAllowSelect: function _isAllowSelect() {\n    var isAllowSelect = this.get('allowSelect');\n\n    if (Util.isNil(isAllowSelect)) {\n      var type = this.get('type');\n      var coord = this.get('coord');\n      var coordType = coord && coord.type;\n\n      if (type === 'interval' && coordType === 'theta') {\n        // 饼图默认可以进行选中\n        return true;\n      }\n    } else {\n      // 用户设置了 select 配置\n      return isAllowSelect;\n    }\n\n    return false;\n  },\n  _onClick: function _onClick(ev) {\n    var self = this;\n\n    if (self._isAllowSelect()) {\n      // 允许选中下才执行\n      self.clearActivedShapes(); // 清除hover效果\n\n      var shape = ev.shape;\n      var shapeContainer = self.get('shapeContainer');\n\n      if (shape && !shape.get('animating') && shapeContainer.contain(shape)) {\n        self.setShapeSelected(shape);\n      }\n    }\n  },\n  _bindSelectedAction: function _bindSelectedAction() {\n    var self = this;\n    var view = self.get('view');\n    var type = self.get('type');\n    view.on(type + ':click', Util.wrapBehavior(self, '_onClick'));\n  },\n  _offSelectedAction: function _offSelectedAction() {\n    var self = this;\n    var view = self.get('view');\n    var type = self.get('type');\n    view.off(type + ':click', Util.getWrapBehavior(self, '_onClick'));\n  },\n  _setShapeStatus: function _setShapeStatus(shape, status) {\n    var self = this;\n    var view = self.get('view');\n    var selectedOptions = self.get('selectedOptions') || {};\n    var animate = selectedOptions.animate !== false; // 默认允许动画\n\n    var canvas = view.get('canvas');\n    shape.set('selected', status);\n    var shapeData = shape.get('origin');\n\n    if (status) {\n      // 选中状态\n      var shapeName = shapeData.shape || self.getDefaultValue('shape');\n\n      if (Util.isArray(shapeName)) {\n        shapeName = shapeName[0];\n      }\n\n      var shapeFactory = self.get('shapeFactory');\n      var cfg = Util.mix({\n        geom: self,\n        point: shapeData\n      }, selectedOptions);\n      var selectedStyle = shapeFactory.getSelectedCfg(shapeName, cfg);\n      Util.mix(selectedStyle, cfg.style); // 用户设置的优先级更高\n\n      if (!shape.get('_originAttrs')) {\n        // 缓存原有属性\n        if (shape.get('animating')) {\n          // 停止动画\n          shape.stopAnimate();\n        }\n\n        shape.set('_originAttrs', getOriginAttrs(selectedStyle, shape));\n      }\n\n      if (animate) {\n        shape.animate(selectedStyle, 300);\n      } else {\n        shape.attr(selectedStyle);\n        canvas.draw();\n      }\n    } else {\n      var originAttrs = shape.get('_originAttrs');\n      shape.set('_originAttrs', null);\n\n      if (animate) {\n        shape.animate(originAttrs, 300);\n      } else {\n        shape.attr(originAttrs);\n        canvas.draw();\n      }\n    }\n  },\n  setShapeSelected: function setShapeSelected(shape) {\n    var self = this;\n\n    var selectedShapes = self._getSelectedShapes();\n\n    var selectedOptions = self.get('selectedOptions') || {};\n    var cancelable = selectedOptions.cancelable !== false; // 选中状态是否允许取消，默认允许\n\n    if (selectedOptions.mode === 'multiple') {\n      // 支持多选\n      if (Util.indexOf(selectedShapes, shape) === -1) {\n        selectedShapes.push(shape);\n\n        self._setShapeStatus(shape, true);\n      } else if (cancelable) {\n        // 图形已经被选中并且选中状态允许取消选中\n        Util.Array.remove(selectedShapes, shape);\n\n        self._setShapeStatus(shape, false);\n      }\n    } else {\n      var selectedShape = selectedShapes[0];\n\n      if (cancelable) {\n        // 如果允许取消，则选中null\n        shape = isSameShape(selectedShape, shape) ? null : shape;\n      }\n\n      if (!isSameShape(selectedShape, shape)) {\n        if (selectedShape) {\n          self._setShapeStatus(selectedShape, false);\n        }\n\n        if (shape) {\n          self._setShapeStatus(shape, true);\n        }\n      }\n    }\n  },\n  clearSelected: function clearSelected() {\n    var self = this;\n    var shapeContainer = self.get('shapeContainer');\n\n    if (shapeContainer && !shapeContainer.get('destroyed')) {\n      var selectedShapes = self._getSelectedShapes();\n\n      Util.each(selectedShapes, function (shape) {\n        self._setShapeStatus(shape, false);\n\n        shape.set('_originAttrs', null);\n      });\n    }\n  },\n\n  /**\n   * 设置记录对应的图形选中\n   * @param {Object} record 选中的记录\n   * @chainable\n   * @return {Geom} 返回当前的 Geometry\n   */\n  setSelected: function setSelected(record) {\n    var self = this;\n    var shapes = self.getShapes();\n    Util.each(shapes, function (shape) {\n      var origin = shape.get('origin');\n\n      if (origin && origin[FIELD_ORIGIN] === record) {\n        self.setShapeSelected(shape);\n      }\n    });\n    return this;\n  },\n  _getSelectedShapes: function _getSelectedShapes() {\n    var self = this;\n    var shapes = self.getShapes();\n    var selectedShapes = [];\n    Util.each(shapes, function (shape) {\n      if (shape.get('selected')) {\n        selectedShapes.push(shape);\n      }\n    });\n    self.set('selectedShapes', selectedShapes);\n    return selectedShapes;\n  }\n};\nmodule.exports = SelectMixin;"]}]}