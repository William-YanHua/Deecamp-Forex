{"remainingRequest":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\ts-loader\\index.js??ref--4-1!D:\\project\\Deecamp-project\\system\\Web\\node_modules\\@antv\\g2plot\\esm\\interaction\\slider.js","dependencies":[{"path":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\@antv\\g2plot\\esm\\interaction\\slider.js","mtime":499162500000},{"path":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1595520254649},{"path":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\ts-loader\\index.js","mtime":1537906253000}],"contextDependencies":[],"result":["import { __assign, __extends } from \"tslib\";\r\nimport { Slider, VIEW_LIFE_CIRCLE } from '../dependents';\r\nimport BBox from '../util/bbox';\r\nimport { clamp, head, last, map, size, throttle, isEmpty, isEqual } from '@antv/util';\r\nimport BaseInteraction from './base';\r\nimport { getDataByScaleRange } from './helper/data-range';\r\nvar DEFAULT_PADDING = 4;\r\nvar DEFAULT_SIZE = 16;\r\nvar getValidSliderConfig = function (cfg) {\r\n    if (cfg === void 0) {\r\n        cfg = {};\r\n    }\r\n    var _cfg = __assign({ type: 'horizontal', start: 0, end: 1, width: undefined, height: undefined, padding: [0, 0, 0, 0], backgroundStyle: {}, foregroundStyle: {}, handlerStyle: {}, textStyle: {}, trendCfg: {} }, cfg);\r\n    if (!cfg.padding) {\r\n        _cfg.padding =\r\n            _cfg.type === 'horizontal' ? [DEFAULT_PADDING, 0, DEFAULT_PADDING, 0] : [0, DEFAULT_PADDING, 0, DEFAULT_PADDING];\r\n    }\r\n    if (!cfg.height) {\r\n        _cfg.height = DEFAULT_SIZE;\r\n    }\r\n    if (!cfg.width) {\r\n        _cfg.width = DEFAULT_SIZE;\r\n    }\r\n    var start = clamp(Math.min(_cfg.start, _cfg.end), 0, 1);\r\n    var end = clamp(Math.max(_cfg.start, _cfg.end), 0, 1);\r\n    _cfg.start = start;\r\n    _cfg.end = end;\r\n    return _cfg;\r\n};\r\nvar SliderInteraction = (function (_super) {\r\n    __extends(SliderInteraction, _super);\r\n    function SliderInteraction() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.onChangeFn = throttle(_this.onChange.bind(_this), 20, { leading: true });\r\n        return _this;\r\n    }\r\n    SliderInteraction.getInteractionRange = function (layerRange, interaction) {\r\n        var config = getValidSliderConfig(interaction);\r\n        var _a = config.padding || [0, 0, 0, 0], paddingTop = _a[0], paddingRight = _a[1], paddingBottom = _a[2], paddingLeft = _a[3];\r\n        if (config.type === 'horizontal') {\r\n            var bbox = new BBox(layerRange.minX, layerRange.maxY - config.height - paddingTop - paddingBottom, layerRange.width, config.height + paddingTop + paddingBottom);\r\n            return bbox;\r\n        }\r\n        else {\r\n            return new BBox(layerRange.maxX - config.width - paddingLeft - paddingRight, layerRange.minY, config.width + paddingLeft + paddingRight, layerRange.height);\r\n        }\r\n    };\r\n    SliderInteraction.prototype.render = function () {\r\n        var _this = this;\r\n        var layer = this.getViewLayer();\r\n        var view = this.view;\r\n        var config = getValidSliderConfig(this.getInteractionConfig());\r\n        this.curStart = config.start;\r\n        this.curEnd = config.end;\r\n        this.xScaleCfg = undefined;\r\n        var callback = function () {\r\n            var padding = _this.view.padding;\r\n            if (padding === 'auto' || isEqual(padding, [0, 0, 0, 1])) {\r\n                return;\r\n            }\r\n            if (isEmpty(layer.options.data)) {\r\n                return;\r\n            }\r\n            if (!_this.xScaleCfg) {\r\n                var xScale = view.getXScale();\r\n                _this.xScaleCfg = {\r\n                    field: xScale.field,\r\n                    values: xScale.values || [],\r\n                };\r\n                view.data(_this.getSliderData(_this.curStart, _this.curEnd));\r\n                view.render();\r\n            }\r\n            else {\r\n                _this.renderSlider();\r\n            }\r\n        };\r\n        view.on(VIEW_LIFE_CIRCLE.AFTER_PAINT, callback);\r\n        this.addDisposable(function () { return view.off(VIEW_LIFE_CIRCLE.AFTER_PAINT, callback); });\r\n        view.on(VIEW_LIFE_CIRCLE.AFTER_RENDER, callback);\r\n        this.addDisposable(function () { return view.off(VIEW_LIFE_CIRCLE.AFTER_RENDER, callback); });\r\n    };\r\n    SliderInteraction.prototype.start = function () {\r\n        return;\r\n    };\r\n    SliderInteraction.prototype.clear = function () {\r\n        if (this.slider) {\r\n            this.slider.destroy();\r\n            this.slider = null;\r\n        }\r\n        if (this.container) {\r\n            this.container.remove(true);\r\n            this.container = null;\r\n        }\r\n    };\r\n    SliderInteraction.prototype.renderSlider = function () {\r\n        if (!this.slider) {\r\n            this.container = this.canvas.addGroup();\r\n            this.slider = new Slider(__assign(__assign({}, this.getSliderConfig()), { container: this.container }));\r\n            this.slider.init();\r\n            this.slider.render();\r\n            this.slider.on('sliderchange', this.onChangeFn);\r\n        }\r\n        else {\r\n            this.slider.update(this.getSliderConfig());\r\n            this.slider.render();\r\n        }\r\n    };\r\n    SliderInteraction.prototype.getSliderConfig = function () {\r\n        var view = this.view;\r\n        var panelRange = view.coordinateBBox;\r\n        var range = this.getRange();\r\n        var config = getValidSliderConfig(this.getInteractionConfig());\r\n        var _a = config || {}, _b = _a.padding, padding = _b === void 0 ? [0, 0, 0, 0] : _b, backgroundStyle = _a.backgroundStyle, foregroundStyle = _a.foregroundStyle, handlerStyle = _a.handlerStyle, textStyle = _a.textStyle, _c = _a.trendCfg, trendCfg = _c === void 0 ? {} : _c;\r\n        var paddingTop = padding[0], paddingRight = padding[1], paddingBottom = padding[2], paddingLeft = padding[3];\r\n        var _d = this.getSliderMinMaxText(this.curStart, this.curEnd), minText = _d.minText, maxText = _d.maxText;\r\n        var cfg = {\r\n            x: panelRange.minX + paddingLeft,\r\n            y: range.minY + paddingTop,\r\n            width: panelRange.width - paddingLeft - paddingRight,\r\n            height: range.height - paddingTop - paddingBottom,\r\n            start: this.curStart,\r\n            end: this.curEnd,\r\n            minText: minText,\r\n            maxText: maxText,\r\n            backgroundStyle: backgroundStyle,\r\n            foregroundStyle: foregroundStyle,\r\n            handlerStyle: handlerStyle,\r\n            textStyle: textStyle,\r\n            trendCfg: __assign(__assign({ isArea: false, smooth: false }, trendCfg), { data: this.getSliderTrendData() }),\r\n        };\r\n        return cfg;\r\n    };\r\n    SliderInteraction.prototype.getSliderTrendData = function () {\r\n        var _a = this.getViewLayer().options, data = _a.data, yField = _a.yField;\r\n        return map(data, function (item) { return item[yField]; });\r\n    };\r\n    SliderInteraction.prototype.getSliderData = function (start, end) {\r\n        var origData = this.getViewLayer().getData();\r\n        var length = size(this.xScaleCfg.values);\r\n        var startIdx = Math.round(start * length);\r\n        var endIdx = Math.max(startIdx + 1, Math.round(end * length));\r\n        return getDataByScaleRange(this.xScaleCfg.field, this.xScaleCfg.values, origData, [startIdx, endIdx]);\r\n    };\r\n    SliderInteraction.prototype.getSliderMinMaxText = function (start, end) {\r\n        var _a = this.getViewLayer().options, _b = _a.data, data = _b === void 0 ? [] : _b, xField = _a.xField;\r\n        var length = size(data);\r\n        var startIdx = Math.round(start * length);\r\n        var endIdx = Math.max(startIdx + 1, Math.round(end * length));\r\n        var newData = data.slice(startIdx, endIdx);\r\n        return {\r\n            minText: newData.length > 0 ? head(newData)[xField] : '',\r\n            maxText: newData.length > 0 ? last(newData)[xField] : '',\r\n        };\r\n    };\r\n    SliderInteraction.prototype.onChange = function (range) {\r\n        var view = this.view;\r\n        var start = clamp(Math.min(range[0], range[1]), 0, 1);\r\n        var end = clamp(Math.max(range[0], range[1]), 0, 1);\r\n        var data = this.getSliderData(start, end);\r\n        var _a = this.getSliderMinMaxText(start, end), minText = _a.minText, maxText = _a.maxText;\r\n        this.curStart = start;\r\n        this.curEnd = end;\r\n        this.slider.update({\r\n            start: start,\r\n            end: end,\r\n            minText: minText,\r\n            maxText: maxText,\r\n        });\r\n        this.slider.render();\r\n        var origAnimate = view.getOptions().animate;\r\n        view.animate(false);\r\n        view.changeData(data);\r\n        view.animate(origAnimate);\r\n    };\r\n    return SliderInteraction;\r\n}(BaseInteraction));\r\nexport default SliderInteraction;\r\n",{"version":3,"file":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\@antv\\g2plot\\esm\\interaction\\slider.js","sourceRoot":"","sources":["D:\\project\\Deecamp-project\\system\\Web\\node_modules\\@antv\\g2plot\\esm\\interaction\\slider.js"],"names":[],"mappings":"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","sourcesContent":["import { __assign, __extends } from \"tslib\";\nimport { Slider, VIEW_LIFE_CIRCLE } from '../dependents';\nimport BBox from '../util/bbox';\nimport { clamp, head, last, map, size, throttle, isEmpty, isEqual } from '@antv/util';\nimport BaseInteraction from './base';\nimport { getDataByScaleRange } from './helper/data-range';\nvar DEFAULT_PADDING = 4;\nvar DEFAULT_SIZE = 16;\nvar getValidSliderConfig = function (cfg) {\n    if (cfg === void 0) { cfg = {}; }\n    var _cfg = __assign({ type: 'horizontal', start: 0, end: 1, width: undefined, height: undefined, padding: [0, 0, 0, 0], backgroundStyle: {}, foregroundStyle: {}, handlerStyle: {}, textStyle: {}, trendCfg: {} }, cfg);\n    // default padding\n    if (!cfg.padding) {\n        _cfg.padding =\n            _cfg.type === 'horizontal' ? [DEFAULT_PADDING, 0, DEFAULT_PADDING, 0] : [0, DEFAULT_PADDING, 0, DEFAULT_PADDING];\n    }\n    // default size\n    if (!cfg.height) {\n        _cfg.height = DEFAULT_SIZE;\n    }\n    if (!cfg.width) {\n        _cfg.width = DEFAULT_SIZE;\n    }\n    // start & end\n    var start = clamp(Math.min(_cfg.start, _cfg.end), 0, 1);\n    var end = clamp(Math.max(_cfg.start, _cfg.end), 0, 1);\n    _cfg.start = start;\n    _cfg.end = end;\n    return _cfg;\n};\nvar SliderInteraction = /** @class */ (function (_super) {\n    __extends(SliderInteraction, _super);\n    function SliderInteraction() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.onChangeFn = throttle(_this.onChange.bind(_this), 20, { leading: true });\n        return _this;\n    }\n    SliderInteraction.getInteractionRange = function (layerRange, interaction) {\n        var config = getValidSliderConfig(interaction);\n        var _a = config.padding || [0, 0, 0, 0], paddingTop = _a[0], paddingRight = _a[1], paddingBottom = _a[2], paddingLeft = _a[3];\n        if (config.type === 'horizontal') {\n            var bbox = new BBox(layerRange.minX, layerRange.maxY - config.height - paddingTop - paddingBottom, layerRange.width, config.height + paddingTop + paddingBottom);\n            return bbox;\n        }\n        else {\n            return new BBox(layerRange.maxX - config.width - paddingLeft - paddingRight, layerRange.minY, config.width + paddingLeft + paddingRight, layerRange.height);\n        }\n    };\n    SliderInteraction.prototype.render = function () {\n        var _this = this;\n        var layer = this.getViewLayer();\n        var view = this.view;\n        // 设置初始化的 start/end\n        var config = getValidSliderConfig(this.getInteractionConfig());\n        this.curStart = config.start;\n        this.curEnd = config.end;\n        this.xScaleCfg = undefined;\n        // 等待 view 每次 render 完成后更新 slider 组件\n        var callback = function () {\n            var padding = _this.view.padding;\n            if (padding === 'auto' || isEqual(padding, [0, 0, 0, 1])) {\n                return;\n            }\n            if (isEmpty(layer.options.data)) {\n                return;\n            }\n            if (!_this.xScaleCfg) {\n                // 初始化配置和数据\n                var xScale = view.getXScale();\n                _this.xScaleCfg = {\n                    field: xScale.field,\n                    values: xScale.values || [],\n                };\n                // 初始化 data\n                view.data(_this.getSliderData(_this.curStart, _this.curEnd));\n                view.render();\n            }\n            else {\n                _this.renderSlider();\n            }\n        };\n        view.on(VIEW_LIFE_CIRCLE.AFTER_PAINT, callback);\n        this.addDisposable(function () { return view.off(VIEW_LIFE_CIRCLE.AFTER_PAINT, callback); });\n        view.on(VIEW_LIFE_CIRCLE.AFTER_RENDER, callback);\n        this.addDisposable(function () { return view.off(VIEW_LIFE_CIRCLE.AFTER_RENDER, callback); });\n    };\n    SliderInteraction.prototype.start = function () {\n        return;\n    };\n    SliderInteraction.prototype.clear = function () {\n        if (this.slider) {\n            this.slider.destroy();\n            this.slider = null;\n        }\n        if (this.container) {\n            this.container.remove(true);\n            this.container = null;\n        }\n    };\n    SliderInteraction.prototype.renderSlider = function () {\n        if (!this.slider) {\n            this.container = this.canvas.addGroup();\n            this.slider = new Slider(__assign(__assign({}, this.getSliderConfig()), { container: this.container }));\n            this.slider.init();\n            this.slider.render();\n            this.slider.on('sliderchange', this.onChangeFn);\n        }\n        else {\n            this.slider.update(this.getSliderConfig());\n            this.slider.render();\n        }\n    };\n    SliderInteraction.prototype.getSliderConfig = function () {\n        var view = this.view;\n        var panelRange = view.coordinateBBox;\n        var range = this.getRange();\n        var config = getValidSliderConfig(this.getInteractionConfig());\n        var _a = config || {}, _b = _a.padding, padding = _b === void 0 ? [0, 0, 0, 0] : _b, backgroundStyle = _a.backgroundStyle, foregroundStyle = _a.foregroundStyle, handlerStyle = _a.handlerStyle, textStyle = _a.textStyle, _c = _a.trendCfg, trendCfg = _c === void 0 ? {} : _c;\n        var paddingTop = padding[0], paddingRight = padding[1], paddingBottom = padding[2], paddingLeft = padding[3];\n        var _d = this.getSliderMinMaxText(this.curStart, this.curEnd), minText = _d.minText, maxText = _d.maxText;\n        var cfg = {\n            x: panelRange.minX + paddingLeft,\n            y: range.minY + paddingTop,\n            width: panelRange.width - paddingLeft - paddingRight,\n            height: range.height - paddingTop - paddingBottom,\n            start: this.curStart,\n            end: this.curEnd,\n            minText: minText,\n            maxText: maxText,\n            backgroundStyle: backgroundStyle,\n            foregroundStyle: foregroundStyle,\n            handlerStyle: handlerStyle,\n            textStyle: textStyle,\n            trendCfg: __assign(__assign({ isArea: false, smooth: false }, trendCfg), { data: this.getSliderTrendData() }),\n        };\n        return cfg;\n    };\n    SliderInteraction.prototype.getSliderTrendData = function () {\n        var _a = this.getViewLayer().options, data = _a.data, yField = _a.yField;\n        return map(data, function (item) { return item[yField]; });\n    };\n    SliderInteraction.prototype.getSliderData = function (start, end) {\n        var origData = this.getViewLayer().getData();\n        var length = size(this.xScaleCfg.values);\n        var startIdx = Math.round(start * length);\n        var endIdx = Math.max(startIdx + 1, Math.round(end * length));\n        return getDataByScaleRange(this.xScaleCfg.field, this.xScaleCfg.values, origData, [startIdx, endIdx]);\n    };\n    SliderInteraction.prototype.getSliderMinMaxText = function (start, end) {\n        var _a = this.getViewLayer().options, _b = _a.data, data = _b === void 0 ? [] : _b, xField = _a.xField;\n        var length = size(data);\n        var startIdx = Math.round(start * length);\n        var endIdx = Math.max(startIdx + 1, Math.round(end * length));\n        var newData = data.slice(startIdx, endIdx);\n        return {\n            minText: newData.length > 0 ? head(newData)[xField] : '',\n            maxText: newData.length > 0 ? last(newData)[xField] : '',\n        };\n    };\n    SliderInteraction.prototype.onChange = function (range) {\n        var view = this.view;\n        var start = clamp(Math.min(range[0], range[1]), 0, 1);\n        var end = clamp(Math.max(range[0], range[1]), 0, 1);\n        var data = this.getSliderData(start, end);\n        var _a = this.getSliderMinMaxText(start, end), minText = _a.minText, maxText = _a.maxText;\n        this.curStart = start;\n        this.curEnd = end;\n        this.slider.update({\n            start: start,\n            end: end,\n            minText: minText,\n            maxText: maxText,\n        });\n        this.slider.render();\n        var origAnimate = view.getOptions().animate;\n        view.animate(false);\n        view.changeData(data);\n        view.animate(origAnimate);\n    };\n    return SliderInteraction;\n}(BaseInteraction));\nexport default SliderInteraction;\n//# sourceMappingURL=slider.js.map"]}]}