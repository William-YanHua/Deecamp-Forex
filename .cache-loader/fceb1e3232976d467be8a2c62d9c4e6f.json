{"remainingRequest":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\ts-loader\\index.js??ref--4-1!D:\\project\\Deecamp-project\\system\\Web\\node_modules\\@antv\\g-base\\esm\\abstract\\element.js","dependencies":[{"path":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\@antv\\g-base\\esm\\abstract\\element.js","mtime":499162500000},{"path":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1595520254649},{"path":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\ts-loader\\index.js","mtime":1537906253000}],"contextDependencies":[],"result":["import { __extends } from \"tslib\";\r\nimport { each, isEqual, isFunction, isNumber, isObject, isArray, noop, mix, upperFirst, uniqueId } from '@antv/util';\r\nimport { ext } from '@antv/matrix-util';\r\nimport { removeFromArray, isParent } from '../util/util';\r\nimport { multiplyMatrix, multiplyVec2, invert } from '../util/matrix';\r\nimport Base from './base';\r\nvar MATRIX = 'matrix';\r\nvar CLONE_CFGS = ['zIndex', 'capture', 'visible', 'type'];\r\nvar RESERVED_PORPS = ['repeat'];\r\nvar DELEGATION_SPLIT = ':';\r\nvar WILDCARD = '*';\r\nfunction _cloneArrayAttr(arr) {\r\n    var result = [];\r\n    for (var i = 0; i < arr.length; i++) {\r\n        if (isArray(arr[i])) {\r\n            result.push([].concat(arr[i]));\r\n        }\r\n        else {\r\n            result.push(arr[i]);\r\n        }\r\n    }\r\n    return result;\r\n}\r\nfunction getFormatFromAttrs(toAttrs, shape) {\r\n    var fromAttrs = {};\r\n    var attrs = shape.attrs;\r\n    for (var k in toAttrs) {\r\n        fromAttrs[k] = attrs[k];\r\n    }\r\n    return fromAttrs;\r\n}\r\nfunction getFormatToAttrs(props, shape) {\r\n    var toAttrs = {};\r\n    var attrs = shape.attr();\r\n    each(props, function (v, k) {\r\n        if (RESERVED_PORPS.indexOf(k) === -1 && !isEqual(attrs[k], v)) {\r\n            toAttrs[k] = v;\r\n        }\r\n    });\r\n    return toAttrs;\r\n}\r\nfunction checkExistedAttrs(animations, animation) {\r\n    if (animation.onFrame) {\r\n        return animations;\r\n    }\r\n    var startTime = animation.startTime, delay = animation.delay, duration = animation.duration;\r\n    var hasOwnProperty = Object.prototype.hasOwnProperty;\r\n    each(animations, function (item) {\r\n        if (startTime + delay < item.startTime + item.delay + item.duration && duration > item.delay) {\r\n            each(animation.toAttrs, function (v, k) {\r\n                if (hasOwnProperty.call(item.toAttrs, k)) {\r\n                    delete item.toAttrs[k];\r\n                    delete item.fromAttrs[k];\r\n                }\r\n            });\r\n        }\r\n    });\r\n    return animations;\r\n}\r\nvar Element = (function (_super) {\r\n    __extends(Element, _super);\r\n    function Element(cfg) {\r\n        var _this = _super.call(this, cfg) || this;\r\n        _this.attrs = {};\r\n        var attrs = _this.getDefaultAttrs();\r\n        mix(attrs, cfg.attrs);\r\n        _this.attrs = attrs;\r\n        _this.initAttrs(attrs);\r\n        _this.initAnimate();\r\n        return _this;\r\n    }\r\n    Element.prototype.getDefaultCfg = function () {\r\n        return {\r\n            visible: true,\r\n            capture: true,\r\n            zIndex: 0,\r\n        };\r\n    };\r\n    Element.prototype.getDefaultAttrs = function () {\r\n        return {\r\n            matrix: this.getDefaultMatrix(),\r\n            opacity: 1,\r\n        };\r\n    };\r\n    Element.prototype.onCanvasChange = function (changeType) { };\r\n    Element.prototype.initAttrs = function (attrs) { };\r\n    Element.prototype.initAnimate = function () {\r\n        this.set('animable', true);\r\n        this.set('animating', false);\r\n    };\r\n    Element.prototype.isGroup = function () {\r\n        return false;\r\n    };\r\n    Element.prototype.getParent = function () {\r\n        return this.get('parent');\r\n    };\r\n    Element.prototype.getCanvas = function () {\r\n        return this.get('canvas');\r\n    };\r\n    Element.prototype.attr = function () {\r\n        var _a;\r\n        var args = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            args[_i] = arguments[_i];\r\n        }\r\n        var name = args[0], value = args[1];\r\n        if (!name)\r\n            return this.attrs;\r\n        if (isObject(name)) {\r\n            for (var k in name) {\r\n                this.setAttr(k, name[k]);\r\n            }\r\n            this.afterAttrsChange(name);\r\n            return this;\r\n        }\r\n        if (args.length === 2) {\r\n            this.setAttr(name, value);\r\n            this.afterAttrsChange((_a = {},\r\n                _a[name] = value,\r\n                _a));\r\n            return this;\r\n        }\r\n        return this.attrs[name];\r\n    };\r\n    Element.prototype.isClipped = function (refX, refY) {\r\n        var clip = this.getClip();\r\n        return clip && !clip.isHit(refX, refY);\r\n    };\r\n    Element.prototype.setAttr = function (name, value) {\r\n        var originValue = this.attrs[name];\r\n        if (originValue !== value) {\r\n            this.attrs[name] = value;\r\n            this.onAttrChange(name, value, originValue);\r\n        }\r\n    };\r\n    Element.prototype.onAttrChange = function (name, value, originValue) {\r\n        if (name === 'matrix') {\r\n            this.set('totalMatrix', null);\r\n        }\r\n    };\r\n    Element.prototype.afterAttrsChange = function (targetAttrs) {\r\n        this.onCanvasChange('attr');\r\n    };\r\n    Element.prototype.show = function () {\r\n        this.set('visible', true);\r\n        this.onCanvasChange('show');\r\n        return this;\r\n    };\r\n    Element.prototype.hide = function () {\r\n        this.set('visible', false);\r\n        this.onCanvasChange('hide');\r\n        return this;\r\n    };\r\n    Element.prototype.setZIndex = function (zIndex) {\r\n        this.set('zIndex', zIndex);\r\n        var parent = this.getParent();\r\n        if (parent) {\r\n            parent.sort();\r\n        }\r\n        return this;\r\n    };\r\n    Element.prototype.toFront = function () {\r\n        var parent = this.getParent();\r\n        if (!parent) {\r\n            return;\r\n        }\r\n        var children = parent.getChildren();\r\n        var el = this.get('el');\r\n        var index = children.indexOf(this);\r\n        children.splice(index, 1);\r\n        children.push(this);\r\n        this.onCanvasChange('zIndex');\r\n    };\r\n    Element.prototype.toBack = function () {\r\n        var parent = this.getParent();\r\n        if (!parent) {\r\n            return;\r\n        }\r\n        var children = parent.getChildren();\r\n        var el = this.get('el');\r\n        var index = children.indexOf(this);\r\n        children.splice(index, 1);\r\n        children.unshift(this);\r\n        this.onCanvasChange('zIndex');\r\n    };\r\n    Element.prototype.remove = function (destroy) {\r\n        if (destroy === void 0) {\r\n            destroy = true;\r\n        }\r\n        var parent = this.getParent();\r\n        if (parent) {\r\n            removeFromArray(parent.getChildren(), this);\r\n            if (!parent.get('clearing')) {\r\n                this.onCanvasChange('remove');\r\n            }\r\n        }\r\n        else {\r\n            this.onCanvasChange('remove');\r\n        }\r\n        if (destroy) {\r\n            this.destroy();\r\n        }\r\n    };\r\n    Element.prototype.resetMatrix = function () {\r\n        this.attr(MATRIX, this.getDefaultMatrix());\r\n        this.onCanvasChange('matrix');\r\n    };\r\n    Element.prototype.getMatrix = function () {\r\n        return this.attr(MATRIX);\r\n    };\r\n    Element.prototype.setMatrix = function (m) {\r\n        this.attr(MATRIX, m);\r\n        this.onCanvasChange('matrix');\r\n    };\r\n    Element.prototype.getTotalMatrix = function () {\r\n        var totalMatrix = this.get('totalMatrix');\r\n        if (!totalMatrix) {\r\n            var currentMatrix = this.attr('matrix');\r\n            var parentMatrix = this.get('parentMatrix');\r\n            if (parentMatrix && currentMatrix) {\r\n                totalMatrix = multiplyMatrix(parentMatrix, currentMatrix);\r\n            }\r\n            else {\r\n                totalMatrix = currentMatrix || parentMatrix;\r\n            }\r\n            this.set('totalMatrix', totalMatrix);\r\n        }\r\n        return totalMatrix;\r\n    };\r\n    Element.prototype.applyMatrix = function (matrix) {\r\n        var currentMatrix = this.attr('matrix');\r\n        var totalMatrix = null;\r\n        if (matrix && currentMatrix) {\r\n            totalMatrix = multiplyMatrix(matrix, currentMatrix);\r\n        }\r\n        else {\r\n            totalMatrix = currentMatrix || matrix;\r\n        }\r\n        this.set('totalMatrix', totalMatrix);\r\n        this.set('parentMatrix', matrix);\r\n    };\r\n    Element.prototype.getDefaultMatrix = function () {\r\n        return null;\r\n    };\r\n    Element.prototype.applyToMatrix = function (v) {\r\n        var matrix = this.attr('matrix');\r\n        if (matrix) {\r\n            return multiplyVec2(matrix, v);\r\n        }\r\n        return v;\r\n    };\r\n    Element.prototype.invertFromMatrix = function (v) {\r\n        var matrix = this.attr('matrix');\r\n        if (matrix) {\r\n            var invertMatrix = invert(matrix);\r\n            if (invertMatrix) {\r\n                return multiplyVec2(invertMatrix, v);\r\n            }\r\n        }\r\n        return v;\r\n    };\r\n    Element.prototype.setClip = function (clipCfg) {\r\n        var canvas = this.getCanvas();\r\n        var clipShape = null;\r\n        if (clipCfg) {\r\n            var ShapeBase = this.getShapeBase();\r\n            var shapeType = upperFirst(clipCfg.type);\r\n            var Cons = ShapeBase[shapeType];\r\n            if (Cons) {\r\n                clipShape = new Cons({\r\n                    type: clipCfg.type,\r\n                    isClipShape: true,\r\n                    attrs: clipCfg.attrs,\r\n                    canvas: canvas,\r\n                });\r\n            }\r\n        }\r\n        this.set('clipShape', clipShape);\r\n        this.onCanvasChange('clip');\r\n        return clipShape;\r\n    };\r\n    Element.prototype.getClip = function () {\r\n        var clipShape = this.cfg.clipShape;\r\n        if (!clipShape) {\r\n            return null;\r\n        }\r\n        return clipShape;\r\n    };\r\n    Element.prototype.clone = function () {\r\n        var _this = this;\r\n        var originAttrs = this.attrs;\r\n        var attrs = {};\r\n        each(originAttrs, function (i, k) {\r\n            if (isArray(originAttrs[k])) {\r\n                attrs[k] = _cloneArrayAttr(originAttrs[k]);\r\n            }\r\n            else {\r\n                attrs[k] = originAttrs[k];\r\n            }\r\n        });\r\n        var cons = this.constructor;\r\n        var clone = new cons({ attrs: attrs });\r\n        each(CLONE_CFGS, function (cfgName) {\r\n            clone.set(cfgName, _this.get(cfgName));\r\n        });\r\n        return clone;\r\n    };\r\n    Element.prototype.destroy = function () {\r\n        var destroyed = this.destroyed;\r\n        if (destroyed) {\r\n            return;\r\n        }\r\n        this.attrs = {};\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    Element.prototype.isAnimatePaused = function () {\r\n        return this.get('_pause').isPaused;\r\n    };\r\n    Element.prototype.animate = function () {\r\n        var args = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            args[_i] = arguments[_i];\r\n        }\r\n        this.set('animating', true);\r\n        var timeline = this.get('timeline');\r\n        if (!timeline) {\r\n            timeline = this.get('canvas').get('timeline');\r\n            this.set('timeline', timeline);\r\n        }\r\n        var animations = this.get('animations') || [];\r\n        if (!timeline.timer) {\r\n            timeline.initTimer();\r\n        }\r\n        var toAttrs = args[0], duration = args[1], _a = args[2], easing = _a === void 0 ? 'easeLinear' : _a, _b = args[3], callback = _b === void 0 ? noop : _b, _c = args[4], delay = _c === void 0 ? 0 : _c;\r\n        var onFrame;\r\n        var repeat;\r\n        var pauseCallback;\r\n        var resumeCallback;\r\n        var animateCfg;\r\n        if (isFunction(toAttrs)) {\r\n            onFrame = toAttrs;\r\n            toAttrs = {};\r\n        }\r\n        else if (isObject(toAttrs) && toAttrs.onFrame) {\r\n            onFrame = toAttrs.onFrame;\r\n            repeat = toAttrs.repeat;\r\n        }\r\n        if (isObject(duration)) {\r\n            animateCfg = duration;\r\n            duration = animateCfg.duration;\r\n            easing = animateCfg.easing || 'easeLinear';\r\n            delay = animateCfg.delay || 0;\r\n            repeat = animateCfg.repeat || repeat || false;\r\n            callback = animateCfg.callback || noop;\r\n            pauseCallback = animateCfg.pauseCallback || noop;\r\n            resumeCallback = animateCfg.resumeCallback || noop;\r\n        }\r\n        else {\r\n            if (isNumber(callback)) {\r\n                delay = callback;\r\n                callback = null;\r\n            }\r\n            if (isFunction(easing)) {\r\n                callback = easing;\r\n                easing = 'easeLinear';\r\n            }\r\n            else {\r\n                easing = easing || 'easeLinear';\r\n            }\r\n        }\r\n        var formatToAttrs = getFormatToAttrs(toAttrs, this);\r\n        var animation = {\r\n            fromAttrs: getFormatFromAttrs(formatToAttrs, this),\r\n            toAttrs: formatToAttrs,\r\n            duration: duration,\r\n            easing: easing,\r\n            repeat: repeat,\r\n            callback: callback,\r\n            pauseCallback: pauseCallback,\r\n            resumeCallback: resumeCallback,\r\n            delay: delay,\r\n            startTime: timeline.getTime(),\r\n            id: uniqueId(),\r\n            onFrame: onFrame,\r\n            pathFormatted: false,\r\n        };\r\n        if (animations.length > 0) {\r\n            animations = checkExistedAttrs(animations, animation);\r\n        }\r\n        else {\r\n            timeline.addAnimator(this);\r\n        }\r\n        animations.push(animation);\r\n        this.set('animations', animations);\r\n        this.set('_pause', { isPaused: false });\r\n    };\r\n    Element.prototype.stopAnimate = function (toEnd) {\r\n        var _this = this;\r\n        if (toEnd === void 0) {\r\n            toEnd = true;\r\n        }\r\n        var animations = this.get('animations');\r\n        each(animations, function (animation) {\r\n            if (toEnd) {\r\n                if (animation.onFrame) {\r\n                    _this.attr(animation.onFrame(1));\r\n                }\r\n                else {\r\n                    _this.attr(animation.toAttrs);\r\n                }\r\n            }\r\n            if (animation.callback) {\r\n                animation.callback();\r\n            }\r\n        });\r\n        this.set('animating', false);\r\n        this.set('animations', []);\r\n    };\r\n    Element.prototype.pauseAnimate = function () {\r\n        var timeline = this.get('timeline');\r\n        var animations = this.get('animations');\r\n        var pauseTime = timeline.getTime();\r\n        each(animations, function (animation) {\r\n            animation._paused = true;\r\n            animation._pauseTime = pauseTime;\r\n            if (animation.pauseCallback) {\r\n                animation.pauseCallback();\r\n            }\r\n        });\r\n        this.set('_pause', {\r\n            isPaused: true,\r\n            pauseTime: pauseTime,\r\n        });\r\n        return this;\r\n    };\r\n    Element.prototype.resumeAnimate = function () {\r\n        var timeline = this.get('timeline');\r\n        var current = timeline.getTime();\r\n        var animations = this.get('animations');\r\n        var pauseTime = this.get('_pause').pauseTime;\r\n        each(animations, function (animation) {\r\n            animation.startTime = animation.startTime + (current - pauseTime);\r\n            animation._paused = false;\r\n            animation._pauseTime = null;\r\n            if (animation.resumeCallback) {\r\n                animation.resumeCallback();\r\n            }\r\n        });\r\n        this.set('_pause', {\r\n            isPaused: false,\r\n        });\r\n        this.set('animations', animations);\r\n        return this;\r\n    };\r\n    Element.prototype.emitDelegation = function (type, eventObj) {\r\n        var _this = this;\r\n        var paths = eventObj.propagationPath;\r\n        var events = this.getEvents();\r\n        var relativeShape;\r\n        if (type === 'mouseenter') {\r\n            relativeShape = eventObj.fromShape;\r\n        }\r\n        else if (type === 'mouseleave') {\r\n            relativeShape = eventObj.toShape;\r\n        }\r\n        var _loop_1 = function (i) {\r\n            var element = paths[i];\r\n            var name_1 = element.get('name');\r\n            if (name_1) {\r\n                if ((element.isGroup() || (element.isCanvas && element.isCanvas())) &&\r\n                    relativeShape &&\r\n                    isParent(element, relativeShape)) {\r\n                    return \"break\";\r\n                }\r\n                if (isArray(name_1)) {\r\n                    each(name_1, function (subName) {\r\n                        _this.emitDelegateEvent(element, subName, eventObj);\r\n                    });\r\n                }\r\n                else {\r\n                    this_1.emitDelegateEvent(element, name_1, eventObj);\r\n                }\r\n            }\r\n        };\r\n        var this_1 = this;\r\n        for (var i = 0; i < paths.length; i++) {\r\n            var state_1 = _loop_1(i);\r\n            if (state_1 === \"break\")\r\n                break;\r\n        }\r\n    };\r\n    Element.prototype.emitDelegateEvent = function (element, name, eventObj) {\r\n        var events = this.getEvents();\r\n        var eventName = name + DELEGATION_SPLIT + eventObj.type;\r\n        if (events[eventName] || events[WILDCARD]) {\r\n            eventObj.name = eventName;\r\n            eventObj.currentTarget = element;\r\n            eventObj.delegateTarget = this;\r\n            eventObj.delegateObject = element.get('delegateObject');\r\n            this.emit(eventName, eventObj);\r\n        }\r\n    };\r\n    Element.prototype.translate = function (translateX, translateY) {\r\n        if (translateX === void 0) {\r\n            translateX = 0;\r\n        }\r\n        if (translateY === void 0) {\r\n            translateY = 0;\r\n        }\r\n        var matrix = this.getMatrix();\r\n        var newMatrix = ext.transform(matrix, [['t', translateX, translateY]]);\r\n        this.setMatrix(newMatrix);\r\n        return this;\r\n    };\r\n    Element.prototype.move = function (targetX, targetY) {\r\n        var x = this.attr('x') || 0;\r\n        var y = this.attr('y') || 0;\r\n        this.translate(targetX - x, targetY - y);\r\n        return this;\r\n    };\r\n    Element.prototype.moveTo = function (targetX, targetY) {\r\n        return this.move(targetX, targetY);\r\n    };\r\n    Element.prototype.scale = function (ratioX, ratioY) {\r\n        var matrix = this.getMatrix();\r\n        var newMatrix = ext.transform(matrix, [['s', ratioX, ratioY || ratioX]]);\r\n        this.setMatrix(newMatrix);\r\n        return this;\r\n    };\r\n    Element.prototype.rotate = function (radian) {\r\n        var matrix = this.getMatrix();\r\n        var newMatrix = ext.transform(matrix, [['r', radian]]);\r\n        this.setMatrix(newMatrix);\r\n        return this;\r\n    };\r\n    Element.prototype.rotateAtStart = function (rotate) {\r\n        var _a = this.attr(), x = _a.x, y = _a.y;\r\n        var matrix = this.getMatrix();\r\n        var newMatrix = ext.transform(matrix, [\r\n            ['t', -x, -y],\r\n            ['r', rotate],\r\n            ['t', x, y],\r\n        ]);\r\n        this.setMatrix(newMatrix);\r\n        return this;\r\n    };\r\n    Element.prototype.rotateAtPoint = function (x, y, rotate) {\r\n        var matrix = this.getMatrix();\r\n        var newMatrix = ext.transform(matrix, [\r\n            ['t', -x, -y],\r\n            ['r', rotate],\r\n            ['t', x, y],\r\n        ]);\r\n        this.setMatrix(newMatrix);\r\n        return this;\r\n    };\r\n    return Element;\r\n}(Base));\r\nexport default Element;\r\n",{"version":3,"file":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\@antv\\g-base\\esm\\abstract\\element.js","sourceRoot":"","sources":["D:\\project\\Deecamp-project\\system\\Web\\node_modules\\@antv\\g-base\\esm\\abstract\\element.js"],"names":[],"mappings":"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","sourcesContent":["import { __extends } from \"tslib\";\nimport { each, isEqual, isFunction, isNumber, isObject, isArray, noop, mix, upperFirst, uniqueId } from '@antv/util';\nimport { ext } from '@antv/matrix-util';\nimport { removeFromArray, isParent } from '../util/util';\nimport { multiplyMatrix, multiplyVec2, invert } from '../util/matrix';\nimport Base from './base';\nvar MATRIX = 'matrix';\nvar CLONE_CFGS = ['zIndex', 'capture', 'visible', 'type'];\n// 可以在 toAttrs 中设置，但不属于绘图属性的字段\nvar RESERVED_PORPS = ['repeat'];\nvar DELEGATION_SPLIT = ':';\nvar WILDCARD = '*';\n// 需要考虑数组嵌套数组的场景\n// 数组嵌套对象的场景不考虑\nfunction _cloneArrayAttr(arr) {\n    var result = [];\n    for (var i = 0; i < arr.length; i++) {\n        if (isArray(arr[i])) {\n            result.push([].concat(arr[i]));\n        }\n        else {\n            result.push(arr[i]);\n        }\n    }\n    return result;\n}\nfunction getFormatFromAttrs(toAttrs, shape) {\n    var fromAttrs = {};\n    var attrs = shape.attrs;\n    for (var k in toAttrs) {\n        fromAttrs[k] = attrs[k];\n    }\n    return fromAttrs;\n}\nfunction getFormatToAttrs(props, shape) {\n    var toAttrs = {};\n    var attrs = shape.attr();\n    each(props, function (v, k) {\n        if (RESERVED_PORPS.indexOf(k) === -1 && !isEqual(attrs[k], v)) {\n            toAttrs[k] = v;\n        }\n    });\n    return toAttrs;\n}\nfunction checkExistedAttrs(animations, animation) {\n    if (animation.onFrame) {\n        return animations;\n    }\n    var startTime = animation.startTime, delay = animation.delay, duration = animation.duration;\n    var hasOwnProperty = Object.prototype.hasOwnProperty;\n    each(animations, function (item) {\n        // 后一个动画开始执行的时间 < 前一个动画的结束时间 && 后一个动画的执行时间 > 前一个动画的延迟\n        if (startTime + delay < item.startTime + item.delay + item.duration && duration > item.delay) {\n            each(animation.toAttrs, function (v, k) {\n                if (hasOwnProperty.call(item.toAttrs, k)) {\n                    delete item.toAttrs[k];\n                    delete item.fromAttrs[k];\n                }\n            });\n        }\n    });\n    return animations;\n}\nvar Element = /** @class */ (function (_super) {\n    __extends(Element, _super);\n    function Element(cfg) {\n        var _this = _super.call(this, cfg) || this;\n        /**\n         * @protected\n         * 图形属性\n         * @type {ShapeAttrs}\n         */\n        _this.attrs = {};\n        var attrs = _this.getDefaultAttrs();\n        mix(attrs, cfg.attrs);\n        _this.attrs = attrs;\n        _this.initAttrs(attrs);\n        _this.initAnimate(); // 初始化动画\n        return _this;\n    }\n    // override\n    Element.prototype.getDefaultCfg = function () {\n        return {\n            visible: true,\n            capture: true,\n            zIndex: 0,\n        };\n    };\n    /**\n     * @protected\n     * 获取默认的属相\n     */\n    Element.prototype.getDefaultAttrs = function () {\n        return {\n            matrix: this.getDefaultMatrix(),\n            opacity: 1,\n        };\n    };\n    /**\n     * @protected\n     * 一些方法调用会引起画布变化\n     * @param {ChangeType} changeType 改变的类型\n     */\n    Element.prototype.onCanvasChange = function (changeType) { };\n    /**\n     * @protected\n     * 初始化属性，有些属性需要加工\n     * @param {object} attrs 属性值\n     */\n    Element.prototype.initAttrs = function (attrs) { };\n    /**\n     * @protected\n     * 初始化动画\n     */\n    Element.prototype.initAnimate = function () {\n        this.set('animable', true);\n        this.set('animating', false);\n    };\n    Element.prototype.isGroup = function () {\n        return false;\n    };\n    Element.prototype.getParent = function () {\n        return this.get('parent');\n    };\n    Element.prototype.getCanvas = function () {\n        return this.get('canvas');\n    };\n    Element.prototype.attr = function () {\n        var _a;\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        var name = args[0], value = args[1];\n        if (!name)\n            return this.attrs;\n        if (isObject(name)) {\n            for (var k in name) {\n                this.setAttr(k, name[k]);\n            }\n            this.afterAttrsChange(name);\n            return this;\n        }\n        if (args.length === 2) {\n            this.setAttr(name, value);\n            this.afterAttrsChange((_a = {},\n                _a[name] = value,\n                _a));\n            return this;\n        }\n        return this.attrs[name];\n    };\n    // 是否被裁剪，被裁剪则不显示，不参与拾取\n    Element.prototype.isClipped = function (refX, refY) {\n        var clip = this.getClip();\n        return clip && !clip.isHit(refX, refY);\n    };\n    /**\n     * 内部设置属性值的接口\n     * @param {string} name 属性名\n     * @param {any} value 属性值\n     */\n    Element.prototype.setAttr = function (name, value) {\n        var originValue = this.attrs[name];\n        if (originValue !== value) {\n            this.attrs[name] = value;\n            this.onAttrChange(name, value, originValue);\n        }\n    };\n    /**\n     * @protected\n     * 属性值发生改变\n     * @param {string} name 属性名\n     * @param {any} value 属性值\n     * @param {any} originValue 属性值\n     */\n    Element.prototype.onAttrChange = function (name, value, originValue) {\n        if (name === 'matrix') {\n            this.set('totalMatrix', null);\n        }\n    };\n    /**\n     * 属性更改后需要做的事情\n     * @protected\n     */\n    Element.prototype.afterAttrsChange = function (targetAttrs) {\n        this.onCanvasChange('attr');\n    };\n    Element.prototype.show = function () {\n        // 不是高频操作直接使用 set\n        this.set('visible', true);\n        this.onCanvasChange('show');\n        return this;\n    };\n    Element.prototype.hide = function () {\n        // 不是高频操作直接使用 set\n        this.set('visible', false);\n        this.onCanvasChange('hide');\n        return this;\n    };\n    Element.prototype.setZIndex = function (zIndex) {\n        this.set('zIndex', zIndex);\n        var parent = this.getParent();\n        if (parent) {\n            // 改变 zIndex 不应该立即触发渲染 (调用 onCanvasChange('zIndex'))，需要经过 sort 再触发\n            parent.sort();\n        }\n        return this;\n    };\n    Element.prototype.toFront = function () {\n        var parent = this.getParent();\n        if (!parent) {\n            return;\n        }\n        var children = parent.getChildren();\n        var el = this.get('el');\n        var index = children.indexOf(this);\n        children.splice(index, 1);\n        children.push(this);\n        this.onCanvasChange('zIndex');\n    };\n    Element.prototype.toBack = function () {\n        var parent = this.getParent();\n        if (!parent) {\n            return;\n        }\n        var children = parent.getChildren();\n        var el = this.get('el');\n        var index = children.indexOf(this);\n        children.splice(index, 1);\n        children.unshift(this);\n        this.onCanvasChange('zIndex');\n    };\n    Element.prototype.remove = function (destroy) {\n        if (destroy === void 0) { destroy = true; }\n        var parent = this.getParent();\n        if (parent) {\n            removeFromArray(parent.getChildren(), this);\n            if (!parent.get('clearing')) {\n                // 如果父元素正在清理，当前元素不触发 remove\n                this.onCanvasChange('remove');\n            }\n        }\n        else {\n            this.onCanvasChange('remove');\n        }\n        if (destroy) {\n            this.destroy();\n        }\n    };\n    Element.prototype.resetMatrix = function () {\n        this.attr(MATRIX, this.getDefaultMatrix());\n        this.onCanvasChange('matrix');\n    };\n    Element.prototype.getMatrix = function () {\n        return this.attr(MATRIX);\n    };\n    Element.prototype.setMatrix = function (m) {\n        this.attr(MATRIX, m);\n        this.onCanvasChange('matrix');\n    };\n    // 获取总的 matrix\n    Element.prototype.getTotalMatrix = function () {\n        var totalMatrix = this.get('totalMatrix');\n        if (!totalMatrix) {\n            var currentMatrix = this.attr('matrix');\n            var parentMatrix = this.get('parentMatrix');\n            if (parentMatrix && currentMatrix) {\n                totalMatrix = multiplyMatrix(parentMatrix, currentMatrix);\n            }\n            else {\n                totalMatrix = currentMatrix || parentMatrix;\n            }\n            this.set('totalMatrix', totalMatrix);\n        }\n        return totalMatrix;\n    };\n    // 上层分组设置 matrix\n    Element.prototype.applyMatrix = function (matrix) {\n        var currentMatrix = this.attr('matrix');\n        var totalMatrix = null;\n        if (matrix && currentMatrix) {\n            totalMatrix = multiplyMatrix(matrix, currentMatrix);\n        }\n        else {\n            totalMatrix = currentMatrix || matrix;\n        }\n        this.set('totalMatrix', totalMatrix);\n        this.set('parentMatrix', matrix);\n    };\n    /**\n     * @protected\n     * 获取默认的矩阵\n     * @returns {number[]|null} 默认的矩阵\n     */\n    Element.prototype.getDefaultMatrix = function () {\n        return null;\n    };\n    // 将向量应用设置的矩阵\n    Element.prototype.applyToMatrix = function (v) {\n        var matrix = this.attr('matrix');\n        if (matrix) {\n            return multiplyVec2(matrix, v);\n        }\n        return v;\n    };\n    // 根据设置的矩阵，将向量转换相对于图形/分组的位置\n    Element.prototype.invertFromMatrix = function (v) {\n        var matrix = this.attr('matrix');\n        if (matrix) {\n            var invertMatrix = invert(matrix);\n            if (invertMatrix) {\n                return multiplyVec2(invertMatrix, v);\n            }\n        }\n        return v;\n    };\n    // 设置 clip\n    Element.prototype.setClip = function (clipCfg) {\n        var canvas = this.getCanvas();\n        // 应该只设置当前元素的 clip，不应该去修改 clip 本身，方便 clip 被复用\n        // TODO: setClip 的传参既 shape 配置，也支持 shape 对象\n        // const preShape = this.get('clipShape');\n        // if (preShape) {\n        //   // 将之前的 clipShape 销毁\n        //   preShape.destroy();\n        // }\n        var clipShape = null;\n        // 如果配置项为 null，则不移除 clipShape\n        if (clipCfg) {\n            var ShapeBase = this.getShapeBase();\n            var shapeType = upperFirst(clipCfg.type);\n            var Cons = ShapeBase[shapeType];\n            if (Cons) {\n                clipShape = new Cons({\n                    type: clipCfg.type,\n                    isClipShape: true,\n                    attrs: clipCfg.attrs,\n                    canvas: canvas,\n                });\n            }\n        }\n        this.set('clipShape', clipShape);\n        this.onCanvasChange('clip');\n        return clipShape;\n    };\n    Element.prototype.getClip = function () {\n        // 高频率调用的地方直接使用 this.cfg.xxx\n        var clipShape = this.cfg.clipShape;\n        // 未设置时返回 Null，保证一致性\n        if (!clipShape) {\n            return null;\n        }\n        return clipShape;\n    };\n    Element.prototype.clone = function () {\n        var _this = this;\n        var originAttrs = this.attrs;\n        var attrs = {};\n        each(originAttrs, function (i, k) {\n            if (isArray(originAttrs[k])) {\n                attrs[k] = _cloneArrayAttr(originAttrs[k]);\n            }\n            else {\n                attrs[k] = originAttrs[k];\n            }\n        });\n        var cons = this.constructor;\n        // @ts-ignore\n        var clone = new cons({ attrs: attrs });\n        each(CLONE_CFGS, function (cfgName) {\n            clone.set(cfgName, _this.get(cfgName));\n        });\n        return clone;\n    };\n    Element.prototype.destroy = function () {\n        var destroyed = this.destroyed;\n        if (destroyed) {\n            return;\n        }\n        this.attrs = {};\n        _super.prototype.destroy.call(this);\n        // this.onCanvasChange('destroy');\n    };\n    /**\n     * 是否处于动画暂停状态\n     * @return {boolean} 是否处于动画暂停状态\n     */\n    Element.prototype.isAnimatePaused = function () {\n        return this.get('_pause').isPaused;\n    };\n    /**\n     * 执行动画，支持多种函数签名\n     * 1. animate(toAttrs: ElementAttrs, duration: number, easing?: string, callback?: () => void, delay?: number)\n     * 2. animate(onFrame: OnFrame, duration: number, easing?: string, callback?: () => void, delay?: number)\n     * 3. animate(toAttrs: ElementAttrs, cfg: AnimateCfg)\n     * 4. animate(onFrame: OnFrame, cfg: AnimateCfg)\n     * 各个参数的含义为:\n     *   toAttrs  动画最终状态\n     *   onFrame  自定义帧动画函数\n     *   duration 动画执行时间\n     *   easing   动画缓动效果\n     *   callback 动画执行后的回调\n     *   delay    动画延迟时间\n     */\n    Element.prototype.animate = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        this.set('animating', true);\n        var timeline = this.get('timeline');\n        if (!timeline) {\n            timeline = this.get('canvas').get('timeline');\n            this.set('timeline', timeline);\n        }\n        var animations = this.get('animations') || [];\n        // 初始化 tick\n        if (!timeline.timer) {\n            timeline.initTimer();\n        }\n        var toAttrs = args[0], duration = args[1], _a = args[2], easing = _a === void 0 ? 'easeLinear' : _a, _b = args[3], callback = _b === void 0 ? noop : _b, _c = args[4], delay = _c === void 0 ? 0 : _c;\n        var onFrame;\n        var repeat;\n        var pauseCallback;\n        var resumeCallback;\n        var animateCfg;\n        // 第二个参数，既可以是动画最终状态 toAttrs，也可以是自定义帧动画函数 onFrame\n        if (isFunction(toAttrs)) {\n            onFrame = toAttrs;\n            toAttrs = {};\n        }\n        else if (isObject(toAttrs) && toAttrs.onFrame) {\n            // 兼容 3.0 中的写法，onFrame 和 repeat 可在 toAttrs 中设置\n            onFrame = toAttrs.onFrame;\n            repeat = toAttrs.repeat;\n        }\n        // 第二个参数，既可以是执行时间 duration，也可以是动画参数 animateCfg\n        if (isObject(duration)) {\n            animateCfg = duration;\n            duration = animateCfg.duration;\n            easing = animateCfg.easing || 'easeLinear';\n            delay = animateCfg.delay || 0;\n            // animateCfg 中的设置优先级更高\n            repeat = animateCfg.repeat || repeat || false;\n            callback = animateCfg.callback || noop;\n            pauseCallback = animateCfg.pauseCallback || noop;\n            resumeCallback = animateCfg.resumeCallback || noop;\n        }\n        else {\n            // 第四个参数，既可以是回调函数 callback，也可以是延迟时间 delay\n            if (isNumber(callback)) {\n                delay = callback;\n                callback = null;\n            }\n            // 第三个参数，既可以是缓动参数 easing，也可以是回调函数 callback\n            if (isFunction(easing)) {\n                callback = easing;\n                easing = 'easeLinear';\n            }\n            else {\n                easing = easing || 'easeLinear';\n            }\n        }\n        var formatToAttrs = getFormatToAttrs(toAttrs, this);\n        var animation = {\n            fromAttrs: getFormatFromAttrs(formatToAttrs, this),\n            toAttrs: formatToAttrs,\n            duration: duration,\n            easing: easing,\n            repeat: repeat,\n            callback: callback,\n            pauseCallback: pauseCallback,\n            resumeCallback: resumeCallback,\n            delay: delay,\n            startTime: timeline.getTime(),\n            id: uniqueId(),\n            onFrame: onFrame,\n            pathFormatted: false,\n        };\n        // 如果动画元素队列中已经有这个图形了\n        if (animations.length > 0) {\n            // 先检查是否需要合并属性。若有相同的动画，将该属性从前一个动画中删除,直接用后一个动画中\n            animations = checkExistedAttrs(animations, animation);\n        }\n        else {\n            // 否则将图形添加到动画元素队列\n            timeline.addAnimator(this);\n        }\n        animations.push(animation);\n        this.set('animations', animations);\n        this.set('_pause', { isPaused: false });\n    };\n    /**\n     * 停止动画\n     * @param {boolean} toEnd 是否到动画的最终状态\n     */\n    Element.prototype.stopAnimate = function (toEnd) {\n        var _this = this;\n        if (toEnd === void 0) { toEnd = true; }\n        var animations = this.get('animations');\n        each(animations, function (animation) {\n            // 将动画执行到最后一帧\n            if (toEnd) {\n                if (animation.onFrame) {\n                    _this.attr(animation.onFrame(1));\n                }\n                else {\n                    _this.attr(animation.toAttrs);\n                }\n            }\n            if (animation.callback) {\n                // 动画停止时的回调\n                animation.callback();\n            }\n        });\n        this.set('animating', false);\n        this.set('animations', []);\n    };\n    /**\n     * 暂停动画\n     */\n    Element.prototype.pauseAnimate = function () {\n        var timeline = this.get('timeline');\n        var animations = this.get('animations');\n        var pauseTime = timeline.getTime();\n        each(animations, function (animation) {\n            animation._paused = true;\n            animation._pauseTime = pauseTime;\n            if (animation.pauseCallback) {\n                // 动画暂停时的回调\n                animation.pauseCallback();\n            }\n        });\n        // 记录下是在什么时候暂停的\n        this.set('_pause', {\n            isPaused: true,\n            pauseTime: pauseTime,\n        });\n        return this;\n    };\n    /**\n     * 恢复动画\n     */\n    Element.prototype.resumeAnimate = function () {\n        var timeline = this.get('timeline');\n        var current = timeline.getTime();\n        var animations = this.get('animations');\n        var pauseTime = this.get('_pause').pauseTime;\n        // 之后更新属性需要计算动画已经执行的时长，如果暂停了，就把初始时间调后\n        each(animations, function (animation) {\n            animation.startTime = animation.startTime + (current - pauseTime);\n            animation._paused = false;\n            animation._pauseTime = null;\n            if (animation.resumeCallback) {\n                animation.resumeCallback();\n            }\n        });\n        this.set('_pause', {\n            isPaused: false,\n        });\n        this.set('animations', animations);\n        return this;\n    };\n    /**\n     * 触发委托事件\n     * @param  {string}     type 事件类型\n     * @param  {GraphEvent} eventObj 事件对象\n     */\n    Element.prototype.emitDelegation = function (type, eventObj) {\n        var _this = this;\n        var paths = eventObj.propagationPath;\n        var events = this.getEvents();\n        var relativeShape;\n        if (type === 'mouseenter') {\n            relativeShape = eventObj.fromShape;\n        }\n        else if (type === 'mouseleave') {\n            relativeShape = eventObj.toShape;\n        }\n        var _loop_1 = function (i) {\n            var element = paths[i];\n            // 暂定跟 name 绑定\n            var name_1 = element.get('name');\n            if (name_1) {\n                // 第一个 mouseenter 和 mouseleave 的停止即可，因为后面的都是前面的 Parent\n                if (\n                // 只有 element 是 Group 或者 Canvas 的时候，才需要判断 isParent\n                (element.isGroup() || (element.isCanvas && element.isCanvas())) &&\n                    relativeShape &&\n                    isParent(element, relativeShape)) {\n                    return \"break\";\n                }\n                if (isArray(name_1)) {\n                    each(name_1, function (subName) {\n                        _this.emitDelegateEvent(element, subName, eventObj);\n                    });\n                }\n                else {\n                    this_1.emitDelegateEvent(element, name_1, eventObj);\n                }\n            }\n        };\n        var this_1 = this;\n        // 至少有一个对象，且第一个对象为 shape\n        for (var i = 0; i < paths.length; i++) {\n            var state_1 = _loop_1(i);\n            if (state_1 === \"break\")\n                break;\n        }\n    };\n    Element.prototype.emitDelegateEvent = function (element, name, eventObj) {\n        var events = this.getEvents();\n        // 事件委托的形式 name:type\n        var eventName = name + DELEGATION_SPLIT + eventObj.type;\n        if (events[eventName] || events[WILDCARD]) {\n            // 对于通配符 *，事件名称 = 委托事件名称\n            eventObj.name = eventName;\n            eventObj.currentTarget = element;\n            eventObj.delegateTarget = this;\n            // 将委托事件的监听对象 delegateObject 挂载到事件对象上\n            eventObj.delegateObject = element.get('delegateObject');\n            this.emit(eventName, eventObj);\n        }\n    };\n    /**\n     * 移动元素\n     * @param {number} translateX 水平移动距离\n     * @param {number} translateY 垂直移动距离\n     * @return {IElement} 元素\n     */\n    Element.prototype.translate = function (translateX, translateY) {\n        if (translateX === void 0) { translateX = 0; }\n        if (translateY === void 0) { translateY = 0; }\n        var matrix = this.getMatrix();\n        var newMatrix = ext.transform(matrix, [['t', translateX, translateY]]);\n        this.setMatrix(newMatrix);\n        return this;\n    };\n    /**\n     * 移动元素到目标位置\n     * @param {number} targetX 目标位置的水平坐标\n     * @param {number} targetX 目标位置的垂直坐标\n     * @return {IElement} 元素\n     */\n    Element.prototype.move = function (targetX, targetY) {\n        var x = this.attr('x') || 0;\n        var y = this.attr('y') || 0;\n        this.translate(targetX - x, targetY - y);\n        return this;\n    };\n    /**\n     * 移动元素到目标位置，等价于 move 方法。由于 moveTo 的语义性更强，因此在文档中推荐使用 moveTo 方法\n     * @param {number} targetX 目标位置的 x 轴坐标\n     * @param {number} targetY 目标位置的 y 轴坐标\n     * @return {IElement} 元素\n     */\n    Element.prototype.moveTo = function (targetX, targetY) {\n        return this.move(targetX, targetY);\n    };\n    /**\n     * 缩放元素\n     * @param {number} ratioX 水平缩放比例\n     * @param {number} ratioY 垂直缩放比例\n     * @return {IElement} 元素\n     */\n    Element.prototype.scale = function (ratioX, ratioY) {\n        var matrix = this.getMatrix();\n        var newMatrix = ext.transform(matrix, [['s', ratioX, ratioY || ratioX]]);\n        this.setMatrix(newMatrix);\n        return this;\n    };\n    /**\n     * 以画布左上角 (0, 0) 为中心旋转元素\n     * @param {number} radian 旋转角度(弧度值)\n     * @return {IElement} 元素\n     */\n    Element.prototype.rotate = function (radian) {\n        var matrix = this.getMatrix();\n        var newMatrix = ext.transform(matrix, [['r', radian]]);\n        this.setMatrix(newMatrix);\n        return this;\n    };\n    /**\n     * 以起始点为中心旋转元素\n     * @param {number} radian 旋转角度(弧度值)\n     * @return {IElement} 元素\n     */\n    Element.prototype.rotateAtStart = function (rotate) {\n        var _a = this.attr(), x = _a.x, y = _a.y;\n        var matrix = this.getMatrix();\n        var newMatrix = ext.transform(matrix, [\n            ['t', -x, -y],\n            ['r', rotate],\n            ['t', x, y],\n        ]);\n        this.setMatrix(newMatrix);\n        return this;\n    };\n    /**\n     * 以任意点 (x, y) 为中心旋转元素\n     * @param {number} radian 旋转角度(弧度值)\n     * @return {IElement} 元素\n     */\n    Element.prototype.rotateAtPoint = function (x, y, rotate) {\n        var matrix = this.getMatrix();\n        var newMatrix = ext.transform(matrix, [\n            ['t', -x, -y],\n            ['r', rotate],\n            ['t', x, y],\n        ]);\n        this.setMatrix(newMatrix);\n        return this;\n    };\n    return Element;\n}(Base));\nexport default Element;\n//# sourceMappingURL=element.js.map"]}]}