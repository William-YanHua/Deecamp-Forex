{"remainingRequest":"/run/media/williamyh/新加卷/project/Deecamp-project/system/Web/node_modules/ts-loader/index.js??ref--4-1!/run/media/williamyh/新加卷/project/Deecamp-project/system/Web/node_modules/bizcharts/es6/processor/processor.js","dependencies":[{"path":"/run/media/williamyh/新加卷/project/Deecamp-project/system/Web/node_modules/bizcharts/es6/processor/processor.js","mtime":499162500000},{"path":"/run/media/williamyh/新加卷/project/Deecamp-project/system/Web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/run/media/williamyh/新加卷/project/Deecamp-project/system/Web/node_modules/ts-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":["'use strict';\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n    for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n            target[key] = source[key];\n        }\n    }\n} return target; };\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor)\n        descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n} } return function (Constructor, protoProps, staticProps) { if (protoProps)\n    defineProperties(Constructor.prototype, protoProps); if (staticProps)\n    defineProperties(Constructor, staticProps); return Constructor; }; }();\nvar _configAdd = require('./configAdd');\nvar _configAdd2 = _interopRequireDefault(_configAdd);\nvar _configMerge = require('./configMerge');\nvar _configMerge2 = _interopRequireDefault(_configMerge);\nvar _g2Update = require('./g2Update');\nvar _g2Update2 = _interopRequireDefault(_g2Update);\nvar _g2Delete = require('./g2Delete');\nvar _g2Delete2 = _interopRequireDefault(_g2Delete);\nvar _g2Creator = require('./g2Creator');\nvar _g2Creator2 = _interopRequireDefault(_g2Creator);\nvar _shared = require('../shared');\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\nfunction _objectWithoutProperties(obj, keys) { var target = {}; for (var i in obj) {\n    if (keys.indexOf(i) >= 0)\n        continue;\n    if (!Object.prototype.hasOwnProperty.call(obj, i))\n        continue;\n    target[i] = obj[i];\n} return target; }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n} }\nvar Processor = function () {\n    function Processor() {\n        _classCallCheck(this, Processor);\n        this.config = {};\n        this.elementInfos = {};\n        this.added = false;\n        this.initedG2 = false;\n        this.updated = false;\n        this.deleted = false;\n        this.deleteInfos = {};\n    }\n    _createClass(Processor, [{\n            key: 'calUpdateFlag',\n            value: function calUpdateFlag(name, id) {\n                var _elementInfos$id$prop = this.elementInfos[id].props, children = _elementInfos$id$prop.children, props = _objectWithoutProperties(_elementInfos$id$prop, ['children']);\n                var _elementInfos$id$upda = this.elementInfos[id].updateProps, nextChildren = _elementInfos$id$upda.children, nextProps = _objectWithoutProperties(_elementInfos$id$upda, ['children']);\n                if (name === 'Chart' || name === 'View') {\n                    var data = props.data, otherProps = _objectWithoutProperties(props, ['data']);\n                    var nextData = nextProps.data, nextOtherProps = _objectWithoutProperties(nextProps, ['data']);\n                    if (data !== nextData || !_shared.Util.isEqual(otherProps, nextOtherProps)) {\n                        this.updated = true;\n                    }\n                }\n                else if (!_shared.Util.isEqual(props, nextProps)) {\n                    this.updated = true;\n                }\n            }\n        }, {\n            key: 'addElement',\n            value: function addElement(name, id, props, parentInfo, viewId) {\n                if (!this.chart && this.initedG2)\n                    return;\n                this.added = true;\n                this.elementInfos[id] = {\n                    id: id,\n                    viewId: viewId,\n                    parentInfo: parentInfo,\n                    name: name,\n                    props: _extends({}, props)\n                };\n                if (parentInfo && !this.elementInfos[parentInfo.id]) {\n                    this.elementInfos[parentInfo.id] = {\n                        id: parentInfo.id,\n                        name: parentInfo.name\n                    };\n                }\n                _configAdd2.default.addElement(name, this.config, this.elementInfos[id]);\n            }\n        }, {\n            key: 'updateElement',\n            value: function updateElement(name, id, props) {\n                this.elementInfos[id].updateProps = _extends({}, props);\n                this.calUpdateFlag(name, id);\n            }\n        }, {\n            key: 'deleteElement',\n            value: function deleteElement(name, id) {\n                if (!this.chart)\n                    return;\n                this.deleteInfos[id] = id;\n                this.deleted = true;\n            }\n        }, {\n            key: 'createG2Instance',\n            value: function createG2Instance() {\n                var config = this.config;\n                var chart = _g2Creator2.default.createChart(config, this.elementInfos);\n                _g2Creator2.default.executeChartConfig(chart, config, this.elementInfos);\n                _g2Creator2.default.synchronizeG2Add(chart, config, this.elementInfos);\n                chart.render();\n                this.chart = chart;\n                this.initedG2 = true;\n                this.resetStates();\n                return chart;\n            }\n        }, {\n            key: 'destory',\n            value: function destory() {\n                this.chart.destroy();\n                this.chart = null;\n            }\n        }, {\n            key: 'resetStates',\n            value: function resetStates() {\n                var elems = this.elementInfos;\n                for (var id in elems) {\n                    if (elems[id].updateProps)\n                        delete elems[id].updateProps;\n                    if (this.deleteInfos[id]) {\n                        delete elems[id];\n                    }\n                }\n                this.added = false;\n                this.updated = false;\n                this.deleteInfos = {};\n            }\n        }, {\n            key: 'reExecuteChart',\n            value: function reExecuteChart() {\n                this.chart.clear();\n                _configMerge2.default.merge(this.config, this.deleteInfos, this.elementInfos, true);\n                _g2Creator2.default.executeChartConfig(this.chart, this.config, this.elementInfos);\n                _g2Creator2.default.synchronizeG2Add(this.chart, this.config, this.elementInfos);\n                this.chart.repaint();\n                this.resetStates();\n                return this.chart;\n            }\n        }, {\n            key: 'batchedUpdate',\n            value: function batchedUpdate() {\n                if (this.chart == null)\n                    return null;\n                if (this.config.chart.props.forceUpdate || _g2Update2.default.needRebuildChart(this.config)) {\n                    _configMerge2.default.merge(this.config, this.deleteInfos, this.elementInfos, true);\n                    this.chart.destroy();\n                    this.chart = 'destroy';\n                    return this.createG2Instance();\n                }\n                if (_g2Delete2.default.needReExecute(this.deleteInfos, this.elementInfos) || _g2Update2.default.needReExecute(this.config)) {\n                    this.reExecuteChart();\n                    return this.chart;\n                }\n                if (this.deleted) {\n                    _g2Delete2.default.synchronizeG2Delete(this.chart, this.config, this.deleteInfos, this.elementInfos);\n                    _configMerge2.default.mergeDelete(this.config, this.deleteInfos, this.elementInfos);\n                }\n                if (this.added) {\n                    _g2Creator2.default.synchronizeG2Add(this.chart, this.config);\n                }\n                if (this.updated) {\n                    _g2Update2.default.synchronizeG2Update(this.chart, this.config);\n                }\n                if (this.added || this.deleted || this.updated) {\n                    this.chart.repaint();\n                }\n                _configMerge2.default.mergeUpdate(this.config, false);\n                this.resetStates();\n                return this.chart;\n            }\n        }]);\n    return Processor;\n}();\nexports.default = Processor;\n",{"version":3,"file":"/run/media/williamyh/新加卷/project/Deecamp-project/system/Web/node_modules/bizcharts/es6/processor/processor.js","sourceRoot":"","sources":["/run/media/williamyh/新加卷/project/Deecamp-project/system/Web/node_modules/bizcharts/es6/processor/processor.js"],"names":[],"mappings":"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","sourcesContent":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _configAdd = require('./configAdd');\n\nvar _configAdd2 = _interopRequireDefault(_configAdd);\n\nvar _configMerge = require('./configMerge');\n\nvar _configMerge2 = _interopRequireDefault(_configMerge);\n\nvar _g2Update = require('./g2Update');\n\nvar _g2Update2 = _interopRequireDefault(_g2Update);\n\nvar _g2Delete = require('./g2Delete');\n\nvar _g2Delete2 = _interopRequireDefault(_g2Delete);\n\nvar _g2Creator = require('./g2Creator');\n\nvar _g2Creator2 = _interopRequireDefault(_g2Creator);\n\nvar _shared = require('../shared');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _objectWithoutProperties(obj, keys) { var target = {}; for (var i in obj) { if (keys.indexOf(i) >= 0) continue; if (!Object.prototype.hasOwnProperty.call(obj, i)) continue; target[i] = obj[i]; } return target; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Processor = function () {\n  function Processor() {\n    _classCallCheck(this, Processor);\n\n    this.config = {};\n    this.elementInfos = {};\n    this.added = false;\n    this.initedG2 = false;\n    this.updated = false;\n    this.deleted = false;\n    this.deleteInfos = {};\n  }\n\n  _createClass(Processor, [{\n    key: 'calUpdateFlag',\n    value: function calUpdateFlag(name, id) {\n      /* eslint-disable  no-unused-vars */\n      var _elementInfos$id$prop = this.elementInfos[id].props,\n          children = _elementInfos$id$prop.children,\n          props = _objectWithoutProperties(_elementInfos$id$prop, ['children']);\n\n      var _elementInfos$id$upda = this.elementInfos[id].updateProps,\n          nextChildren = _elementInfos$id$upda.children,\n          nextProps = _objectWithoutProperties(_elementInfos$id$upda, ['children']);\n      /* eslint-enable */\n\n\n      if (name === 'Chart' || name === 'View') {\n        var data = props.data,\n            otherProps = _objectWithoutProperties(props, ['data']);\n\n        var nextData = nextProps.data,\n            nextOtherProps = _objectWithoutProperties(nextProps, ['data']);\n\n        if (data !== nextData || !_shared.Util.isEqual(otherProps, nextOtherProps)) {\n          this.updated = true;\n        }\n      } else if (!_shared.Util.isEqual(props, nextProps)) {\n        this.updated = true;\n      }\n    }\n  }, {\n    key: 'addElement',\n    value: function addElement(name, id, props, parentInfo, viewId) {\n      if (!this.chart && this.initedG2) return;\n      this.added = true;\n      this.elementInfos[id] = {\n        id: id,\n        viewId: viewId,\n        parentInfo: parentInfo,\n        name: name,\n        props: _extends({}, props)\n      };\n      if (parentInfo && !this.elementInfos[parentInfo.id]) {\n        this.elementInfos[parentInfo.id] = {\n          id: parentInfo.id,\n          name: parentInfo.name\n        };\n      }\n\n      _configAdd2.default.addElement(name, this.config, this.elementInfos[id]);\n    }\n  }, {\n    key: 'updateElement',\n    value: function updateElement(name, id, props) {\n      this.elementInfos[id].updateProps = _extends({}, props);\n      this.calUpdateFlag(name, id);\n    }\n  }, {\n    key: 'deleteElement',\n    value: function deleteElement(name, id) {\n      if (!this.chart) return;\n\n      this.deleteInfos[id] = id;\n      this.deleted = true;\n    }\n  }, {\n    key: 'createG2Instance',\n    value: function createG2Instance() {\n      var config = this.config;\n\n      var chart = _g2Creator2.default.createChart(config, this.elementInfos);\n      _g2Creator2.default.executeChartConfig(chart, config, this.elementInfos);\n      _g2Creator2.default.synchronizeG2Add(chart, config, this.elementInfos);\n\n      chart.render();\n\n      this.chart = chart;\n      this.initedG2 = true;\n      this.resetStates();\n      return chart;\n    }\n  }, {\n    key: 'destory',\n    value: function destory() {\n      this.chart.destroy();\n      this.chart = null;\n    }\n  }, {\n    key: 'resetStates',\n    value: function resetStates() {\n      var elems = this.elementInfos;\n      // eslint-disable-next-line guard-for-in\n      for (var id in elems) {\n        if (elems[id].updateProps) delete elems[id].updateProps;\n        if (this.deleteInfos[id]) {\n          delete elems[id];\n        }\n      }\n      this.added = false;\n      this.updated = false;\n      this.deleteInfos = {};\n    }\n  }, {\n    key: 'reExecuteChart',\n    value: function reExecuteChart() {\n      this.chart.clear();\n      _configMerge2.default.merge(this.config, this.deleteInfos, this.elementInfos, true);\n      _g2Creator2.default.executeChartConfig(this.chart, this.config, this.elementInfos);\n      _g2Creator2.default.synchronizeG2Add(this.chart, this.config, this.elementInfos);\n      this.chart.repaint();\n      this.resetStates();\n      return this.chart;\n    }\n  }, {\n    key: 'batchedUpdate',\n    value: function batchedUpdate() {\n      if (this.chart == null) return null;\n      if (this.config.chart.props.forceUpdate || _g2Update2.default.needRebuildChart(this.config)) {\n        _configMerge2.default.merge(this.config, this.deleteInfos, this.elementInfos, true);\n        this.chart.destroy();\n        this.chart = 'destroy';\n        return this.createG2Instance();\n      }\n      if (_g2Delete2.default.needReExecute(this.deleteInfos, this.elementInfos) || _g2Update2.default.needReExecute(this.config)) {\n        this.reExecuteChart();\n        return this.chart;\n      }\n\n      if (this.deleted) {\n        _g2Delete2.default.synchronizeG2Delete(this.chart, this.config, this.deleteInfos, this.elementInfos);\n        _configMerge2.default.mergeDelete(this.config, this.deleteInfos, this.elementInfos);\n      }\n\n      if (this.added) {\n        _g2Creator2.default.synchronizeG2Add(this.chart, this.config);\n      }\n      if (this.updated) {\n        _g2Update2.default.synchronizeG2Update(this.chart, this.config);\n      }\n      // if (g2Update.needRepaint(this.config) && (this.added || this.deleted || this.updated)) {\n      if (this.added || this.deleted || this.updated) {\n        this.chart.repaint();\n      }\n\n      _configMerge2.default.mergeUpdate(this.config, false);\n      this.resetStates();\n\n      return this.chart;\n    }\n  }]);\n\n  return Processor;\n}();\n\nexports.default = Processor;"]}]}