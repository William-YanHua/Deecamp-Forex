{"remainingRequest":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\ts-loader\\index.js??ref--4-1!D:\\project\\Deecamp-project\\system\\Web\\node_modules\\@antv\\g\\lib\\renderers\\svg\\painter.js","dependencies":[{"path":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\@antv\\g\\lib\\renderers\\svg\\painter.js","mtime":499162500000},{"path":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1595520254649},{"path":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\ts-loader\\index.js","mtime":1537906253000}],"contextDependencies":[],"result":["var Util = require('../../util');\r\nvar _require = require('../../util/format'), parseRadius = _require.parseRadius;\r\nvar Marker = require('../../shapes/marker');\r\nvar Defs = require('./defs');\r\nvar SHAPE_TO_TAGS = {\r\n    rect: 'path',\r\n    circle: 'circle',\r\n    line: 'line',\r\n    path: 'path',\r\n    marker: 'path',\r\n    text: 'text',\r\n    polygon: 'polygon',\r\n    image: 'image',\r\n    ellipse: 'ellipse',\r\n    dom: 'foreignObject',\r\n    fan: 'path',\r\n    group: 'g'\r\n};\r\nvar LETTER_SPACING = 0.3;\r\nvar SVG_ATTR_MAP = {\r\n    opacity: 'opacity',\r\n    fillStyle: 'fill',\r\n    strokeOpacity: 'stroke-opacity',\r\n    fillOpacity: 'fill-opacity',\r\n    strokeStyle: 'stroke',\r\n    x: 'x',\r\n    y: 'y',\r\n    r: 'r',\r\n    width: 'width',\r\n    height: 'height',\r\n    x1: 'x1',\r\n    x2: 'x2',\r\n    y1: 'y1',\r\n    y2: 'y2',\r\n    lineCap: 'stroke-linecap',\r\n    lineJoin: 'stroke-linejoin',\r\n    lineWidth: 'stroke-width',\r\n    lineDash: 'stroke-dasharray',\r\n    lineDashOffset: 'stroke-dashoffset',\r\n    miterLimit: 'stroke-miterlimit',\r\n    font: 'font',\r\n    fontSize: 'font-size',\r\n    fontStyle: 'font-style',\r\n    fontVariant: 'font-variant',\r\n    fontWeight: 'font-weight',\r\n    fontFamily: 'font-family',\r\n    startArrow: 'marker-start',\r\n    endArrow: 'marker-end',\r\n    path: 'd',\r\n    class: 'class',\r\n    id: 'id',\r\n    style: 'style',\r\n    preserveAspectRatio: 'preserveAspectRatio'\r\n};\r\nvar BASELINE_MAP = {\r\n    top: 'before-edge',\r\n    middle: 'central',\r\n    bottom: 'after-edge',\r\n    alphabetic: 'baseline',\r\n    hanging: 'hanging'\r\n};\r\nvar ANCHOR_MAP = {\r\n    left: 'left',\r\n    start: 'left',\r\n    center: 'middle',\r\n    right: 'end',\r\n    end: 'end'\r\n};\r\nvar Painter = function () {\r\n    function Painter(dom) {\r\n        if (!dom) {\r\n            return null;\r\n        }\r\n        var svgId = Util.uniqueId('canvas_');\r\n        var canvasDom = Util.createDom(\"<svg id=\\\"\" + svgId + \"\\\"></svg>\");\r\n        dom.appendChild(canvasDom);\r\n        this.type = 'svg';\r\n        this.canvas = canvasDom;\r\n        this.context = new Defs(canvasDom);\r\n        this.toDraw = false;\r\n        return this;\r\n    }\r\n    var _proto = Painter.prototype;\r\n    _proto.draw = function draw(model) {\r\n        var self = this;\r\n        function drawInner() {\r\n            self.animateHandler = Util.requestAnimationFrame(function () {\r\n                self.animateHandler = undefined;\r\n                if (self.toDraw) {\r\n                    drawInner();\r\n                }\r\n            });\r\n            try {\r\n                model.resetMatrix();\r\n                self._drawGroup(model, false);\r\n            }\r\n            catch (ev) {\r\n                console.warn('error in draw canvas, detail as:');\r\n                console.warn(ev);\r\n                self.toDraw = false;\r\n            }\r\n            self.toDraw = false;\r\n        }\r\n        if (self.animateHandler) {\r\n            self.toDraw = true;\r\n        }\r\n        else {\r\n            drawInner();\r\n        }\r\n    };\r\n    _proto.drawSync = function drawSync(model) {\r\n        this._drawChildren(model, false);\r\n    };\r\n    _proto._drawGroup = function _drawGroup(model, redraw) {\r\n        var cfg = model._cfg;\r\n        if (cfg.removed || cfg.destroyed) {\r\n            return;\r\n        }\r\n        if (!cfg.el && cfg.attrs) {\r\n            redraw = true;\r\n        }\r\n        if (cfg.tobeRemoved) {\r\n            Util.each(cfg.tobeRemoved, function (item) {\r\n                if (item.parentNode) {\r\n                    item.parentNode.removeChild(item);\r\n                }\r\n            });\r\n            cfg.tobeRemoved = [];\r\n        }\r\n        this._drawShape(model, redraw);\r\n        if (cfg.children && cfg.children.length > 0) {\r\n            this._drawChildren(model, redraw);\r\n        }\r\n    };\r\n    _proto._drawChildren = function _drawChildren(parent, redraw) {\r\n        var self = this;\r\n        var children = parent._cfg.children;\r\n        var shape;\r\n        if (!children) {\r\n            return;\r\n        }\r\n        if (parent._cfg.el && !redraw) {\r\n            var childLen = parent._cfg.el.childNodes.length + 1;\r\n            if (childLen !== 0 && childLen !== children.length) {\r\n                redraw = true;\r\n            }\r\n        }\r\n        for (var i = 0; i < children.length; i++) {\r\n            shape = children[i];\r\n            if (shape.isGroup) {\r\n                self._drawGroup(shape, redraw);\r\n            }\r\n            else {\r\n                self._drawShape(shape, redraw);\r\n            }\r\n        }\r\n    };\r\n    _proto._drawShape = function _drawShape(model, redraw) {\r\n        var self = this;\r\n        var attrs = model._attrs;\r\n        var cfg = model._cfg;\r\n        var el = cfg.el;\r\n        if (cfg.removed || cfg.destroyed) {\r\n            if (el) {\r\n                el.parentNode.removeChild(cfg.el);\r\n            }\r\n            return;\r\n        }\r\n        if (redraw && el) {\r\n            el.parentNode && el.parentNode.removeChild(el);\r\n            el = null;\r\n        }\r\n        if (!el && cfg.parent) {\r\n            self._createDom(model);\r\n            self._updateShape(model);\r\n        }\r\n        el = cfg.el;\r\n        if (cfg.visible === false) {\r\n            el.setAttribute('visibility', 'hidden');\r\n            return;\r\n        }\r\n        if (cfg.visible && el.hasAttribute('visibility')) {\r\n            el.removeAttribute('visibility');\r\n        }\r\n        if (cfg.hasUpdate) {\r\n            self._updateShape(model);\r\n        }\r\n        if (attrs.clip && attrs.clip._cfg.hasUpdate) {\r\n            self._updateShape(attrs.clip);\r\n        }\r\n    };\r\n    _proto._updateShape = function _updateShape(model) {\r\n        var self = this;\r\n        var attrs = model._attrs;\r\n        var formerAttrs = model._cfg.attrs;\r\n        if (!formerAttrs) {\r\n            return;\r\n        }\r\n        if (!model._cfg.el) {\r\n            self._createDom(model);\r\n        }\r\n        if ('clip' in attrs) {\r\n            this._setClip(model, attrs.clip);\r\n        }\r\n        if ('shadowOffsetX' in attrs || 'shadowOffsetY' in attrs || 'shadowBlur' in attrs || 'shadowColor' in attrs) {\r\n            this._setShadow(model);\r\n        }\r\n        if (model.type === 'text') {\r\n            self._updateText(model);\r\n            return;\r\n        }\r\n        if (model.type === 'fan') {\r\n            self._updateFan(model);\r\n        }\r\n        if (model.type === 'marker') {\r\n            model._cfg.el.setAttribute('d', self._assembleMarker(attrs));\r\n        }\r\n        if (model.type === 'rect') {\r\n            model._cfg.el.setAttribute('d', self._assembleRect(attrs));\r\n        }\r\n        for (var key in attrs) {\r\n            if (attrs[key] !== formerAttrs[key]) {\r\n                self._setAttribute(model, key, attrs[key]);\r\n            }\r\n        }\r\n        model._cfg.attrs = Util.deepMix({}, model._attrs);\r\n        model._cfg.hasUpdate = false;\r\n    };\r\n    _proto._setAttribute = function _setAttribute(model, name, value) {\r\n        var type = model.type;\r\n        var attrs = model._attrs;\r\n        var el = model._cfg.el;\r\n        var defs = this.context;\r\n        if ((type === 'marker' || type === 'rect') && ~['x', 'y', 'radius', 'r'].indexOf(name)) {\r\n            return;\r\n        }\r\n        if (~['circle', 'ellipse'].indexOf(type) && ~['x', 'y'].indexOf(name)) {\r\n            el.setAttribute('c' + name, parseInt(value, 10));\r\n            return;\r\n        }\r\n        if (type === 'polygon' && name === 'points') {\r\n            if (!value || value.length === 0) {\r\n                value = '';\r\n            }\r\n            if (Util.isArray(value)) {\r\n                value = value.map(function (point) {\r\n                    return point[0] + ',' + point[1];\r\n                });\r\n                value = value.join(' ');\r\n            }\r\n            el.setAttribute('points', value);\r\n            return;\r\n        }\r\n        if (name === 'path' && Util.isArray(value)) {\r\n            el.setAttribute('d', this._formatPath(value));\r\n            return;\r\n        }\r\n        if (name === 'img') {\r\n            this._setImage(model, value);\r\n            return;\r\n        }\r\n        if (name === 'transform') {\r\n            if (!value) {\r\n                el.removeAttribute('transform');\r\n                return;\r\n            }\r\n            this._setTransform(model);\r\n            return;\r\n        }\r\n        if (name === 'rotate') {\r\n            if (!value) {\r\n                el.removeAttribute('transform');\r\n                return;\r\n            }\r\n            this._setTransform(model);\r\n            return;\r\n        }\r\n        if (name === 'matrix') {\r\n            this._setTransform(model);\r\n            return;\r\n        }\r\n        if (name === 'fillStyle' || name === 'strokeStyle') {\r\n            this._setColor(model, name, value);\r\n            return;\r\n        }\r\n        if (name === 'clip') {\r\n            return;\r\n        }\r\n        if (~name.indexOf('Arrow')) {\r\n            name = SVG_ATTR_MAP[name];\r\n            if (!value) {\r\n                model._cfg[name] = null;\r\n                el.removeAttribute(name);\r\n            }\r\n            else {\r\n                var id = null;\r\n                if (typeof value === 'boolean') {\r\n                    id = defs.getDefaultArrow(attrs, name);\r\n                }\r\n                else {\r\n                    id = defs.addArrow(attrs, name);\r\n                }\r\n                el.setAttribute(name, \"url(#\" + id + \")\");\r\n                model._cfg[name] = id;\r\n            }\r\n            return;\r\n        }\r\n        if (name === 'html') {\r\n            if (typeof value === 'string') {\r\n                el.innerHTML = value;\r\n            }\r\n            else {\r\n                el.innerHTML = '';\r\n                el.appendChild(value);\r\n            }\r\n        }\r\n        if (SVG_ATTR_MAP[name]) {\r\n            el.setAttribute(SVG_ATTR_MAP[name], value);\r\n        }\r\n    };\r\n    _proto._createDom = function _createDom(model) {\r\n        var type = SHAPE_TO_TAGS[model.type];\r\n        var attrs = model._attrs;\r\n        if (!type) {\r\n            throw new Error('the type' + model.type + 'is not supported by svg');\r\n        }\r\n        var shape = document.createElementNS('http://www.w3.org/2000/svg', type);\r\n        model._cfg.el = shape;\r\n        if (model._cfg.parent) {\r\n            model._cfg.parent.get('el').appendChild(shape);\r\n        }\r\n        model._cfg.attrs = {};\r\n        if (model.type === 'text') {\r\n            shape.setAttribute('paint-order', 'stroke');\r\n            shape.setAttribute('style', 'stroke-linecap:butt; stroke-linejoin:miter;');\r\n        }\r\n        else {\r\n            if (!attrs.stroke && !attrs.strokeStyle) {\r\n                shape.setAttribute('stroke', 'none');\r\n            }\r\n            if (!attrs.fill && !attrs.fillStyle) {\r\n                shape.setAttribute('fill', 'none');\r\n            }\r\n        }\r\n        return shape;\r\n    };\r\n    _proto._assembleMarker = function _assembleMarker(attrs) {\r\n        var r = attrs.r;\r\n        if (typeof attrs.r === 'undefined') {\r\n            r = attrs.radius;\r\n        }\r\n        if (isNaN(Number(attrs.x)) || isNaN(Number(attrs.y)) || isNaN(Number(r))) {\r\n            return '';\r\n        }\r\n        var d = '';\r\n        if (typeof attrs.symbol === 'function') {\r\n            d = attrs.symbol(attrs.x, attrs.y, r);\r\n        }\r\n        else {\r\n            d = Marker.Symbols[attrs.symbol || 'circle'](attrs.x, attrs.y, r);\r\n        }\r\n        if (Util.isArray(d)) {\r\n            d = d.map(function (path) {\r\n                return path.join(' ');\r\n            }).join('');\r\n        }\r\n        return d;\r\n    };\r\n    _proto._assembleRect = function _assembleRect(attrs) {\r\n        var x = attrs.x;\r\n        var y = attrs.y;\r\n        var w = attrs.width;\r\n        var h = attrs.height;\r\n        var radius = attrs.radius;\r\n        if (!radius) {\r\n            return \"M \" + x + \",\" + y + \" l \" + w + \",0 l 0,\" + h + \" l\" + -w + \" 0 z\";\r\n        }\r\n        var r = parseRadius(radius);\r\n        if (Util.isArray(radius)) {\r\n            if (radius.length === 1) {\r\n                r.r1 = r.r2 = r.r3 = r.r4 = radius[0];\r\n            }\r\n            else if (radius.length === 2) {\r\n                r.r1 = r.r3 = radius[0];\r\n                r.r2 = r.r4 = radius[1];\r\n            }\r\n            else if (radius.length === 3) {\r\n                r.r1 = radius[0];\r\n                r.r2 = r.r4 = radius[1];\r\n                r.r3 = radius[2];\r\n            }\r\n            else {\r\n                r.r1 = radius[0];\r\n                r.r2 = radius[1];\r\n                r.r3 = radius[2];\r\n                r.r4 = radius[3];\r\n            }\r\n        }\r\n        else {\r\n            r.r1 = r.r2 = r.r3 = r.r4 = radius;\r\n        }\r\n        var d = [[\"M \" + (x + r.r1) + \",\" + y], [\"l \" + (w - r.r1 - r.r2) + \",0\"], [\"a \" + r.r2 + \",\" + r.r2 + \",0,0,1,\" + r.r2 + \",\" + r.r2], [\"l 0,\" + (h - r.r2 - r.r3)], [\"a \" + r.r3 + \",\" + r.r3 + \",0,0,1,\" + -r.r3 + \",\" + r.r3], [\"l \" + (r.r3 + r.r4 - w) + \",0\"], [\"a \" + r.r4 + \",\" + r.r4 + \",0,0,1,\" + -r.r4 + \",\" + -r.r4], [\"l 0,\" + (r.r4 + r.r1 - h)], [\"a \" + r.r1 + \",\" + r.r1 + \",0,0,1,\" + r.r1 + \",\" + -r.r1], ['z']];\r\n        return d.join(' ');\r\n    };\r\n    _proto._formatPath = function _formatPath(value) {\r\n        value = value.map(function (path) {\r\n            return path.join(' ');\r\n        }).join('');\r\n        if (~value.indexOf('NaN')) {\r\n            return '';\r\n        }\r\n        return value;\r\n    };\r\n    _proto._setTransform = function _setTransform(model) {\r\n        var matrix = model._attrs.matrix;\r\n        var el = model._cfg.el;\r\n        var transform = [];\r\n        for (var i = 0; i < 9; i += 3) {\r\n            transform.push(matrix[i] + ',' + matrix[i + 1]);\r\n        }\r\n        transform = transform.join(',');\r\n        if (transform.indexOf('NaN') === -1) {\r\n            el.setAttribute('transform', \"matrix(\" + transform + \")\");\r\n        }\r\n        else {\r\n            console.warn('invalid matrix:', matrix);\r\n        }\r\n    };\r\n    _proto._setImage = function _setImage(model, img) {\r\n        var attrs = model._attrs;\r\n        var el = model._cfg.el;\r\n        if (Util.isString(img)) {\r\n            el.setAttribute('href', img);\r\n        }\r\n        else if (img instanceof Image) {\r\n            if (!attrs.width) {\r\n                el.setAttribute('width', img.width);\r\n                model._attrs.width = img.width;\r\n            }\r\n            if (!attrs.height) {\r\n                el.setAttribute('height', img.height);\r\n                model._attrs.height = img.height;\r\n            }\r\n            el.setAttribute('href', img.src);\r\n        }\r\n        else if (img instanceof HTMLElement && Util.isString(img.nodeName) && img.nodeName.toUpperCase() === 'CANVAS') {\r\n            el.setAttribute('href', img.toDataURL());\r\n        }\r\n        else if (img instanceof ImageData) {\r\n            var canvas = document.createElement('canvas');\r\n            canvas.setAttribute('width', img.width);\r\n            canvas.setAttribute('height', img.height);\r\n            canvas.getContext('2d').putImageData(img, 0, 0);\r\n            if (!attrs.width) {\r\n                el.setAttribute('width', img.width);\r\n                model._attrs.width = img.width;\r\n            }\r\n            if (!attrs.height) {\r\n                el.setAttribute('height', img.height);\r\n                model._attrs.height = img.height;\r\n            }\r\n            el.setAttribute('href', canvas.toDataURL());\r\n        }\r\n    };\r\n    _proto._updateFan = function _updateFan(model) {\r\n        function getPoint(angle, radius, center) {\r\n            return {\r\n                x: radius * Math.cos(angle) + center.x,\r\n                y: radius * Math.sin(angle) + center.y\r\n            };\r\n        }\r\n        var attrs = model._attrs;\r\n        var cfg = model._cfg;\r\n        var center = {\r\n            x: attrs.x,\r\n            y: attrs.y\r\n        };\r\n        var d = [];\r\n        var startAngle = attrs.startAngle;\r\n        var endAngle = attrs.endAngle;\r\n        if (Util.isNumberEqual(endAngle - startAngle, Math.PI * 2)) {\r\n            endAngle -= 0.00001;\r\n        }\r\n        var outerStart = getPoint(startAngle, attrs.re, center);\r\n        var outerEnd = getPoint(endAngle, attrs.re, center);\r\n        var fa = endAngle > startAngle ? 1 : 0;\r\n        var fs = Math.abs(endAngle - startAngle) > Math.PI ? 1 : 0;\r\n        var rs = attrs.rs;\r\n        var re = attrs.re;\r\n        var innerStart = getPoint(startAngle, attrs.rs, center);\r\n        var innerEnd = getPoint(endAngle, attrs.rs, center);\r\n        if (attrs.rs > 0) {\r\n            d.push(\"M \" + outerEnd.x + \",\" + outerEnd.y);\r\n            d.push(\"L \" + innerEnd.x + \",\" + innerEnd.y);\r\n            d.push(\"A \" + rs + \",\" + rs + \",0,\" + fs + \",\" + (fa === 1 ? 0 : 1) + \",\" + innerStart.x + \",\" + innerStart.y);\r\n            d.push(\"L \" + outerStart.x + \" \" + outerStart.y);\r\n        }\r\n        else {\r\n            d.push(\"M \" + center.x + \",\" + center.y);\r\n            d.push(\"L \" + outerStart.x + \",\" + outerStart.y);\r\n        }\r\n        d.push(\"A \" + re + \",\" + re + \",0,\" + fs + \",\" + fa + \",\" + outerEnd.x + \",\" + outerEnd.y);\r\n        if (attrs.rs > 0) {\r\n            d.push(\"L \" + innerEnd.x + \",\" + innerEnd.y);\r\n        }\r\n        else {\r\n            d.push('Z');\r\n        }\r\n        cfg.el.setAttribute('d', d.join(' '));\r\n    };\r\n    _proto._updateText = function _updateText(model) {\r\n        var self = this;\r\n        var attrs = model._attrs;\r\n        var formerAttrs = model._cfg.attrs;\r\n        var el = model._cfg.el;\r\n        this._setFont(model);\r\n        for (var attr in attrs) {\r\n            if (attrs[attr] !== formerAttrs[attr]) {\r\n                if (attr === 'text') {\r\n                    self._setText(model, \"\" + attrs[attr]);\r\n                    continue;\r\n                }\r\n                if (attr === 'fillStyle' || attr === 'strokeStyle') {\r\n                    this._setColor(model, attr, attrs[attr]);\r\n                    continue;\r\n                }\r\n                if (attr === 'matrix') {\r\n                    this._setTransform(model);\r\n                    continue;\r\n                }\r\n                if (SVG_ATTR_MAP[attr]) {\r\n                    el.setAttribute(SVG_ATTR_MAP[attr], attrs[attr]);\r\n                }\r\n            }\r\n        }\r\n        model._cfg.attrs = Object.assign({}, model._attrs);\r\n        model._cfg.hasUpdate = false;\r\n    };\r\n    _proto._setFont = function _setFont(model) {\r\n        var el = model.get('el');\r\n        var attrs = model._attrs;\r\n        var fontSize = attrs.fontSize;\r\n        el.setAttribute('alignment-baseline', BASELINE_MAP[attrs.textBaseline] || 'baseline');\r\n        el.setAttribute('text-anchor', ANCHOR_MAP[attrs.textAlign] || 'left');\r\n        if (fontSize && +fontSize < 12) {\r\n            attrs.matrix = [1, 0, 0, 0, 1, 0, 0, 0, 1];\r\n            model.transform([['t', -attrs.x, -attrs.y], ['s', +fontSize / 12, +fontSize / 12], ['t', attrs.x, attrs.y]]);\r\n        }\r\n    };\r\n    _proto._setText = function _setText(model, text) {\r\n        var el = model._cfg.el;\r\n        var baseline = model._attrs.textBaseline || 'bottom';\r\n        if (!text) {\r\n            el.innerHTML = '';\r\n        }\r\n        else if (~text.indexOf('\\n')) {\r\n            var x = model._attrs.x;\r\n            var textArr = text.split('\\n');\r\n            var textLen = textArr.length - 1;\r\n            var arr = '';\r\n            Util.each(textArr, function (segment, i) {\r\n                if (i === 0) {\r\n                    if (baseline === 'alphabetic') {\r\n                        arr += \"<tspan x=\\\"\" + x + \"\\\" dy=\\\"\" + -textLen + \"em\\\">\" + segment + \"</tspan>\";\r\n                    }\r\n                    else if (baseline === 'top') {\r\n                        arr += \"<tspan x=\\\"\" + x + \"\\\" dy=\\\"0.9em\\\">\" + segment + \"</tspan>\";\r\n                    }\r\n                    else if (baseline === 'middle') {\r\n                        arr += \"<tspan x=\\\"\" + x + \"\\\" dy=\\\"\" + -(textLen - 1) / 2 + \"em\\\">\" + segment + \"</tspan>\";\r\n                    }\r\n                    else if (baseline === 'bottom') {\r\n                        arr += \"<tspan x=\\\"\" + x + \"\\\" dy=\\\"-\" + (textLen + LETTER_SPACING) + \"em\\\">\" + segment + \"</tspan>\";\r\n                    }\r\n                    else if (baseline === 'hanging') {\r\n                        arr += \"<tspan x=\\\"\" + x + \"\\\" dy=\\\"\" + (-(textLen - 1) - LETTER_SPACING) + \"em\\\">\" + segment + \"</tspan>\";\r\n                    }\r\n                }\r\n                else {\r\n                    arr += \"<tspan x=\\\"\" + x + \"\\\" dy=\\\"1em\\\">\" + segment + \"</tspan>\";\r\n                }\r\n            });\r\n            el.innerHTML = arr;\r\n        }\r\n        else {\r\n            el.innerHTML = text;\r\n        }\r\n    };\r\n    _proto._setClip = function _setClip(model, value) {\r\n        var el = model._cfg.el;\r\n        if (!value) {\r\n            el.removeAttribute('clip-path');\r\n            return;\r\n        }\r\n        if (!el.hasAttribute('clip-path')) {\r\n            this._createDom(value);\r\n            this._updateShape(value);\r\n            var id = this.context.addClip(value);\r\n            el.setAttribute('clip-path', \"url(#\" + id + \")\");\r\n        }\r\n        else if (value._cfg.hasUpdate) {\r\n            this._updateShape(value);\r\n        }\r\n    };\r\n    _proto._setColor = function _setColor(model, name, value) {\r\n        var el = model._cfg.el;\r\n        var defs = this.context;\r\n        if (!value) {\r\n            el.setAttribute(SVG_ATTR_MAP[name], 'none');\r\n            return;\r\n        }\r\n        value = value.trim();\r\n        if (/^[r,R,L,l]{1}[\\s]*\\(/.test(value)) {\r\n            var id = defs.find('gradient', value);\r\n            if (!id) {\r\n                id = defs.addGradient(value);\r\n            }\r\n            el.setAttribute(SVG_ATTR_MAP[name], \"url(#\" + id + \")\");\r\n        }\r\n        else if (/^[p,P]{1}[\\s]*\\(/.test(value)) {\r\n            var _id = defs.find('pattern', value);\r\n            if (!_id) {\r\n                _id = defs.addPattern(value);\r\n            }\r\n            el.setAttribute(SVG_ATTR_MAP[name], \"url(#\" + _id + \")\");\r\n        }\r\n        else {\r\n            el.setAttribute(SVG_ATTR_MAP[name], value);\r\n        }\r\n    };\r\n    _proto._setShadow = function _setShadow(model) {\r\n        var el = model._cfg.el;\r\n        var attrs = model._attrs;\r\n        var cfg = {\r\n            dx: attrs.shadowOffsetX,\r\n            dy: attrs.shadowOffsetY,\r\n            blur: attrs.shadowBlur,\r\n            color: attrs.shadowColor\r\n        };\r\n        if (!cfg.dx && !cfg.dy && !cfg.blur && !cfg.color) {\r\n            el.removeAttribute('filter');\r\n        }\r\n        else {\r\n            var id = this.context.find('filter', cfg);\r\n            if (!id) {\r\n                id = this.context.addShadow(cfg, this);\r\n            }\r\n            el.setAttribute('filter', \"url(#\" + id + \")\");\r\n        }\r\n    };\r\n    return Painter;\r\n}();\r\nmodule.exports = Painter;\r\n",{"version":3,"file":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\@antv\\g\\lib\\renderers\\svg\\painter.js","sourceRoot":"","sources":["D:\\project\\Deecamp-project\\system\\Web\\node_modules\\@antv\\g\\lib\\renderers\\svg\\painter.js"],"names":[],"mappings":"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","sourcesContent":["var Util = require('../../util');\n\nvar _require = require('../../util/format'),\n    parseRadius = _require.parseRadius;\n\nvar Marker = require('../../shapes/marker');\n\nvar Defs = require('./defs');\n\nvar SHAPE_TO_TAGS = {\n  rect: 'path',\n  circle: 'circle',\n  line: 'line',\n  path: 'path',\n  marker: 'path',\n  text: 'text',\n  polygon: 'polygon',\n  image: 'image',\n  ellipse: 'ellipse',\n  dom: 'foreignObject',\n  fan: 'path',\n  group: 'g'\n};\nvar LETTER_SPACING = 0.3;\nvar SVG_ATTR_MAP = {\n  opacity: 'opacity',\n  fillStyle: 'fill',\n  strokeOpacity: 'stroke-opacity',\n  fillOpacity: 'fill-opacity',\n  strokeStyle: 'stroke',\n  x: 'x',\n  y: 'y',\n  r: 'r',\n  width: 'width',\n  height: 'height',\n  x1: 'x1',\n  x2: 'x2',\n  y1: 'y1',\n  y2: 'y2',\n  lineCap: 'stroke-linecap',\n  lineJoin: 'stroke-linejoin',\n  lineWidth: 'stroke-width',\n  lineDash: 'stroke-dasharray',\n  lineDashOffset: 'stroke-dashoffset',\n  miterLimit: 'stroke-miterlimit',\n  font: 'font',\n  fontSize: 'font-size',\n  fontStyle: 'font-style',\n  fontVariant: 'font-variant',\n  fontWeight: 'font-weight',\n  fontFamily: 'font-family',\n  startArrow: 'marker-start',\n  endArrow: 'marker-end',\n  path: 'd',\n  class: 'class',\n  id: 'id',\n  style: 'style',\n  preserveAspectRatio: 'preserveAspectRatio'\n};\nvar BASELINE_MAP = {\n  top: 'before-edge',\n  middle: 'central',\n  bottom: 'after-edge',\n  alphabetic: 'baseline',\n  hanging: 'hanging'\n};\nvar ANCHOR_MAP = {\n  left: 'left',\n  start: 'left',\n  center: 'middle',\n  right: 'end',\n  end: 'end'\n};\n\nvar Painter =\n/*#__PURE__*/\nfunction () {\n  function Painter(dom) {\n    if (!dom) {\n      return null;\n    }\n\n    var svgId = Util.uniqueId('canvas_');\n    var canvasDom = Util.createDom(\"<svg id=\\\"\" + svgId + \"\\\"></svg>\");\n    dom.appendChild(canvasDom);\n    this.type = 'svg';\n    this.canvas = canvasDom;\n    this.context = new Defs(canvasDom);\n    this.toDraw = false;\n    return this;\n  }\n\n  var _proto = Painter.prototype;\n\n  _proto.draw = function draw(model) {\n    var self = this;\n\n    function drawInner() {\n      self.animateHandler = Util.requestAnimationFrame(function () {\n        self.animateHandler = undefined;\n\n        if (self.toDraw) {\n          drawInner();\n        }\n      });\n\n      try {\n        model.resetMatrix();\n\n        self._drawGroup(model, false);\n      } catch (ev) {\n        // 绘制时异常，中断重绘\n        console.warn('error in draw canvas, detail as:');\n        console.warn(ev);\n        self.toDraw = false;\n      }\n\n      self.toDraw = false;\n    }\n\n    if (self.animateHandler) {\n      self.toDraw = true;\n    } else {\n      drawInner();\n    }\n  };\n\n  _proto.drawSync = function drawSync(model) {\n    this._drawChildren(model, false);\n  };\n\n  _proto._drawGroup = function _drawGroup(model, redraw) {\n    var cfg = model._cfg;\n\n    if (cfg.removed || cfg.destroyed) {\n      return;\n    }\n    /**\n     * FIXME redraw: 为了使元素置顶的临时解决方案\n     * 如果直接将dom元素重排可以解决部分问题。但是如果重排后的group中有新增的shape，置顶效果就没有了\n     * 所以只能删除原有节点，新增节点以及所有子节点。这时候哪怕shape有el，也需要判断一下是否需要重绘\n     */\n\n\n    if (!cfg.el && cfg.attrs) {\n      redraw = true;\n    }\n\n    if (cfg.tobeRemoved) {\n      Util.each(cfg.tobeRemoved, function (item) {\n        if (item.parentNode) {\n          item.parentNode.removeChild(item);\n        }\n      });\n      cfg.tobeRemoved = [];\n    }\n\n    this._drawShape(model, redraw);\n\n    if (cfg.children && cfg.children.length > 0) {\n      this._drawChildren(model, redraw);\n    }\n  };\n\n  _proto._drawChildren = function _drawChildren(parent, redraw) {\n    var self = this;\n    var children = parent._cfg.children;\n    var shape; // 防止在画children的时候，父group已经被destroy\n\n    if (!children) {\n      return;\n    }\n\n    if (parent._cfg.el && !redraw) {\n      // FIXME 这边是为了解决一个group中有元素已经生成el，还有一些没生成el时，没生成el的置底效果不work\n      var childLen = parent._cfg.el.childNodes.length + 1;\n\n      if (childLen !== 0 && childLen !== children.length) {\n        redraw = true;\n      }\n    }\n\n    for (var i = 0; i < children.length; i++) {\n      shape = children[i];\n\n      if (shape.isGroup) {\n        self._drawGroup(shape, redraw);\n      } else {\n        self._drawShape(shape, redraw);\n      }\n    }\n  };\n\n  _proto._drawShape = function _drawShape(model, redraw) {\n    var self = this;\n    var attrs = model._attrs;\n    var cfg = model._cfg;\n    var el = cfg.el; // 删除\n\n    if (cfg.removed || cfg.destroyed) {\n      if (el) {\n        el.parentNode.removeChild(cfg.el);\n      }\n\n      return;\n    } // 重绘节点\n\n\n    if (redraw && el) {\n      el.parentNode && el.parentNode.removeChild(el);\n      el = null;\n    } // 新增节点\n\n\n    if (!el && cfg.parent) {\n      self._createDom(model);\n\n      self._updateShape(model);\n    }\n\n    el = cfg.el;\n\n    if (cfg.visible === false) {\n      el.setAttribute('visibility', 'hidden');\n      return;\n    }\n\n    if (cfg.visible && el.hasAttribute('visibility')) {\n      el.removeAttribute('visibility');\n    } // 更新\n\n\n    if (cfg.hasUpdate) {\n      self._updateShape(model);\n    }\n\n    if (attrs.clip && attrs.clip._cfg.hasUpdate) {\n      self._updateShape(attrs.clip);\n    }\n  };\n\n  _proto._updateShape = function _updateShape(model) {\n    var self = this;\n    var attrs = model._attrs;\n    var formerAttrs = model._cfg.attrs;\n\n    if (!formerAttrs) {\n      return;\n    }\n\n    if (!model._cfg.el) {\n      self._createDom(model);\n    }\n\n    if ('clip' in attrs) {\n      this._setClip(model, attrs.clip);\n    }\n\n    if ('shadowOffsetX' in attrs || 'shadowOffsetY' in attrs || 'shadowBlur' in attrs || 'shadowColor' in attrs) {\n      this._setShadow(model);\n    }\n\n    if (model.type === 'text') {\n      self._updateText(model);\n\n      return;\n    }\n\n    if (model.type === 'fan') {\n      self._updateFan(model);\n    }\n\n    if (model.type === 'marker') {\n      model._cfg.el.setAttribute('d', self._assembleMarker(attrs));\n    }\n\n    if (model.type === 'rect') {\n      model._cfg.el.setAttribute('d', self._assembleRect(attrs));\n    }\n\n    for (var key in attrs) {\n      if (attrs[key] !== formerAttrs[key]) {\n        self._setAttribute(model, key, attrs[key]);\n      }\n    }\n\n    model._cfg.attrs = Util.deepMix({}, model._attrs);\n    model._cfg.hasUpdate = false;\n  };\n\n  _proto._setAttribute = function _setAttribute(model, name, value) {\n    var type = model.type;\n    var attrs = model._attrs;\n    var el = model._cfg.el;\n    var defs = this.context; // 计算marker路径\n\n    if ((type === 'marker' || type === 'rect') && ~['x', 'y', 'radius', 'r'].indexOf(name)) {\n      return;\n    } // 圆和椭圆不是x, y， 是cx, cy。 marker的x,y 用于计算marker的路径，不需要写到dom\n\n\n    if (~['circle', 'ellipse'].indexOf(type) && ~['x', 'y'].indexOf(name)) {\n      el.setAttribute('c' + name, parseInt(value, 10));\n      return;\n    } // 多边形\n\n\n    if (type === 'polygon' && name === 'points') {\n      if (!value || value.length === 0) {\n        value = '';\n      }\n\n      if (Util.isArray(value)) {\n        value = value.map(function (point) {\n          return point[0] + ',' + point[1];\n        });\n        value = value.join(' ');\n      }\n\n      el.setAttribute('points', value);\n      return;\n    } // 设置path\n\n\n    if (name === 'path' && Util.isArray(value)) {\n      el.setAttribute('d', this._formatPath(value));\n      return;\n    } // 设置图片\n\n\n    if (name === 'img') {\n      this._setImage(model, value);\n\n      return;\n    }\n\n    if (name === 'transform') {\n      if (!value) {\n        el.removeAttribute('transform');\n        return;\n      }\n\n      this._setTransform(model);\n\n      return;\n    }\n\n    if (name === 'rotate') {\n      if (!value) {\n        el.removeAttribute('transform');\n        return;\n      }\n\n      this._setTransform(model);\n\n      return;\n    }\n\n    if (name === 'matrix') {\n      this._setTransform(model);\n\n      return;\n    }\n\n    if (name === 'fillStyle' || name === 'strokeStyle') {\n      this._setColor(model, name, value);\n\n      return;\n    }\n\n    if (name === 'clip') {\n      return;\n    }\n\n    if (~name.indexOf('Arrow')) {\n      name = SVG_ATTR_MAP[name];\n\n      if (!value) {\n        model._cfg[name] = null;\n        el.removeAttribute(name);\n      } else {\n        var id = null;\n\n        if (typeof value === 'boolean') {\n          id = defs.getDefaultArrow(attrs, name);\n        } else {\n          id = defs.addArrow(attrs, name);\n        }\n\n        el.setAttribute(name, \"url(#\" + id + \")\");\n        model._cfg[name] = id;\n      }\n\n      return;\n    } // foreignObject\n\n\n    if (name === 'html') {\n      if (typeof value === 'string') {\n        el.innerHTML = value;\n      } else {\n        el.innerHTML = '';\n        el.appendChild(value);\n      }\n    }\n\n    if (SVG_ATTR_MAP[name]) {\n      el.setAttribute(SVG_ATTR_MAP[name], value);\n    }\n  };\n\n  _proto._createDom = function _createDom(model) {\n    var type = SHAPE_TO_TAGS[model.type];\n    var attrs = model._attrs;\n\n    if (!type) {\n      throw new Error('the type' + model.type + 'is not supported by svg');\n    }\n\n    var shape = document.createElementNS('http://www.w3.org/2000/svg', type);\n    model._cfg.el = shape;\n\n    if (model._cfg.parent) {\n      model._cfg.parent.get('el').appendChild(shape);\n    }\n\n    model._cfg.attrs = {};\n\n    if (model.type === 'text') {\n      shape.setAttribute('paint-order', 'stroke');\n      shape.setAttribute('style', 'stroke-linecap:butt; stroke-linejoin:miter;');\n    } else {\n      if (!attrs.stroke && !attrs.strokeStyle) {\n        shape.setAttribute('stroke', 'none');\n      }\n\n      if (!attrs.fill && !attrs.fillStyle) {\n        shape.setAttribute('fill', 'none');\n      }\n    }\n\n    return shape;\n  };\n\n  _proto._assembleMarker = function _assembleMarker(attrs) {\n    var r = attrs.r;\n\n    if (typeof attrs.r === 'undefined') {\n      r = attrs.radius;\n    }\n\n    if (isNaN(Number(attrs.x)) || isNaN(Number(attrs.y)) || isNaN(Number(r))) {\n      return '';\n    }\n\n    var d = '';\n\n    if (typeof attrs.symbol === 'function') {\n      d = attrs.symbol(attrs.x, attrs.y, r);\n    } else {\n      d = Marker.Symbols[attrs.symbol || 'circle'](attrs.x, attrs.y, r);\n    }\n\n    if (Util.isArray(d)) {\n      d = d.map(function (path) {\n        return path.join(' ');\n      }).join('');\n    }\n\n    return d;\n  };\n\n  _proto._assembleRect = function _assembleRect(attrs) {\n    var x = attrs.x;\n    var y = attrs.y;\n    var w = attrs.width;\n    var h = attrs.height;\n    var radius = attrs.radius;\n\n    if (!radius) {\n      return \"M \" + x + \",\" + y + \" l \" + w + \",0 l 0,\" + h + \" l\" + -w + \" 0 z\";\n    }\n\n    var r = parseRadius(radius);\n\n    if (Util.isArray(radius)) {\n      if (radius.length === 1) {\n        r.r1 = r.r2 = r.r3 = r.r4 = radius[0];\n      } else if (radius.length === 2) {\n        r.r1 = r.r3 = radius[0];\n        r.r2 = r.r4 = radius[1];\n      } else if (radius.length === 3) {\n        r.r1 = radius[0];\n        r.r2 = r.r4 = radius[1];\n        r.r3 = radius[2];\n      } else {\n        r.r1 = radius[0];\n        r.r2 = radius[1];\n        r.r3 = radius[2];\n        r.r4 = radius[3];\n      }\n    } else {\n      r.r1 = r.r2 = r.r3 = r.r4 = radius;\n    }\n\n    var d = [[\"M \" + (x + r.r1) + \",\" + y], [\"l \" + (w - r.r1 - r.r2) + \",0\"], [\"a \" + r.r2 + \",\" + r.r2 + \",0,0,1,\" + r.r2 + \",\" + r.r2], [\"l 0,\" + (h - r.r2 - r.r3)], [\"a \" + r.r3 + \",\" + r.r3 + \",0,0,1,\" + -r.r3 + \",\" + r.r3], [\"l \" + (r.r3 + r.r4 - w) + \",0\"], [\"a \" + r.r4 + \",\" + r.r4 + \",0,0,1,\" + -r.r4 + \",\" + -r.r4], [\"l 0,\" + (r.r4 + r.r1 - h)], [\"a \" + r.r1 + \",\" + r.r1 + \",0,0,1,\" + r.r1 + \",\" + -r.r1], ['z']];\n    return d.join(' ');\n  };\n\n  _proto._formatPath = function _formatPath(value) {\n    value = value.map(function (path) {\n      return path.join(' ');\n    }).join('');\n\n    if (~value.indexOf('NaN')) {\n      return '';\n    }\n\n    return value;\n  };\n\n  _proto._setTransform = function _setTransform(model) {\n    var matrix = model._attrs.matrix;\n    var el = model._cfg.el;\n    var transform = [];\n\n    for (var i = 0; i < 9; i += 3) {\n      transform.push(matrix[i] + ',' + matrix[i + 1]);\n    }\n\n    transform = transform.join(',');\n\n    if (transform.indexOf('NaN') === -1) {\n      el.setAttribute('transform', \"matrix(\" + transform + \")\");\n    } else {\n      console.warn('invalid matrix:', matrix);\n    }\n  };\n\n  _proto._setImage = function _setImage(model, img) {\n    var attrs = model._attrs;\n    var el = model._cfg.el;\n\n    if (Util.isString(img)) {\n      el.setAttribute('href', img);\n    } else if (img instanceof Image) {\n      if (!attrs.width) {\n        el.setAttribute('width', img.width);\n        model._attrs.width = img.width;\n      }\n\n      if (!attrs.height) {\n        el.setAttribute('height', img.height);\n        model._attrs.height = img.height;\n      }\n\n      el.setAttribute('href', img.src);\n    } else if (img instanceof HTMLElement && Util.isString(img.nodeName) && img.nodeName.toUpperCase() === 'CANVAS') {\n      el.setAttribute('href', img.toDataURL());\n    } else if (img instanceof ImageData) {\n      var canvas = document.createElement('canvas');\n      canvas.setAttribute('width', img.width);\n      canvas.setAttribute('height', img.height);\n      canvas.getContext('2d').putImageData(img, 0, 0);\n\n      if (!attrs.width) {\n        el.setAttribute('width', img.width);\n        model._attrs.width = img.width;\n      }\n\n      if (!attrs.height) {\n        el.setAttribute('height', img.height);\n        model._attrs.height = img.height;\n      }\n\n      el.setAttribute('href', canvas.toDataURL());\n    }\n  };\n\n  _proto._updateFan = function _updateFan(model) {\n    function getPoint(angle, radius, center) {\n      return {\n        x: radius * Math.cos(angle) + center.x,\n        y: radius * Math.sin(angle) + center.y\n      };\n    }\n\n    var attrs = model._attrs;\n    var cfg = model._cfg;\n    var center = {\n      x: attrs.x,\n      y: attrs.y\n    };\n    var d = [];\n    var startAngle = attrs.startAngle;\n    var endAngle = attrs.endAngle;\n\n    if (Util.isNumberEqual(endAngle - startAngle, Math.PI * 2)) {\n      endAngle -= 0.00001;\n    }\n\n    var outerStart = getPoint(startAngle, attrs.re, center);\n    var outerEnd = getPoint(endAngle, attrs.re, center);\n    var fa = endAngle > startAngle ? 1 : 0;\n    var fs = Math.abs(endAngle - startAngle) > Math.PI ? 1 : 0;\n    var rs = attrs.rs;\n    var re = attrs.re;\n    var innerStart = getPoint(startAngle, attrs.rs, center);\n    var innerEnd = getPoint(endAngle, attrs.rs, center);\n\n    if (attrs.rs > 0) {\n      d.push(\"M \" + outerEnd.x + \",\" + outerEnd.y);\n      d.push(\"L \" + innerEnd.x + \",\" + innerEnd.y);\n      d.push(\"A \" + rs + \",\" + rs + \",0,\" + fs + \",\" + (fa === 1 ? 0 : 1) + \",\" + innerStart.x + \",\" + innerStart.y);\n      d.push(\"L \" + outerStart.x + \" \" + outerStart.y);\n    } else {\n      d.push(\"M \" + center.x + \",\" + center.y);\n      d.push(\"L \" + outerStart.x + \",\" + outerStart.y);\n    }\n\n    d.push(\"A \" + re + \",\" + re + \",0,\" + fs + \",\" + fa + \",\" + outerEnd.x + \",\" + outerEnd.y);\n\n    if (attrs.rs > 0) {\n      d.push(\"L \" + innerEnd.x + \",\" + innerEnd.y);\n    } else {\n      d.push('Z');\n    }\n\n    cfg.el.setAttribute('d', d.join(' '));\n  };\n\n  _proto._updateText = function _updateText(model) {\n    var self = this;\n    var attrs = model._attrs;\n    var formerAttrs = model._cfg.attrs;\n    var el = model._cfg.el;\n\n    this._setFont(model);\n\n    for (var attr in attrs) {\n      if (attrs[attr] !== formerAttrs[attr]) {\n        if (attr === 'text') {\n          self._setText(model, \"\" + attrs[attr]);\n\n          continue;\n        }\n\n        if (attr === 'fillStyle' || attr === 'strokeStyle') {\n          this._setColor(model, attr, attrs[attr]);\n\n          continue;\n        }\n\n        if (attr === 'matrix') {\n          this._setTransform(model);\n\n          continue;\n        }\n\n        if (SVG_ATTR_MAP[attr]) {\n          el.setAttribute(SVG_ATTR_MAP[attr], attrs[attr]);\n        }\n      }\n    }\n\n    model._cfg.attrs = Object.assign({}, model._attrs);\n    model._cfg.hasUpdate = false;\n  };\n\n  _proto._setFont = function _setFont(model) {\n    var el = model.get('el');\n    var attrs = model._attrs;\n    var fontSize = attrs.fontSize;\n    el.setAttribute('alignment-baseline', BASELINE_MAP[attrs.textBaseline] || 'baseline');\n    el.setAttribute('text-anchor', ANCHOR_MAP[attrs.textAlign] || 'left');\n\n    if (fontSize && +fontSize < 12) {\n      // 小于 12 像素的文本进行 scale 处理\n      attrs.matrix = [1, 0, 0, 0, 1, 0, 0, 0, 1];\n      model.transform([['t', -attrs.x, -attrs.y], ['s', +fontSize / 12, +fontSize / 12], ['t', attrs.x, attrs.y]]);\n    }\n  };\n\n  _proto._setText = function _setText(model, text) {\n    var el = model._cfg.el;\n    var baseline = model._attrs.textBaseline || 'bottom';\n\n    if (!text) {\n      el.innerHTML = '';\n    } else if (~text.indexOf('\\n')) {\n      var x = model._attrs.x;\n      var textArr = text.split('\\n');\n      var textLen = textArr.length - 1;\n      var arr = '';\n      Util.each(textArr, function (segment, i) {\n        if (i === 0) {\n          if (baseline === 'alphabetic') {\n            arr += \"<tspan x=\\\"\" + x + \"\\\" dy=\\\"\" + -textLen + \"em\\\">\" + segment + \"</tspan>\";\n          } else if (baseline === 'top') {\n            arr += \"<tspan x=\\\"\" + x + \"\\\" dy=\\\"0.9em\\\">\" + segment + \"</tspan>\";\n          } else if (baseline === 'middle') {\n            arr += \"<tspan x=\\\"\" + x + \"\\\" dy=\\\"\" + -(textLen - 1) / 2 + \"em\\\">\" + segment + \"</tspan>\";\n          } else if (baseline === 'bottom') {\n            arr += \"<tspan x=\\\"\" + x + \"\\\" dy=\\\"-\" + (textLen + LETTER_SPACING) + \"em\\\">\" + segment + \"</tspan>\";\n          } else if (baseline === 'hanging') {\n            arr += \"<tspan x=\\\"\" + x + \"\\\" dy=\\\"\" + (-(textLen - 1) - LETTER_SPACING) + \"em\\\">\" + segment + \"</tspan>\";\n          }\n        } else {\n          arr += \"<tspan x=\\\"\" + x + \"\\\" dy=\\\"1em\\\">\" + segment + \"</tspan>\";\n        }\n      });\n      el.innerHTML = arr;\n    } else {\n      el.innerHTML = text;\n    }\n  };\n\n  _proto._setClip = function _setClip(model, value) {\n    var el = model._cfg.el;\n\n    if (!value) {\n      el.removeAttribute('clip-path');\n      return;\n    }\n\n    if (!el.hasAttribute('clip-path')) {\n      this._createDom(value);\n\n      this._updateShape(value);\n\n      var id = this.context.addClip(value);\n      el.setAttribute('clip-path', \"url(#\" + id + \")\");\n    } else if (value._cfg.hasUpdate) {\n      this._updateShape(value);\n    }\n  };\n\n  _proto._setColor = function _setColor(model, name, value) {\n    var el = model._cfg.el;\n    var defs = this.context;\n\n    if (!value) {\n      el.setAttribute(SVG_ATTR_MAP[name], 'none');\n      return;\n    }\n\n    value = value.trim();\n\n    if (/^[r,R,L,l]{1}[\\s]*\\(/.test(value)) {\n      var id = defs.find('gradient', value);\n\n      if (!id) {\n        id = defs.addGradient(value);\n      }\n\n      el.setAttribute(SVG_ATTR_MAP[name], \"url(#\" + id + \")\");\n    } else if (/^[p,P]{1}[\\s]*\\(/.test(value)) {\n      var _id = defs.find('pattern', value);\n\n      if (!_id) {\n        _id = defs.addPattern(value);\n      }\n\n      el.setAttribute(SVG_ATTR_MAP[name], \"url(#\" + _id + \")\");\n    } else {\n      el.setAttribute(SVG_ATTR_MAP[name], value);\n    }\n  };\n\n  _proto._setShadow = function _setShadow(model) {\n    var el = model._cfg.el;\n    var attrs = model._attrs;\n    var cfg = {\n      dx: attrs.shadowOffsetX,\n      dy: attrs.shadowOffsetY,\n      blur: attrs.shadowBlur,\n      color: attrs.shadowColor\n    };\n\n    if (!cfg.dx && !cfg.dy && !cfg.blur && !cfg.color) {\n      el.removeAttribute('filter');\n    } else {\n      var id = this.context.find('filter', cfg);\n\n      if (!id) {\n        id = this.context.addShadow(cfg, this);\n      }\n\n      el.setAttribute('filter', \"url(#\" + id + \")\");\n    }\n  };\n\n  return Painter;\n}();\n\nmodule.exports = Painter;"]}]}