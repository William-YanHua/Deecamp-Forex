{"remainingRequest":"/run/media/williamyh/新加卷/project/Deecamp-project/system/Web/node_modules/ts-loader/index.js??ref--4-1!/run/media/williamyh/新加卷/project/Deecamp-project/system/Web/node_modules/bizcharts/node_modules/@antv/g2/lib/chart/controller/event.js","dependencies":[{"path":"/run/media/williamyh/新加卷/project/Deecamp-project/system/Web/node_modules/bizcharts/node_modules/@antv/g2/lib/chart/controller/event.js","mtime":499162500000},{"path":"/run/media/williamyh/新加卷/project/Deecamp-project/system/Web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/run/media/williamyh/新加卷/project/Deecamp-project/system/Web/node_modules/ts-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":["var Util = require('../../util');\nfunction isSameShape(shape1, shape2) {\n    if (Util.isNil(shape1) || Util.isNil(shape2)) {\n        return false;\n    }\n    var shape1Origin = shape1.get('origin');\n    var shape2Origin = shape2.get('origin');\n    if (Util.isNil(shape1Origin) && Util.isNil(shape2Origin)) {\n        return Util.isEqual(shape1, shape2);\n    }\n    return Util.isEqual(shape1Origin, shape2Origin);\n}\nfunction registerData(eventObj) {\n    if (eventObj.shape && eventObj.shape.get('origin')) {\n        eventObj.data = eventObj.shape.get('origin');\n    }\n}\nvar EventController = function () {\n    function EventController(cfg) {\n        this.view = null;\n        this.canvas = null;\n        Util.assign(this, cfg);\n        this._init();\n    }\n    var _proto = EventController.prototype;\n    _proto._init = function _init() {\n        this.pixelRatio = this.canvas.get('pixelRatio');\n    };\n    _proto._getShapeEventObj = function _getShapeEventObj(ev) {\n        return {\n            x: ev.x / this.pixelRatio,\n            y: ev.y / this.pixelRatio,\n            target: ev.target,\n            toElement: ev.event.toElement || ev.event.relatedTarget\n        };\n    };\n    _proto._getShape = function _getShape(x, y) {\n        var view = this.view;\n        var container = view.get('canvas');\n        return container.getShape(x, y);\n    };\n    _proto._getPointInfo = function _getPointInfo(ev) {\n        var view = this.view;\n        var point = {\n            x: ev.x / this.pixelRatio,\n            y: ev.y / this.pixelRatio\n        };\n        var views = view.getViewsByPoint(point);\n        point.views = views;\n        return point;\n    };\n    _proto._getEventObj = function _getEventObj(ev, point, views) {\n        return {\n            x: point.x,\n            y: point.y,\n            target: ev.target,\n            toElement: ev.event.toElement || ev.event.relatedTarget,\n            views: views\n        };\n    };\n    _proto.bindEvents = function bindEvents() {\n        var canvas = this.canvas;\n        canvas.on('mousedown', Util.wrapBehavior(this, 'onDown'));\n        canvas.on('mousemove', Util.wrapBehavior(this, 'onMove'));\n        canvas.on('mouseleave', Util.wrapBehavior(this, 'onOut'));\n        canvas.on('mouseup', Util.wrapBehavior(this, 'onUp'));\n        canvas.on('click', Util.wrapBehavior(this, 'onClick'));\n        canvas.on('dblclick', Util.wrapBehavior(this, 'onClick'));\n        canvas.on('touchstart', Util.wrapBehavior(this, 'onTouchstart'));\n        canvas.on('touchmove', Util.wrapBehavior(this, 'onTouchmove'));\n        canvas.on('touchend', Util.wrapBehavior(this, 'onTouchend'));\n    };\n    _proto._triggerShapeEvent = function _triggerShapeEvent(shape, eventName, eventObj) {\n        if (shape && shape.name && !shape.get('destroyed')) {\n            var view = this.view;\n            if (view.isShapeInView(shape)) {\n                var name = shape.name + ':' + eventName;\n                eventObj.view = view;\n                eventObj.appendInfo = shape.get('appendInfo');\n                view.emit(name, eventObj);\n                var parent = view.get('parent');\n                if (parent) {\n                    parent.emit(name, eventObj);\n                }\n            }\n        }\n    };\n    _proto.onDown = function onDown(ev) {\n        var view = this.view;\n        var eventObj = this._getShapeEventObj(ev);\n        eventObj.shape = this.currentShape;\n        registerData(eventObj);\n        view.emit('mousedown', eventObj);\n        this._triggerShapeEvent(this.currentShape, 'mousedown', eventObj);\n    };\n    _proto.onMove = function onMove(ev) {\n        var self = this;\n        var view = self.view;\n        var currentShape = self.currentShape;\n        if (currentShape && currentShape.get('destroyed')) {\n            currentShape = null;\n            self.currentShape = null;\n        }\n        var shape = self._getShape(ev.x, ev.y) || ev.currentTarget;\n        var eventObj = self._getShapeEventObj(ev);\n        eventObj.shape = shape;\n        registerData(eventObj);\n        view.emit('mousemove', eventObj);\n        self._triggerShapeEvent(shape, 'mousemove', eventObj);\n        if (currentShape && !isSameShape(currentShape, shape)) {\n            var leaveObj = self._getShapeEventObj(ev);\n            leaveObj.shape = currentShape;\n            leaveObj.toShape = shape;\n            registerData(leaveObj);\n            self._triggerShapeEvent(currentShape, 'mouseleave', leaveObj);\n        }\n        if (shape && !isSameShape(currentShape, shape)) {\n            var enterObj = self._getShapeEventObj(ev);\n            enterObj.shape = shape;\n            enterObj.fromShape = currentShape;\n            registerData(enterObj);\n            self._triggerShapeEvent(shape, 'mouseenter', enterObj);\n        }\n        self.currentShape = shape;\n        var point = self._getPointInfo(ev);\n        var preViews = self.curViews || [];\n        if (preViews.length === 0 && point.views.length) {\n            view.emit('plotenter', self._getEventObj(ev, point, point.views));\n        }\n        if (preViews.length && point.views.length === 0) {\n            view.emit('plotleave', self._getEventObj(ev, point, preViews));\n        }\n        if (point.views.length) {\n            eventObj = self._getEventObj(ev, point, point.views);\n            eventObj.shape = shape;\n            registerData(eventObj);\n            view.emit('plotmove', eventObj);\n        }\n        self.curViews = point.views;\n    };\n    _proto.onOut = function onOut(ev) {\n        var self = this;\n        var view = self.view;\n        var point = self._getPointInfo(ev);\n        var preViews = self.curViews || [];\n        var evtObj = self._getEventObj(ev, point, preViews);\n        if (self.curViews && self.curViews.length !== 0 && (!evtObj.toElement || evtObj.toElement.tagName !== 'CANVAS')) {\n            view.emit('plotleave', evtObj);\n            self.curViews = [];\n        }\n    };\n    _proto.onUp = function onUp(ev) {\n        var view = this.view;\n        var eventObj = this._getShapeEventObj(ev);\n        eventObj.shape = this.currentShape;\n        view.emit('mouseup', eventObj);\n        this._triggerShapeEvent(this.currentShape, 'mouseup', eventObj);\n    };\n    _proto.onClick = function onClick(ev) {\n        var self = this;\n        var view = self.view;\n        var shape = self._getShape(ev.x, ev.y) || ev.currentTarget;\n        var shapeEventObj = self._getShapeEventObj(ev);\n        shapeEventObj.shape = shape;\n        registerData(shapeEventObj);\n        view.emit('click', shapeEventObj);\n        self._triggerShapeEvent(shape, ev.type, shapeEventObj);\n        self.currentShape = shape;\n        var point = self._getPointInfo(ev);\n        var views = point.views;\n        if (!Util.isEmpty(views)) {\n            var eventObj = self._getEventObj(ev, point, views);\n            if (self.currentShape) {\n                var _shape = self.currentShape;\n                eventObj.shape = _shape;\n                registerData(eventObj);\n            }\n            if (ev.type === 'dblclick') {\n                view.emit('plotdblclick', eventObj);\n                view.emit('dblclick', shapeEventObj);\n            }\n            else {\n                view.emit('plotclick', eventObj);\n            }\n        }\n    };\n    _proto.onTouchstart = function onTouchstart(ev) {\n        var view = this.view;\n        var shape = this._getShape(ev.x, ev.y) || ev.currentTarget;\n        var eventObj = this._getShapeEventObj(ev);\n        eventObj.shape = shape;\n        registerData(eventObj);\n        view.emit('touchstart', eventObj);\n        this._triggerShapeEvent(shape, 'touchstart', eventObj);\n        this.currentShape = shape;\n    };\n    _proto.onTouchmove = function onTouchmove(ev) {\n        var view = this.view;\n        var shape = this._getShape(ev.x, ev.y) || ev.currentTarget;\n        var eventObj = this._getShapeEventObj(ev);\n        eventObj.shape = shape;\n        registerData(eventObj);\n        view.emit('touchmove', eventObj);\n        this._triggerShapeEvent(shape, 'touchmove', eventObj);\n        this.currentShape = shape;\n    };\n    _proto.onTouchend = function onTouchend(ev) {\n        var view = this.view;\n        var eventObj = this._getShapeEventObj(ev);\n        eventObj.shape = this.currentShape;\n        registerData(eventObj);\n        view.emit('touchend', eventObj);\n        this._triggerShapeEvent(this.currentShape, 'touchend', eventObj);\n    };\n    _proto.clearEvents = function clearEvents() {\n        var canvas = this.canvas;\n        canvas.off('mousemove', Util.getWrapBehavior(this, 'onMove'));\n        canvas.off('mouseleave', Util.getWrapBehavior(this, 'onOut'));\n        canvas.off('mousedown', Util.getWrapBehavior(this, 'onDown'));\n        canvas.off('mouseup', Util.getWrapBehavior(this, 'onUp'));\n        canvas.off('click', Util.getWrapBehavior(this, 'onClick'));\n        canvas.off('dblclick', Util.getWrapBehavior(this, 'onClick'));\n        canvas.off('touchstart', Util.getWrapBehavior(this, 'onTouchstart'));\n        canvas.off('touchmove', Util.getWrapBehavior(this, 'onTouchmove'));\n        canvas.off('touchend', Util.getWrapBehavior(this, 'onTouchend'));\n    };\n    return EventController;\n}();\nmodule.exports = EventController;\n",{"version":3,"file":"/run/media/williamyh/新加卷/project/Deecamp-project/system/Web/node_modules/bizcharts/node_modules/@antv/g2/lib/chart/controller/event.js","sourceRoot":"","sources":["/run/media/williamyh/新加卷/project/Deecamp-project/system/Web/node_modules/bizcharts/node_modules/@antv/g2/lib/chart/controller/event.js"],"names":[],"mappings":"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","sourcesContent":["/**\n * @fileOverview The controller of chart's events\n * @author sima.zhang\n */\nvar Util = require('../../util');\n\nfunction isSameShape(shape1, shape2) {\n  if (Util.isNil(shape1) || Util.isNil(shape2)) {\n    return false;\n  }\n\n  var shape1Origin = shape1.get('origin');\n  var shape2Origin = shape2.get('origin'); // hotfix: if both shapes have no data，just compare shapes.\n\n  if (Util.isNil(shape1Origin) && Util.isNil(shape2Origin)) {\n    return Util.isEqual(shape1, shape2);\n  }\n\n  return Util.isEqual(shape1Origin, shape2Origin);\n}\n\nfunction registerData(eventObj) {\n  if (eventObj.shape && eventObj.shape.get('origin')) {\n    eventObj.data = eventObj.shape.get('origin');\n  }\n}\n\nvar EventController = /*#__PURE__*/function () {\n  function EventController(cfg) {\n    this.view = null;\n    this.canvas = null;\n    Util.assign(this, cfg);\n\n    this._init();\n  }\n\n  var _proto = EventController.prototype;\n\n  _proto._init = function _init() {\n    this.pixelRatio = this.canvas.get('pixelRatio');\n  };\n\n  _proto._getShapeEventObj = function _getShapeEventObj(ev) {\n    return {\n      x: ev.x / this.pixelRatio,\n      y: ev.y / this.pixelRatio,\n      target: ev.target,\n      // canvas 元素\n      toElement: ev.event.toElement || ev.event.relatedTarget\n    };\n  };\n\n  _proto._getShape = function _getShape(x, y) {\n    var view = this.view;\n    var container = view.get('canvas');\n    return container.getShape(x, y);\n  };\n\n  _proto._getPointInfo = function _getPointInfo(ev) {\n    var view = this.view;\n    var point = {\n      x: ev.x / this.pixelRatio,\n      y: ev.y / this.pixelRatio\n    };\n    var views = view.getViewsByPoint(point);\n    point.views = views;\n    return point;\n  };\n\n  _proto._getEventObj = function _getEventObj(ev, point, views) {\n    return {\n      x: point.x,\n      y: point.y,\n      target: ev.target,\n      // canvas 元素\n      toElement: ev.event.toElement || ev.event.relatedTarget,\n      // 目标元素\n      views: views\n    };\n  };\n\n  _proto.bindEvents = function bindEvents() {\n    var canvas = this.canvas;\n    canvas.on('mousedown', Util.wrapBehavior(this, 'onDown'));\n    canvas.on('mousemove', Util.wrapBehavior(this, 'onMove'));\n    canvas.on('mouseleave', Util.wrapBehavior(this, 'onOut'));\n    canvas.on('mouseup', Util.wrapBehavior(this, 'onUp'));\n    canvas.on('click', Util.wrapBehavior(this, 'onClick'));\n    canvas.on('dblclick', Util.wrapBehavior(this, 'onClick'));\n    canvas.on('touchstart', Util.wrapBehavior(this, 'onTouchstart'));\n    canvas.on('touchmove', Util.wrapBehavior(this, 'onTouchmove'));\n    canvas.on('touchend', Util.wrapBehavior(this, 'onTouchend'));\n  };\n\n  _proto._triggerShapeEvent = function _triggerShapeEvent(shape, eventName, eventObj) {\n    if (shape && shape.name && !shape.get('destroyed')) {\n      var view = this.view;\n\n      if (view.isShapeInView(shape)) {\n        var name = shape.name + ':' + eventName;\n        eventObj.view = view;\n        eventObj.appendInfo = shape.get('appendInfo'); // appendInfo is defined by user\n\n        view.emit(name, eventObj);\n        var parent = view.get('parent');\n\n        if (parent) {\n          // chart 上也需要抛出该事件，本期先不抛出\n          parent.emit(name, eventObj);\n        }\n      }\n    }\n  };\n\n  _proto.onDown = function onDown(ev) {\n    var view = this.view;\n\n    var eventObj = this._getShapeEventObj(ev);\n\n    eventObj.shape = this.currentShape;\n    registerData(eventObj);\n    view.emit('mousedown', eventObj);\n\n    this._triggerShapeEvent(this.currentShape, 'mousedown', eventObj);\n  };\n\n  _proto.onMove = function onMove(ev) {\n    var self = this;\n    var view = self.view;\n    var currentShape = self.currentShape; // 如果图形被销毁，则设置当前 shape 为空\n\n    if (currentShape && currentShape.get('destroyed')) {\n      currentShape = null;\n      self.currentShape = null;\n    }\n\n    var shape = self._getShape(ev.x, ev.y) || ev.currentTarget;\n\n    var eventObj = self._getShapeEventObj(ev);\n\n    eventObj.shape = shape;\n    registerData(eventObj);\n    view.emit('mousemove', eventObj);\n\n    self._triggerShapeEvent(shape, 'mousemove', eventObj);\n\n    if (currentShape && !isSameShape(currentShape, shape)) {\n      var leaveObj = self._getShapeEventObj(ev);\n\n      leaveObj.shape = currentShape;\n      leaveObj.toShape = shape;\n      registerData(leaveObj);\n\n      self._triggerShapeEvent(currentShape, 'mouseleave', leaveObj);\n    }\n\n    if (shape && !isSameShape(currentShape, shape)) {\n      var enterObj = self._getShapeEventObj(ev);\n\n      enterObj.shape = shape;\n      enterObj.fromShape = currentShape;\n      registerData(enterObj);\n\n      self._triggerShapeEvent(shape, 'mouseenter', enterObj);\n    }\n\n    self.currentShape = shape;\n\n    var point = self._getPointInfo(ev);\n\n    var preViews = self.curViews || [];\n\n    if (preViews.length === 0 && point.views.length) {\n      view.emit('plotenter', self._getEventObj(ev, point, point.views));\n    } // point.views 是指当前 view 或者子 view，不会取跟当前 view 同一层级的兄弟元素（view)\n\n\n    if (preViews.length && point.views.length === 0) {\n      view.emit('plotleave', self._getEventObj(ev, point, preViews));\n    }\n\n    if (point.views.length) {\n      eventObj = self._getEventObj(ev, point, point.views);\n      eventObj.shape = shape;\n      registerData(eventObj);\n      view.emit('plotmove', eventObj);\n    }\n\n    self.curViews = point.views;\n  };\n\n  _proto.onOut = function onOut(ev) {\n    var self = this;\n    var view = self.view;\n\n    var point = self._getPointInfo(ev);\n\n    var preViews = self.curViews || [];\n\n    var evtObj = self._getEventObj(ev, point, preViews); // 只有没有padding 时，当前依然在 view 的 plotRange 情况下才会出现这个情况，保证 plotleave 触发\n\n\n    if (self.curViews && self.curViews.length !== 0 && (!evtObj.toElement || evtObj.toElement.tagName !== 'CANVAS')) {\n      view.emit('plotleave', evtObj);\n      self.curViews = []; // 清空\n    }\n  };\n\n  _proto.onUp = function onUp(ev) {\n    var view = this.view;\n\n    var eventObj = this._getShapeEventObj(ev);\n\n    eventObj.shape = this.currentShape;\n    view.emit('mouseup', eventObj);\n\n    this._triggerShapeEvent(this.currentShape, 'mouseup', eventObj);\n  };\n\n  _proto.onClick = function onClick(ev) {\n    var self = this;\n    var view = self.view;\n    var shape = self._getShape(ev.x, ev.y) || ev.currentTarget;\n\n    var shapeEventObj = self._getShapeEventObj(ev);\n\n    shapeEventObj.shape = shape;\n    registerData(shapeEventObj);\n    view.emit('click', shapeEventObj);\n\n    self._triggerShapeEvent(shape, ev.type, shapeEventObj);\n\n    self.currentShape = shape;\n\n    var point = self._getPointInfo(ev);\n\n    var views = point.views;\n\n    if (!Util.isEmpty(views)) {\n      var eventObj = self._getEventObj(ev, point, views);\n\n      if (self.currentShape) {\n        var _shape = self.currentShape;\n        eventObj.shape = _shape;\n        registerData(eventObj); // eventObj.data = shape.get('origin');\n      }\n\n      if (ev.type === 'dblclick') {\n        view.emit('plotdblclick', eventObj);\n        view.emit('dblclick', shapeEventObj);\n      } else {\n        view.emit('plotclick', eventObj);\n      }\n    }\n  };\n\n  _proto.onTouchstart = function onTouchstart(ev) {\n    var view = this.view;\n    var shape = this._getShape(ev.x, ev.y) || ev.currentTarget;\n\n    var eventObj = this._getShapeEventObj(ev);\n\n    eventObj.shape = shape;\n    registerData(eventObj);\n    view.emit('touchstart', eventObj);\n\n    this._triggerShapeEvent(shape, 'touchstart', eventObj);\n\n    this.currentShape = shape;\n  };\n\n  _proto.onTouchmove = function onTouchmove(ev) {\n    var view = this.view;\n    var shape = this._getShape(ev.x, ev.y) || ev.currentTarget;\n\n    var eventObj = this._getShapeEventObj(ev);\n\n    eventObj.shape = shape;\n    registerData(eventObj);\n    view.emit('touchmove', eventObj);\n\n    this._triggerShapeEvent(shape, 'touchmove', eventObj);\n\n    this.currentShape = shape;\n  };\n\n  _proto.onTouchend = function onTouchend(ev) {\n    var view = this.view;\n\n    var eventObj = this._getShapeEventObj(ev);\n\n    eventObj.shape = this.currentShape;\n    registerData(eventObj);\n    view.emit('touchend', eventObj);\n\n    this._triggerShapeEvent(this.currentShape, 'touchend', eventObj);\n  };\n\n  _proto.clearEvents = function clearEvents() {\n    var canvas = this.canvas;\n    canvas.off('mousemove', Util.getWrapBehavior(this, 'onMove'));\n    canvas.off('mouseleave', Util.getWrapBehavior(this, 'onOut'));\n    canvas.off('mousedown', Util.getWrapBehavior(this, 'onDown'));\n    canvas.off('mouseup', Util.getWrapBehavior(this, 'onUp'));\n    canvas.off('click', Util.getWrapBehavior(this, 'onClick'));\n    canvas.off('dblclick', Util.getWrapBehavior(this, 'onClick'));\n    canvas.off('touchstart', Util.getWrapBehavior(this, 'onTouchstart'));\n    canvas.off('touchmove', Util.getWrapBehavior(this, 'onTouchmove'));\n    canvas.off('touchend', Util.getWrapBehavior(this, 'onTouchend'));\n  };\n\n  return EventController;\n}();\n\nmodule.exports = EventController;"]}]}