{"remainingRequest":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\ts-loader\\index.js??ref--4-1!D:\\project\\Deecamp-project\\system\\Web\\node_modules\\@antv\\g2plot\\esm\\plots\\heatmap\\component\\label.js","dependencies":[{"path":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\@antv\\g2plot\\esm\\plots\\heatmap\\component\\label.js","mtime":499162500000},{"path":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1595520254649},{"path":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\ts-loader\\index.js","mtime":1537906253000}],"contextDependencies":[],"result":["import { each, deepMix, clone } from '@antv/util';\r\nimport { rgb2arr, mappingColor } from '../../../util/color';\r\nvar MatrixLabel = (function () {\r\n    function MatrixLabel(cfg) {\r\n        this.destroyed = false;\r\n        this.view = cfg.view;\r\n        this.plot = cfg.plot;\r\n        var defaultOptions = this.getDefaultOptions();\r\n        this.options = deepMix(defaultOptions, cfg, {});\r\n        this.init();\r\n    }\r\n    MatrixLabel.prototype.init = function () {\r\n        var _this = this;\r\n        this.container = this.view.geometries[0].labelsContainer;\r\n        this.view.on('beforerender', function () {\r\n            _this.clear();\r\n            _this.plot.canvas.draw();\r\n        });\r\n    };\r\n    MatrixLabel.prototype.render = function () {\r\n        var _this = this;\r\n        var elements = this.view.geometries[0].elements;\r\n        each(elements, function (ele) {\r\n            var shape = ele.shape;\r\n            var _a = _this.options, style = _a.style, offsetX = _a.offsetX, offsetY = _a.offsetY;\r\n            var formatter = _this.options.formatter;\r\n            var content = formatter ? formatter(_this.getContent(shape)) : _this.getContent(shape);\r\n            var position = _this.getPosition(shape);\r\n            var color = _this.getTextColor(shape);\r\n            var label = _this.container.addShape('text', {\r\n                attrs: deepMix({}, style, {\r\n                    x: position.x + offsetX,\r\n                    y: position.y + offsetY,\r\n                    text: content,\r\n                    fill: color,\r\n                    textAlign: 'center',\r\n                    textBaseline: 'middle',\r\n                }),\r\n                name: 'label',\r\n            });\r\n            if (_this.options.adjustPosition) {\r\n                _this.adjustLabel(label, shape);\r\n            }\r\n        });\r\n    };\r\n    MatrixLabel.prototype.clear = function () {\r\n        if (this.container) {\r\n            this.container.clear();\r\n        }\r\n    };\r\n    MatrixLabel.prototype.hide = function () {\r\n        this.container.set('visible', false);\r\n        this.plot.canvas.draw();\r\n    };\r\n    MatrixLabel.prototype.show = function () {\r\n        this.container.set('visible', true);\r\n        this.plot.canvas.draw();\r\n    };\r\n    MatrixLabel.prototype.destroy = function () {\r\n        if (this.container) {\r\n            this.container.remove();\r\n        }\r\n        this.destroyed = true;\r\n    };\r\n    MatrixLabel.prototype.getBBox = function () {\r\n        return this.container.getBBox();\r\n    };\r\n    MatrixLabel.prototype.getDefaultOptions = function () {\r\n        var theme = this.plot.theme;\r\n        var labelStyle = theme.label.style;\r\n        return {\r\n            offsetX: 0,\r\n            offsetY: 0,\r\n            style: clone(labelStyle),\r\n        };\r\n    };\r\n    MatrixLabel.prototype.getContent = function (shape) {\r\n        var data = shape.get('origin').data;\r\n        var field = this.plot.options.colorField;\r\n        return data[field];\r\n    };\r\n    MatrixLabel.prototype.getPosition = function (shape) {\r\n        var bbox = shape.getBBox();\r\n        return {\r\n            x: bbox.minX + bbox.width / 2,\r\n            y: bbox.minY + bbox.height / 2,\r\n        };\r\n    };\r\n    MatrixLabel.prototype.getTextColor = function (shape) {\r\n        if (this.options.adjustColor) {\r\n            var shapeColor = shape.attr('fill');\r\n            var shapeOpacity = shape.attr('opacity') ? shape.attr('opacity') : 1;\r\n            var rgb = rgb2arr(shapeColor);\r\n            var gray = Math.round(rgb[0] * 0.299 + rgb[1] * 0.587 + rgb[2] * 0.114) / shapeOpacity;\r\n            var colorBand = [\r\n                { from: 0, to: 85, color: 'white' },\r\n                { from: 85, to: 170, color: '#F6F6F6' },\r\n                { from: 170, to: 255, color: 'black' },\r\n            ];\r\n            var reflect = mappingColor(colorBand, gray);\r\n            return reflect;\r\n        }\r\n        var defaultColor = this.options.style.fill;\r\n        return defaultColor;\r\n    };\r\n    MatrixLabel.prototype.adjustLabel = function (label, shape) {\r\n        var labelRange = label.getBBox();\r\n        var shapeRange = shape.getBBox();\r\n        if (labelRange.width > shapeRange.width || labelRange.height > shapeRange.height) {\r\n            label.attr('text', '');\r\n        }\r\n    };\r\n    return MatrixLabel;\r\n}());\r\nexport default MatrixLabel;\r\n",{"version":3,"file":"D:\\project\\Deecamp-project\\system\\Web\\node_modules\\@antv\\g2plot\\esm\\plots\\heatmap\\component\\label.js","sourceRoot":"","sources":["D:\\project\\Deecamp-project\\system\\Web\\node_modules\\@antv\\g2plot\\esm\\plots\\heatmap\\component\\label.js"],"names":[],"mappings":"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","sourcesContent":["import { each, deepMix, clone } from '@antv/util';\nimport { rgb2arr, mappingColor } from '../../../util/color';\nvar MatrixLabel = /** @class */ (function () {\n    function MatrixLabel(cfg) {\n        this.destroyed = false;\n        this.view = cfg.view;\n        this.plot = cfg.plot;\n        var defaultOptions = this.getDefaultOptions();\n        this.options = deepMix(defaultOptions, cfg, {});\n        this.init();\n    }\n    MatrixLabel.prototype.init = function () {\n        var _this = this;\n        this.container = this.view.geometries[0].labelsContainer;\n        this.view.on('beforerender', function () {\n            _this.clear();\n            _this.plot.canvas.draw();\n        });\n    };\n    MatrixLabel.prototype.render = function () {\n        var _this = this;\n        var elements = this.view.geometries[0].elements;\n        each(elements, function (ele) {\n            var shape = ele.shape;\n            var _a = _this.options, style = _a.style, offsetX = _a.offsetX, offsetY = _a.offsetY;\n            var formatter = _this.options.formatter;\n            var content = formatter ? formatter(_this.getContent(shape)) : _this.getContent(shape);\n            var position = _this.getPosition(shape);\n            var color = _this.getTextColor(shape);\n            var label = _this.container.addShape('text', {\n                attrs: deepMix({}, style, {\n                    x: position.x + offsetX,\n                    y: position.y + offsetY,\n                    text: content,\n                    fill: color,\n                    textAlign: 'center',\n                    textBaseline: 'middle',\n                }),\n                name: 'label',\n            });\n            if (_this.options.adjustPosition) {\n                _this.adjustLabel(label, shape);\n            }\n        });\n    };\n    MatrixLabel.prototype.clear = function () {\n        if (this.container) {\n            this.container.clear();\n        }\n    };\n    MatrixLabel.prototype.hide = function () {\n        this.container.set('visible', false);\n        this.plot.canvas.draw();\n    };\n    MatrixLabel.prototype.show = function () {\n        this.container.set('visible', true);\n        this.plot.canvas.draw();\n    };\n    MatrixLabel.prototype.destroy = function () {\n        if (this.container) {\n            this.container.remove();\n        }\n        this.destroyed = true;\n    };\n    MatrixLabel.prototype.getBBox = function () {\n        return this.container.getBBox();\n    };\n    MatrixLabel.prototype.getDefaultOptions = function () {\n        var theme = this.plot.theme;\n        var labelStyle = theme.label.style;\n        return {\n            offsetX: 0,\n            offsetY: 0,\n            style: clone(labelStyle),\n        };\n    };\n    MatrixLabel.prototype.getContent = function (shape) {\n        var data = shape.get('origin').data;\n        var field = this.plot.options.colorField;\n        return data[field];\n    };\n    MatrixLabel.prototype.getPosition = function (shape) {\n        var bbox = shape.getBBox();\n        return {\n            x: bbox.minX + bbox.width / 2,\n            y: bbox.minY + bbox.height / 2,\n        };\n    };\n    MatrixLabel.prototype.getTextColor = function (shape) {\n        if (this.options.adjustColor) {\n            var shapeColor = shape.attr('fill');\n            var shapeOpacity = shape.attr('opacity') ? shape.attr('opacity') : 1;\n            var rgb = rgb2arr(shapeColor);\n            var gray = Math.round(rgb[0] * 0.299 + rgb[1] * 0.587 + rgb[2] * 0.114) / shapeOpacity;\n            var colorBand = [\n                { from: 0, to: 85, color: 'white' },\n                { from: 85, to: 170, color: '#F6F6F6' },\n                { from: 170, to: 255, color: 'black' },\n            ];\n            var reflect = mappingColor(colorBand, gray);\n            return reflect;\n        }\n        var defaultColor = this.options.style.fill;\n        return defaultColor;\n    };\n    MatrixLabel.prototype.adjustLabel = function (label, shape) {\n        var labelRange = label.getBBox();\n        var shapeRange = shape.getBBox();\n        if (labelRange.width > shapeRange.width || labelRange.height > shapeRange.height) {\n            label.attr('text', '');\n        }\n    };\n    return MatrixLabel;\n}());\nexport default MatrixLabel;\n//# sourceMappingURL=label.js.map"]}]}