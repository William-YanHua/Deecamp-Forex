(window.webpackJsonp=window.webpackJsonp||[]).push([[57],{1882:function(t,e,n){"use strict";n.r(e);var a,r,i,o=n(0),s=n.n(o),l=n(8),c=n(3),u=n(78),f=n(2),d=n.n(f),h=n(1703),p=(n(1489),n(584)),y=n.n(p),g=(n(634),n(1667)),b=n.n(g),v=(n(1665),n(1350)),m=n.n(v),w=(n(1349),n(67),n(1440)),k=n.n(w),P=(n(1439),n(1883)),D=n.n(P),O=function(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t},F=(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),Y=function(){return(Y=Object.assign||function(t){for(var e,n=1,a=arguments.length;n<a;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)},x=function(t,e,n,a){var r,i=arguments.length,o=i<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,n):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,a);else for(var s=t.length-1;0<=s;s--)(r=t[s])&&(o=(i<3?r(o):3<i?r(e,n,o):r(e,n))||o);return 3<i&&o&&Object.defineProperty(e,n,o),o},E=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},S=function(t,o,s,l){return new(s=s||Promise)(function(n,e){function a(t){try{i(l.next(t))}catch(t){e(t)}}function r(t){try{i(l.throw(t))}catch(t){e(t)}}function i(t){var e;t.done?n(t.value):((e=t.value)instanceof s?e:new s(function(t){t(e)})).then(a,r)}i((l=l.apply(t,o||[])).next())})},j=function(n,a){var r,i,o,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(o=2&e[0]?i.return:e[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,e[1])).done)return o;switch(i=0,o&&(e=[2&e[0],o.value]),e[0]){case 0:case 1:o=e;break;case 4:return s.label++,{value:e[1],done:!1};case 5:s.label++,i=e[1],e=[0];continue;case 7:e=s.ops.pop(),s.trys.pop();continue;default:if(!(o=0<(o=s.trys).length&&o[o.length-1])&&(6===e[0]||2===e[0])){s=0;continue}if(3===e[0]&&(!o||e[1]>o[0]&&e[1]<o[3])){s.label=e[1];break}if(6===e[0]&&s.label<o[1]){s.label=o[1],o=e;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(e);break}o[2]&&s.ops.pop(),s.trys.pop();continue}e=a.call(n,s)}catch(t){e=[6,t],i=0}finally{r=o=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}},R="YYYY-MM-DD",C=b.a.RangePicker,W=(l.a.p.withConfig({displayName:"Prompt"})(O(["\n  color: #FFFFFF;\n"],["\n  color: #FFFFFF;\n"])),r=s.a.Component,F(_,r),_.prototype.componentWillMount=function(){return S(this,void 0,void 0,function(){return j(this,function(t){return[2]})})},_.prototype.componentDidMount=function(){return S(this,void 0,void 0,function(){var e,n;return j(this,function(t){switch(t.label){case 0:return this.state.data?[3,3]:[4,this.quotationService.getData(2001,null)];case 1:return e=t.sent(),[4,this.setState({data:e.data})];case 2:t.sent(),t.label=3;case 3:return[4,this.quotationService.getProfit()];case 4:return n=t.sent(),[4,this.setState({profitRate:n})];case 5:return t.sent(),this.showLine(),[2]}})})},_.prototype.sliderChange=function(c,u){return S(this,void 0,void 0,function(){var e,n,a,r,i,o,s,l;return j(this,function(t){switch(t.label){case 0:return c=2001+19*c/100,[4,u.getData(c)];case 1:return e=t.sent(),n=[d()(c+"-01-01",R),d()(c+"-01-06 ",R)],[4,this.setState({data:e.data,lookingTime:n,lookingYear:c})];case 2:return t.sent(),a=this.filterData(e.data),r=a[0],i=a[1],o=a[2],s=this.state.linePlot,l=this.getInOutData(r),s.updateConfig({data:r,yAxis:{min:o,max:i},markerPoints:[{visible:!0,data:l[0],symbol:"",label:{visible:!0,field:"strategy",offsetY:-8},style:{big:{stroke:"rgba(255, 0, 255, 0.7)",lineWidth:3}}},{visible:!0,data:l[1],symbol:"cross",label:{visible:!0,field:"strategy",offsetY:24},style:{normal:{stroke:"rgba(255, 0, 0, 0.65)",lineWidth:3}}}]}),s.render(),[2]}})})},_.prototype.render=function(){var t=this.state,e=t.profitRate[t.lookingYear],n=0<e?"green":"red";return s.a.createElement(y.a,null,s.a.createElement("div",null,s.a.createElement("strong",null,"选择查看的时间段")),s.a.createElement(C,{defaultValue:this.state.lookingTime,onChange:this.onRangeChange,renderExtraFooter:function(){return"请选择最长半年的时间查看！"}}),s.a.createElement("br",null),s.a.createElement("br",null),s.a.createElement("div",null,s.a.createElement(k.a,{color:n},this.state.lookingYear,"的年收益率：",e)),s.a.createElement("div",{id:"graph-container"}))},x([c.Inject,E("design:type","function"==typeof(i=void 0!==u.a&&u.a)?i:Object)],_.prototype,"quotationService",void 0),_);function _(t){var l=r.call(this,t)||this;return l.state={data:null,linePlot:null,lookingYear:2001,lookingTime:[d()("2001-01-01",R),d()("2001-01-08",R)],profitRate:{2001:1}},l.filterData=function(t){var e=[],n=l.state.lookingTime,a=n[0],r=n[1],i=-10,o=100;return t.forEach(function(t){a<=d()(t.time)&&d()(t.time)<=r&&(t.hasOwnProperty("strategy")&&(1===t.strategy?t.strategy="买入":0===t.strategy?t.strategy="持有":-1===t.strategy&&(t.strategy="卖出")),e.push(t),t.bid>i&&(i=t.bid),t.bid<o&&(o=t.bid))}),[e,i,o]},l.getInOutData=function(t){var e=[],n=[];return t.forEach(function(t){t.hasOwnProperty("strategy")&&("买入"===t.strategy?e.push(t):"卖出"===t.strategy&&n.push(t))}),[e,n]},l.showLine=function(){var t=l.state.data,e=l.filterData(t),n=e[0],a=e[1],r=e[2],i=l.getInOutData(n),o={title:{visible:!0,text:"买卖策略图"},label:{visible:!1,type:"point"},point:{visible:!0,size:2,shape:"diamond",style:{fill:"white",stroke:"#2593fc",lineWidth:2}},padding:"auto",forceFit:!0,data:n,xField:"time",yField:"bid",yAxis:{min:r,max:a},legend:{position:"right-top"},responsive:!0,tooltip:{custom:{onChange:function(t,e){var n,a,r=e.items;0===D.a.filter(r,{name:"strategy"}).length&&(n=r[0].data.strategy,a=Y(Y({},r[0]),{name:"strategy",value:n}),r.push(a))}}},animation:{appear:{animation:"clipingWithData"}},smooth:!0,markerPoints:[{visible:!0,data:i[0],symbol:"",label:{visible:!0,field:"strategy",offsetY:-8},style:{big:{stroke:"rgba(255, 0, 255, 0.7)",lineWidth:3}}},{visible:!0,data:i[1],symbol:"cross",label:{visible:!0,field:"strategy",offsetY:24},style:{normal:{stroke:"rgba(255, 0, 0, 0.65)",lineWidth:3}}}],seriesField:"type"},s=new h.a(document.getElementById("graph-container"),o);l.setState({linePlot:s}),s.render()},l.getData=function(n){return S(l,void 0,void 0,function(){var e;return j(this,function(t){switch(t.label){case 0:return n===this.state.lookingYear?[3,3]:[4,this.quotationService.getData(n,n+1)];case 1:return e=t.sent(),[4,this.setState({data:e.data,lookingYear:n})];case 2:t.sent(),t.label=3;case 3:return[2,this.state.data]}})})},l.onRangeChange=function(c){return S(l,void 0,void 0,function(){var e,n,a,r,i,o,s,l;return j(this,function(t){switch(t.label){case 0:return[4,this.setState({lookingTime:[c[0],c[1]]})];case 1:return t.sent(),e=null,1<c[1].year()-c[0].year()?[2,m.a.warning("对不起，您选择的时间范围过长！请选择较短的预测时间查看。",5)]:[3,2];case 2:return c[1].year()!==c[0].year()?[3,4]:[4,this.getData(c[1].year())];case 3:return e=t.sent(),[3,7];case 4:return c[1].year()-c[0].year()!=1?[3,7]:[4,this.quotationService.getData(c[0].year(),c[1].year()+1)];case 5:return n=t.sent(),[4,this.setState({data:n.data})];case 6:t.sent(),e=this.state.data,t.label=7;case 7:return a=this.state.linePlot,r=this.filterData(e),i=r[0],o=r[1],s=r[2],l=this.getInOutData(i),a.updateConfig({data:i,yAxis:{min:s,max:o},markerPoints:[{visible:!0,data:l[0],symbol:"",label:{visible:!0,field:"strategy",offsetY:-8},style:{big:{stroke:"rgba(255, 0, 255, 0.7)",lineWidth:3}}},{visible:!0,data:l[1],symbol:"cross",label:{visible:!0,field:"strategy",offsetY:24},style:{normal:{stroke:"rgba(255, 0, 0, 0.65)",lineWidth:3}}}]}),a.render(),[2]}})})},l}e.default=W}}]);