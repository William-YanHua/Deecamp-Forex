(window.webpackJsonp=window.webpackJsonp||[]).push([[59],{1658:function(t,e,n){"use strict";n.r(e);var a,r,i=n(0),o=n.n(i),s=n(13),l=n(4),c=n(82),u=n(2),f=n.n(u),d=n(1471),h=(n(1287),n(544)),p=n.n(h),y=(n(582),n(1427)),g=n.n(y),b=(n(1425),n(1148)),v=n.n(b),m=(n(1147),n(69),n(1276)),w=n.n(m),k=(n(1275),n(758)),P=n.n(k),D=function(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t},O=(a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),F=function(){return(F=Object.assign||function(t){for(var e,n=1,a=arguments.length;n<a;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)},Y=function(t,e,n,a){var r,i=arguments.length,o=i<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,n):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,a);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(o=(i<3?r(o):i>3?r(e,n,o):r(e,n))||o);return i>3&&o&&Object.defineProperty(e,n,o),o},x=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},E=function(t,e,n,a){return new(n||(n=Promise))(function(r,i){function o(t){try{l(a.next(t))}catch(t){i(t)}}function s(t){try{l(a.throw(t))}catch(t){i(t)}}function l(t){t.done?r(t.value):new n(function(e){e(t.value)}).then(o,s)}l((a=a.apply(t,e||[])).next())})},S=function(t,e){var n,a,r,i,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(r=2&i[0]?a.return:i[0]?a.throw||((r=a.return)&&r.call(a),0):a.next)&&!(r=r.call(a,i[1])).done)return r;switch(a=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(r=(r=o.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){o.label=i[1];break}if(6===i[0]&&o.label<r[1]){o.label=r[1],r=i;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(i);break}r[2]&&o.ops.pop(),o.trys.pop();continue}i=e.call(t,o)}catch(t){i=[6,t],a=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},j="YYYY-MM-DD",R=g.a.RangePicker,C=(s.a.p.withConfig({displayName:"Prompt"})(r||(r=D(["\n  color: #FFFFFF;\n"],["\n  color: #FFFFFF;\n"]))),function(t){function e(e){var n=t.call(this,e)||this;return n.state={data:null,linePlot:null,lookingYear:2001,lookingTime:[f()("2001-01-01",j),f()("2001-01-08",j)],profitRate:{2001:1}},n.filterData=function(t){var e=[],a=n.state.lookingTime,r=a[0],i=a[1],o=-10,s=100;return t.forEach(function(t){r<=f()(t.time)&&f()(t.time)<=i&&(t.hasOwnProperty("strategy")?(1===t.strategy?t.strategy="买入":0===t.strategy?t.strategy="持有":-1===t.strategy&&(t.strategy="卖出"),e.push(t)):e.push(t),t.bid>o&&(o=t.bid),t.bid<s&&(s=t.bid))}),[e,o,s]},n.getInOutData=function(t){var e=[],n=[];return t.forEach(function(t){t.hasOwnProperty("strategy")&&("买入"===t.strategy?e.push(t):"卖出"===t.strategy&&n.push(t))}),[e,n]},n.showLine=function(){var t=n.state.data,e=n.filterData(t),a=e[0],r=e[1],i=e[2],o=n.getInOutData(a),s={title:{visible:!0,text:"买卖策略图"},label:{visible:!1,type:"point"},point:{visible:!0,size:2,shape:"diamond",style:{fill:"white",stroke:"#2593fc",lineWidth:2}},padding:"auto",forceFit:!0,data:a,xField:"time",yField:"bid",yAxis:{min:i,max:r},legend:{position:"right-top"},responsive:!0,tooltip:{custom:{onChange:function(t,e){var n=e.items;if(0===P.a.filter(n,{name:"strategy"}).length){var a=n[0].data.strategy,r=F({},n[0],{name:"strategy",value:a});n.push(r)}}}},animation:{appear:{animation:"clipingWithData"}},smooth:!0,markerPoints:[{visible:!0,data:o[0],symbol:"",label:{visible:!0,field:"strategy",offsetY:-8},style:{big:{stroke:"rgba(255, 0, 255, 0.7)",lineWidth:3}}},{visible:!0,data:o[1],symbol:"cross",label:{visible:!0,field:"strategy",offsetY:24},style:{normal:{stroke:"rgba(255, 0, 0, 0.65)",lineWidth:3}}}],seriesField:"type"},l=new d.a(document.getElementById("graph-container"),s);n.setState({linePlot:l}),l.render()},n.getData=function(t){return E(n,void 0,void 0,function(){var e;return S(this,function(n){switch(n.label){case 0:return t===this.state.lookingYear?[3,3]:[4,this.quotationService.getData(t,t+1)];case 1:return e=n.sent(),[4,this.setState({data:e.data,lookingYear:t})];case 2:n.sent(),n.label=3;case 3:return[2,this.state.data]}})})},n.onRangeChange=function(t){return E(n,void 0,void 0,function(){var e,n,a,r,i,o,s,l;return S(this,function(c){switch(c.label){case 0:return[4,this.setState({lookingTime:[t[0],t[1]]})];case 1:return c.sent(),e=null,t[1].year()-t[0].year()>1?[2,v.a.warning("对不起，您选择的时间范围过长！请选择较短的预测时间查看。",5)]:[3,2];case 2:return t[1].year()!==t[0].year()?[3,4]:[4,this.getData(t[1].year())];case 3:return e=c.sent(),[3,7];case 4:return t[1].year()-t[0].year()!=1?[3,7]:[4,this.quotationService.getData(t[0].year(),t[1].year()+1)];case 5:return n=c.sent(),[4,this.setState({data:n.data})];case 6:c.sent(),e=this.state.data,c.label=7;case 7:return a=this.state.linePlot,r=this.filterData(e),i=r[0],o=r[1],s=r[2],l=this.getInOutData(i),a.updateConfig({data:i,yAxis:{min:s,max:o},markerPoints:[{visible:!0,data:l[0],symbol:"",label:{visible:!0,field:"strategy",offsetY:-8},style:{big:{stroke:"rgba(255, 0, 255, 0.7)",lineWidth:3}}},{visible:!0,data:l[1],symbol:"cross",label:{visible:!0,field:"strategy",offsetY:24},style:{normal:{stroke:"rgba(255, 0, 0, 0.65)",lineWidth:3}}}]}),a.render(),[2]}})})},n}var n;return O(e,t),e.prototype.componentWillMount=function(){return E(this,void 0,void 0,function(){return S(this,function(t){return[2]})})},e.prototype.componentDidMount=function(){return E(this,void 0,void 0,function(){var t,e;return S(this,function(n){switch(n.label){case 0:return this.state.data?[3,3]:[4,this.quotationService.getData(2001,null)];case 1:return t=n.sent(),[4,this.setState({data:t.data})];case 2:n.sent(),n.label=3;case 3:return[4,this.quotationService.getProfit()];case 4:return e=n.sent(),[4,this.setState({profitRate:e})];case 5:return n.sent(),this.showLine(),[2]}})})},e.prototype.sliderChange=function(t,e){return E(this,void 0,void 0,function(){var n,a,r,i,o,s,l,c;return S(this,function(u){switch(u.label){case 0:return t=2001+19*t/100,[4,e.getData(t)];case 1:return n=u.sent(),a=[f()(t+"-01-01",j),f()(t+"-01-06 ",j)],[4,this.setState({data:n.data,lookingTime:a,lookingYear:t})];case 2:return u.sent(),r=this.filterData(n.data),i=r[0],o=r[1],s=r[2],l=this.state.linePlot,c=this.getInOutData(i),l.updateConfig({data:i,yAxis:{min:s,max:o},markerPoints:[{visible:!0,data:c[0],symbol:"",label:{visible:!0,field:"strategy",offsetY:-8},style:{big:{stroke:"rgba(255, 0, 255, 0.7)",lineWidth:3}}},{visible:!0,data:c[1],symbol:"cross",label:{visible:!0,field:"strategy",offsetY:24},style:{normal:{stroke:"rgba(255, 0, 0, 0.65)",lineWidth:3}}}]}),l.render(),[2]}})})},e.prototype.render=function(){var t=this.state,e=t.profitRate[t.lookingYear],n=e>0?"green":"red";return o.a.createElement(p.a,null,o.a.createElement("div",null,o.a.createElement("strong",null,"选择查看的时间段")),o.a.createElement(R,{defaultValue:this.state.lookingTime,onChange:this.onRangeChange,renderExtraFooter:function(){return"请选择最长半年的时间查看！"}}),o.a.createElement("br",null),o.a.createElement("br",null),o.a.createElement("div",null,o.a.createElement(w.a,{color:n},this.state.lookingYear,"的年收益率：",e)),o.a.createElement("div",{id:"graph-container"}))},Y([l.Inject,x("design:type","function"==typeof(n=void 0!==c.a&&c.a)?n:Object)],e.prototype,"quotationService",void 0),e}(o.a.Component));e.default=C}}]);